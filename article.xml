<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving
and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
  <front>
    <journal-meta>
      <journal-id/>
      <journal-title-group>
        <journal-title>Notebooks Now!</journal-title>
      </journal-title-group>
      <issn/>
      <publisher>
        <publisher-name/>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Zircon Geothermometry and Zr-mineral saturation in
natural magmas using rhyolite-MELTS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author" corresp="yes">
          <contrib-id contrib-id-type="orcid">0000-0002-0489-0018</contrib-id>
          <name>
            <surname>Ghiorso</surname>
            <given-names>Mark S.</given-names>
          </name>
          <string-name>Mark S. Ghiorso</string-name>
          <email>ghiorso@ofm-research.org</email>
          <role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
          <role vocab="https://credit.niso.org" vocab-term="project administration" vocab-term-identifier="https://credit.niso.org/contributor-roles/project-administration/">Project
administration</role>
          <role vocab="https://credit.niso.org" vocab-term="software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software/">Software</role>
          <role vocab="https://credit.niso.org" vocab-term="visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization/">Visualization</role>
          <xref ref-type="aff" rid="aff-1">a</xref>
          <xref ref-type="corresp" rid="cor-1">*</xref>
        </contrib>
        <contrib contrib-type="author">
          <contrib-id contrib-id-type="orcid">0000-0003-0720-2679</contrib-id>
          <name>
            <surname>Gualda</surname>
            <given-names>Guilherme A. R.</given-names>
          </name>
          <string-name>Guilherme A. R. Gualda</string-name>
          <role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
          <xref ref-type="aff" rid="aff-2">b</xref>
        </contrib>
        <contrib contrib-type="author">
          <contrib-id contrib-id-type="orcid">0000-0003-2415-0508</contrib-id>
          <name>
            <surname>Wolf</surname>
            <given-names>Aaron S.</given-names>
          </name>
          <string-name>Aaron S. Wolf</string-name>
          <role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
          <xref ref-type="aff" rid="aff-3">c</xref>
        </contrib>
      </contrib-group>
      <aff id="aff-1">
        <institution-wrap>
          <institution>OFM Research</institution>
        </institution-wrap>
        <city>Seattle</city>
        <state>WA</state>
        <country>US</country>
      </aff>
      <aff id="aff-2">
        <institution content-type="dept">Earth and Environmental
Sciences</institution>
        <institution-wrap>
          <institution>Vanderbilt University</institution>
        </institution-wrap>
        <city>Nashville</city>
        <state>TN</state>
        <country>US</country>
      </aff>
      <aff id="aff-3">
        <institution-wrap>
          <institution>SETI Institute</institution>
        </institution-wrap>
        <city>Ann Arbor</city>
        <state>MI</state>
        <country>US</country>
      </aff>
      <author-notes>
        <corresp id="cor-1">ghiorso@ofm-research.org</corresp>
      </author-notes>
      <pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-01-15">
        <year>2024</year>
        <month>1</month>
        <day>15</day>
      </pub-date>
      <history/>
      <permissions>
        <license license-type="creative-commons">
          <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/">https://creativecommons.org/licenses/by-sa/4.0/</ali:license_ref>
        </license>
      </permissions>
      <abstract>
        <p>TBD</p>
      </abstract>
      <kwd-group kwd-group-type="author">
        <kwd>Geothermometry</kwd>
        <kwd>Zircon</kwd>
        <kwd>MELTS</kwd>
      </kwd-group>
    </article-meta>
  </front>
  <body>
    <sec id="introduction">
      <title>Introduction</title>
      <p>Zircon geothermometry is an important tool for estimating
  pre-eruptive temperatures in magmatic systems
  (<xref alt="Putirka 2008" rid="ref-Putirka_2008" ref-type="bibr">Putirka
  2008</xref>). Existing zircon geothermometers
  (<xref alt="E. Bruce Watson and Harrison 1983" rid="ref-WATSON1983295" ref-type="bibr">E.
  Bruce Watson and Harrison 1983</xref>;
  <xref alt="Boehnke et al. 2013" rid="ref-boehnke2013zircon" ref-type="bibr">Boehnke
  et al. 2013</xref>;
  <xref alt="Gervasoni et al. 2016" rid="ref-gervasoni2016zircon" ref-type="bibr">Gervasoni
  et al. 2016</xref>) are formulated using empirical models calibrated
  from experimental data on saturation conditions of zircon in magmatic
  silicate melts. In this paper we formulate an extension of the
  thermodynamic model for silicate liquids contained in rhyolite-MELTS
  (<xref alt="Gualda et al. 2012" rid="ref-gualda2012rhyolite" ref-type="bibr">Gualda
  et al. 2012</xref>;
  <xref alt="Ghiorso and Gualda 2015" rid="ref-ghiorso2015h" ref-type="bibr">Ghiorso
  and Gualda 2015</xref>;
  <xref alt="Ghiorso and Sack 1995" rid="ref-ghiorso1995chemical" ref-type="bibr">Ghiorso
  and Sack 1995</xref>) to account for the saturation state of zircon
  and related Zr-minerals as functions of temperature (T) and pressure
  (P) for compositions of naturally occuring magmatic liquids. We adopt
  thermodynamic properties of the zirconium-bearing minerals zircon and
  badeleyite from Robie and Hemingway
  (<xref alt="1995" rid="ref-robie1995thermodynamic" ref-type="bibr">1995</xref>)
  and calibrate an internally consistent liquid model using the
  experimental data of E. Bruce Watson and Harrison
  (<xref alt="1983" rid="ref-WATSON1983295" ref-type="bibr">1983</xref>)
  and Boehnke et al.
  (<xref alt="2013" rid="ref-boehnke2013zircon" ref-type="bibr">2013</xref>).
  The resulting model is applied as a zircon geothermobarometer and is
  utilized to estimate saturation conditions of zircon in phase
  assemblages forming in silicic magmatic systems.</p>
    </sec>
    <sec id="model-formulation">
      <title>Model Formulation</title>
      <p>Ghiorso and Sack
  (<xref alt="1995" rid="ref-ghiorso1995chemical" ref-type="bibr">1995</xref>)
  posited a functional form for the Gibbs Free Energy of magmatic
  composition silicate liquids that was largely based on the model of
  Ghiorso et al.
  (<xref alt="1983" rid="ref-ghiorso1983gibbs" ref-type="bibr">1983</xref>).
  Their model assumes that the thermodynamic properties of naturally
  occuring silicate liquids can be approximated using simple
  multi-component regular solution theory on the predicate that
  thermodynamic components are appropriately chosen to represent
  “mineral-like” stoichiometric compounds. They calibrated this model
  using experimental phase equilibrium data. The silicate liquid model
  of Ghiorso and Sack
  (<xref alt="1995" rid="ref-ghiorso1995chemical" ref-type="bibr">1995</xref>)
  (hereafter, MELTS) was not altered in the development of the
  rhyolite-MELTS model
  (<xref alt="Gualda et al. 2012" rid="ref-gualda2012rhyolite" ref-type="bibr">Gualda
  et al. 2012</xref>) that extends MELTS to highly silicic magmatic
  compositions. The addition of oxidized carbon to the liquid model by
  Ghiorso and Gualda
  (<xref alt="2015" rid="ref-ghiorso2015h" ref-type="bibr">2015</xref>)
  did require modification to the underlying thermodynamic formalism for
  the liquid phase. A thermodynamic component (CO2) and a dependent
  species (CaCO3) were added to account for the presence of both
  molecular CO2 and carbonate in silicate melts. The addition of a
  carbonate species necessitated recasting of the regular solution model
  into a non-ideal assciated solution (Ghiorso and Gualda
  (<xref alt="2015" rid="ref-ghiorso2015h" ref-type="bibr">2015</xref>)).</p>
      <p>The addition of Zr to the liquid model of Ghiorso and Gualda
  (<xref alt="2015" rid="ref-ghiorso2015h" ref-type="bibr">2015</xref>)
  requires the selection of a Zr-bearing thermodynamic component. We
  adopt ZrSiO4, because we assumed that Zr and Si form a strong
  association in the melt, and because the thermodynamic properties of
  the solid phase of equivalent stoichiometry (zircon) are well known
  (<xref alt="Robie and Hemingway 1995" rid="ref-robie1995thermodynamic" ref-type="bibr">Robie
  and Hemingway 1995</xref>). Experimental studies
  (<xref alt="E. Bruce Watson 1979" rid="ref-watson1979zircon" ref-type="bibr">E.
  Bruce Watson 1979</xref>) and petrologiocal observations
  (<xref alt="Nicholls and Carmichael 1969" rid="ref-nicholls1969peralkaline" ref-type="bibr">Nicholls
  and Carmichael 1969</xref>) demonstrate that there is a strong
  relationship between the alkali-content of a melt and its capacity to
  hold Zr in solution under conditions of zircon saturation. In a series
  of elegant experiments on melts of widely varying alkali-contents, E.
  Bruce Watson
  (<xref alt="1979" rid="ref-watson1979zircon" ref-type="bibr">1979</xref>)
  established that alkali-zirconate species of stoichiometry four
  alkalis to one Zr likely form. The formation of these species
  effectively lowers the mole fraction of ZrSiO4 in the melt, thereby
  lowering that component’s chemical potential, which has the effect of
  understaurating the melt in zircon. E. Bruce Watson
  (<xref alt="1979" rid="ref-watson1979zircon" ref-type="bibr">1979</xref>)
  suggested that species Na4ZrSi2O8 and K4ZrSi2O8 account for the
  sequestration of zirconium in alkali-rich magmas. It is interesting to
  note that the stoichiometry of these species is not reflected in the
  stoichiomtry of alkali-metal, zirconium-bearing minerals that form in
  magmatic systems (e.g. wadeite, Zr2K4Si6O18, Carmichael
  (<xref alt="1967" rid="ref-carmichael1967mineralogy" ref-type="bibr">1967</xref>),
  nor to the supppsition of Linthout
  (<xref alt="1984" rid="ref-linthout1984alkali" ref-type="bibr">1984</xref>)
  that melt species of zirconium should likely reflect alkali-zirconate
  mineral stoichiometry.</p>
      <p>We extend the associated solution model of Ghiorso and Gualda
  (<xref alt="2015" rid="ref-ghiorso2015h" ref-type="bibr">2015</xref>)
  to include the species Na4ZrSi2O8 and K4ZrSi2O8. Thermodynamic
  components of the extended model, additional melt species and
  component-species transformations are summarized in
  <xref alt="Table 1" rid="tbl-1">Table 1</xref>.</p>
      <fig id="tbl-1">
        <caption>
          <p>Table 1: Solution model: Components, species and
    mappings</p>
        </caption>
        <table-wrap>
          <table>
            <colgroup>
              <col width="28%"/>
              <col width="21%"/>
              <col width="26%"/>
              <col width="26%"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left">Components:</th>
                <th align="left">Species:</th>
                <th align="left">Component:</th>
                <th align="left">Species X:</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left">SiO2</td>
                <td align="left">SiO2</td>
                <td align="left">
                  <inline-formula>
                    <alternatives>
                      <tex-math><![CDATA[n_1]]></tex-math>
                      <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                        <mml:msub>
                          <mml:mi>n</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_1]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_1]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            + <inline-formula><alternatives><tex-math><![CDATA[y_{18}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>18</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            + <inline-formula><alternatives><tex-math><![CDATA[y_{19}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>19</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            + 3 <inline-formula><alternatives><tex-math><![CDATA[y_{20}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>20</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
              </tr>
              <tr>
                <td align="left">TiO2</td>
                <td align="left">TiO2</td>
                <td align="left">
                  <inline-formula>
                    <alternatives>
                      <tex-math><![CDATA[n_2]]></tex-math>
                      <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                        <mml:msub>
                          <mml:mi>n</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
              </tr>
              <tr>
                <td align="left">Al2O3</td>
                <td align="left">Al2O3</td>
                <td align="left">
                  <inline-formula>
                    <alternatives>
                      <tex-math><![CDATA[n_3]]></tex-math>
                      <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                        <mml:msub>
                          <mml:mi>n</mml:mi>
                          <mml:mn>3</mml:mn>
                        </mml:msub>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_3]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_3]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            + 2 <inline-formula><alternatives><tex-math><![CDATA[y_{20}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>20</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
              </tr>
              <tr>
                <td align="left">Fe2O3</td>
                <td align="left">Fe2O3</td>
                <td align="left">
                  <inline-formula>
                    <alternatives>
                      <tex-math><![CDATA[n_4]]></tex-math>
                      <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                        <mml:msub>
                          <mml:mi>n</mml:mi>
                          <mml:mn>4</mml:mn>
                        </mml:msub>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_4]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_4]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
              </tr>
              <tr>
                <td align="left">MgCr2O4</td>
                <td align="left">MgCr2O4</td>
                <td align="left">
                  <inline-formula>
                    <alternatives>
                      <tex-math><![CDATA[n_5]]></tex-math>
                      <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                        <mml:msub>
                          <mml:mi>n</mml:mi>
                          <mml:mn>5</mml:mn>
                        </mml:msub>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_5]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_5]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
              </tr>
              <tr>
                <td align="left">Fe2SiO4</td>
                <td align="left">Fe2SiO4</td>
                <td align="left">
                  <inline-formula>
                    <alternatives>
                      <tex-math><![CDATA[n_6]]></tex-math>
                      <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                        <mml:msub>
                          <mml:mi>n</mml:mi>
                          <mml:mn>6</mml:mn>
                        </mml:msub>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_6]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>6</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_6]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>6</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
              </tr>
              <tr>
                <td align="left">MnSi1/2O2</td>
                <td align="left">MnSi1/2O2</td>
                <td align="left">
                  <inline-formula>
                    <alternatives>
                      <tex-math><![CDATA[n_7]]></tex-math>
                      <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                        <mml:msub>
                          <mml:mi>n</mml:mi>
                          <mml:mn>7</mml:mn>
                        </mml:msub>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_7]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>7</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_7]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>7</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
              </tr>
              <tr>
                <td align="left">Mg2SiO4</td>
                <td align="left">Mg2SiO4</td>
                <td align="left">
                  <inline-formula>
                    <alternatives>
                      <tex-math><![CDATA[n_8]]></tex-math>
                      <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                        <mml:msub>
                          <mml:mi>n</mml:mi>
                          <mml:mn>8</mml:mn>
                        </mml:msub>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_8]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_8]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
              </tr>
              <tr>
                <td align="left">NiSi1/2O2</td>
                <td align="left">NiSi1/2O2</td>
                <td align="left">
                  <inline-formula>
                    <alternatives>
                      <tex-math><![CDATA[n_9]]></tex-math>
                      <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                        <mml:msub>
                          <mml:mi>n</mml:mi>
                          <mml:mn>9</mml:mn>
                        </mml:msub>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_9]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>9</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_9]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>9</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
              </tr>
              <tr>
                <td align="left">CoSi1/2O2</td>
                <td align="left">CoSi1/2O2</td>
                <td align="left">
                  <inline-formula>
                    <alternatives>
                      <tex-math><![CDATA[n_{10}]]></tex-math>
                      <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                        <mml:msub>
                          <mml:mi>n</mml:mi>
                          <mml:mn>10</mml:mn>
                        </mml:msub>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_{10}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_{10}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
              </tr>
              <tr>
                <td align="left">CaSiO3</td>
                <td align="left">CaSiO3</td>
                <td align="left">
                  <inline-formula>
                    <alternatives>
                      <tex-math><![CDATA[n_{11}]]></tex-math>
                      <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                        <mml:msub>
                          <mml:mi>n</mml:mi>
                          <mml:mn>11</mml:mn>
                        </mml:msub>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_{11}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_{11}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            - <inline-formula><alternatives><tex-math><![CDATA[y_{18}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>18</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
              </tr>
              <tr>
                <td align="left">Na2SiO3</td>
                <td align="left">Na2SiO3</td>
                <td align="left">
                  <inline-formula>
                    <alternatives>
                      <tex-math><![CDATA[n_{12}]]></tex-math>
                      <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                        <mml:msub>
                          <mml:mi>n</mml:mi>
                          <mml:mn>12</mml:mn>
                        </mml:msub>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_{12}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_{12}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            - 2 <inline-formula><alternatives><tex-math><![CDATA[y_{19}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>19</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
              </tr>
              <tr>
                <td align="left">KAlSiO4</td>
                <td align="left">KAlSiO4</td>
                <td align="left">
                  <inline-formula>
                    <alternatives>
                      <tex-math><![CDATA[n_{13}]]></tex-math>
                      <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                        <mml:msub>
                          <mml:mi>n</mml:mi>
                          <mml:mn>13</mml:mn>
                        </mml:msub>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_{13}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>13</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_{13}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>13</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            - 4 <inline-formula><alternatives><tex-math><![CDATA[y_{20}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>20</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
              </tr>
              <tr>
                <td align="left">Ca3(PO4)2</td>
                <td align="left">Ca3(PO4)2</td>
                <td align="left">
                  <inline-formula>
                    <alternatives>
                      <tex-math><![CDATA[n_{14}]]></tex-math>
                      <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                        <mml:msub>
                          <mml:mi>n</mml:mi>
                          <mml:mn>14</mml:mn>
                        </mml:msub>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_{14}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>14</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_{14}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>14</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
              </tr>
              <tr>
                <td align="left">H2O</td>
                <td align="left">H2O</td>
                <td align="left">
                  <inline-formula>
                    <alternatives>
                      <tex-math><![CDATA[n_{15}]]></tex-math>
                      <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                        <mml:msub>
                          <mml:mi>n</mml:mi>
                          <mml:mn>15</mml:mn>
                        </mml:msub>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_{15}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>15</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_{15}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>15</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
              </tr>
              <tr>
                <td align="left">CO2</td>
                <td align="left">CO2</td>
                <td align="left">
                  <inline-formula>
                    <alternatives>
                      <tex-math><![CDATA[n_{16}]]></tex-math>
                      <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                        <mml:msub>
                          <mml:mi>n</mml:mi>
                          <mml:mn>16</mml:mn>
                        </mml:msub>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_{16}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>16</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_{16}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>16</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            - <inline-formula><alternatives><tex-math><![CDATA[y_{18}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>18</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
              </tr>
              <tr>
                <td align="left">ZrSiO4</td>
                <td align="left">ZrSiO4</td>
                <td align="left">
                  <inline-formula>
                    <alternatives>
                      <tex-math><![CDATA[n_{17}]]></tex-math>
                      <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                        <mml:msub>
                          <mml:mi>n</mml:mi>
                          <mml:mn>17</mml:mn>
                        </mml:msub>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_{17}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>17</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_{17}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>17</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            - <inline-formula><alternatives><tex-math><![CDATA[y_{19}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>19</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            - <inline-formula><alternatives><tex-math><![CDATA[y_{20}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>20</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
              </tr>
              <tr>
                <td align="left"/>
                <td align="left">CaCO3</td>
                <td align="left"/>
                <td align="left">
                  <inline-formula>
                    <alternatives>
                      <tex-math><![CDATA[y_{18}]]></tex-math>
                      <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mn>18</mml:mn>
                        </mml:msub>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left"/>
                <td align="left">Na4ZrSi2O8</td>
                <td align="left"/>
                <td align="left">
                  <inline-formula>
                    <alternatives>
                      <tex-math><![CDATA[y_{19}]]></tex-math>
                      <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mn>19</mml:mn>
                        </mml:msub>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left"/>
                <td align="left">K4ZrSi2O8</td>
                <td align="left"/>
                <td align="left">
                  <inline-formula>
                    <alternatives>
                      <tex-math><![CDATA[y_{20}]]></tex-math>
                      <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mn>20</mml:mn>
                        </mml:msub>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </fig>
      <p>Reactions,</p>
      <p>CO2 + CaSiO3 = CaCO3 + SiO2,</p>
      <p>ZrSiO4 + 2Na2SiO3 = Na4ZrSi2O8 + SiO2,</p>
      <p>ZrSiO4 + 4KAlSiO4 = K4ZrSi2O8 + 2Al2O3 + 3SiO2,</p>
      <p>represent conditions of homogeneous equilibrium, permitting
  concentrations of melt species to be calculated by zeroing the Gibbs
  Free Energy change of all three reactions at specifed T, P and bulk
  composition. The last two reactions demonstrate that reduction in the
  chemical potential (activity) of silica in the melt encourages the
  transfer of Zr to both alkali-zirconate species.</p>
      <p>Using the notation summarized in
  <xref alt="Table 1" rid="tbl-1">Table 1</xref>, the Gibbs Free Energy
  of solution may be written:</p>
      <p>
        <styled-content id="eq-1">
          <disp-formula>
            <alternatives>
              <tex-math><![CDATA[
  G = \sum_{i=1}^{s} y_i \mu_i^o + R T \sum_{i=1}^{s} y_i \log \left( \frac{y_i}{y_T} \right) + y_w R T \log \left( \frac{y_w}{y_T} \right) + \left( y_T - y_w \right) R T \log \left( \frac{y_T - y_w}{y_T} \right) + \sum_{i=1}^{s} \sum_{j=i+1}^{s} W_{i,j} \frac{y_i y_j}{y_T}
   \qquad(1)]]></tex-math>
              <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                <mml:mrow>
                  <mml:mi>G</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mi>s</mml:mi>
                  </mml:munderover>
                  <mml:msub>
                    <mml:mi>y</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:msubsup>
                    <mml:mi>μ</mml:mi>
                    <mml:mi>i</mml:mi>
                    <mml:mi>o</mml:mi>
                  </mml:msubsup>
                  <mml:mo>+</mml:mo>
                  <mml:mi>R</mml:mi>
                  <mml:mi>T</mml:mi>
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mi>s</mml:mi>
                  </mml:munderover>
                  <mml:msub>
                    <mml:mi>y</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:mo>log</mml:mo>
                  <mml:mrow>
                    <mml:mo stretchy="true" form="prefix">(</mml:mo>
                    <mml:mfrac>
                      <mml:msub>
                        <mml:mi>y</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:msub>
                        <mml:mi>y</mml:mi>
                        <mml:mi>T</mml:mi>
                      </mml:msub>
                    </mml:mfrac>
                    <mml:mo stretchy="true" form="postfix">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>y</mml:mi>
                    <mml:mi>w</mml:mi>
                  </mml:msub>
                  <mml:mi>R</mml:mi>
                  <mml:mi>T</mml:mi>
                  <mml:mo>log</mml:mo>
                  <mml:mrow>
                    <mml:mo stretchy="true" form="prefix">(</mml:mo>
                    <mml:mfrac>
                      <mml:msub>
                        <mml:mi>y</mml:mi>
                        <mml:mi>w</mml:mi>
                      </mml:msub>
                      <mml:msub>
                        <mml:mi>y</mml:mi>
                        <mml:mi>T</mml:mi>
                      </mml:msub>
                    </mml:mfrac>
                    <mml:mo stretchy="true" form="postfix">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:mo stretchy="true" form="prefix">(</mml:mo>
                    <mml:msub>
                      <mml:mi>y</mml:mi>
                      <mml:mi>T</mml:mi>
                    </mml:msub>
                    <mml:mo>−</mml:mo>
                    <mml:msub>
                      <mml:mi>y</mml:mi>
                      <mml:mi>w</mml:mi>
                    </mml:msub>
                    <mml:mo stretchy="true" form="postfix">)</mml:mo>
                  </mml:mrow>
                  <mml:mi>R</mml:mi>
                  <mml:mi>T</mml:mi>
                  <mml:mo>log</mml:mo>
                  <mml:mrow>
                    <mml:mo stretchy="true" form="prefix">(</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mi>T</mml:mi>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mi>w</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                      <mml:msub>
                        <mml:mi>y</mml:mi>
                        <mml:mi>T</mml:mi>
                      </mml:msub>
                    </mml:mfrac>
                    <mml:mo stretchy="true" form="postfix">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mi>s</mml:mi>
                  </mml:munderover>
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mi>s</mml:mi>
                  </mml:munderover>
                  <mml:msub>
                    <mml:mi>W</mml:mi>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>y</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:msub>
                        <mml:mi>y</mml:mi>
                        <mml:mi>j</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                    <mml:msub>
                      <mml:mi>y</mml:mi>
                      <mml:mi>T</mml:mi>
                    </mml:msub>
                  </mml:mfrac>
                  <mml:mspace width="2.0em"/>
                  <mml:mrow>
                    <mml:mo stretchy="true" form="prefix">(</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo stretchy="true" form="postfix">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:math>
            </alternatives>
          </disp-formula>
        </styled-content>
      </p>
      <p>where <inline-formula><alternatives><tex-math><![CDATA[n_i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  denotes moles of the <inline-formula><alternatives><tex-math><![CDATA[i^{th}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msup><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>
  component and <inline-formula><alternatives><tex-math><![CDATA[y_i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  moles of the <inline-formula><alternatives><tex-math><![CDATA[i^{th}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msup><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>
  species. <inline-formula><alternatives><tex-math><![CDATA[n_T]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  is defined as <inline-formula><alternatives><tex-math><![CDATA[\sum_{i=1}^{17} n_i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>17</mml:mn></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives><tex-math><![CDATA[y_T]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  as <inline-formula><alternatives><tex-math><![CDATA[\sum_{i=1}^{20} y_i = n_T - y_{19} + y_{20}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>20</mml:mn></mml:msubsup><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>19</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>20</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.
  <inline-formula><alternatives><tex-math><![CDATA[\mu_i^o]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>
  denotes the chemical potential of the <inline-formula><alternatives><tex-math><![CDATA[i^{th}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msup><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>
  species in the standard state, here taken to be the pure substance at
  any T and P. <inline-formula><alternatives><tex-math><![CDATA[R]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>R</mml:mi></mml:math></alternatives></inline-formula>
  is the universal gas constant, and <inline-formula><alternatives><tex-math><![CDATA[W_{i,j}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
  refers to temperatrure and pressure independent regular-solution
  energetic paramters. The number of moles of H2O (either
  <inline-formula><alternatives><tex-math><![CDATA[n_w]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  or <inline-formula><alternatives><tex-math><![CDATA[y_w]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math></alternatives></inline-formula>)
  is treated specially in
  <xref alt="Equation 1" rid="eq-1">Equation 1</xref> to account for its
  dissolution in the melt as two hydroxyl species (derivation in
  <xref alt="Ghiorso et al. 1983" rid="ref-ghiorso1983gibbs" ref-type="bibr">Ghiorso
  et al. 1983</xref>).</p>
      <p>Differentiation of
  <xref alt="Equation 1" rid="eq-1">Equation 1</xref> with respect to
  <inline-formula><alternatives><tex-math><![CDATA[n_{ZrSiO_4}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
  results in our model expression for the chemical potential of the
  ZrSiO4 endmember component:</p>
      <p>
        <styled-content id="eq-2">
          <disp-formula>
            <alternatives>
              <tex-math><![CDATA[
  \mu_{ZrSiO_4} = \mu_{ZrSiO_4}^o + R T \log \left( \frac{y_{ZrSiO_4} \left( y_T - y_w \right)}{y_T^2} \right) + \sum_{i=1}^s W_{i,{ZrSiO_4}} \frac{y_i}{y_T} - \sum_{i=1}^s \sum_{j=i+1}^s W_{i,j} \frac{y_i y_j}{y_T^2}
   \qquad(2)]]></tex-math>
              <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>μ</mml:mi>
                    <mml:mrow>
                      <mml:mi>Z</mml:mi>
                      <mml:mi>r</mml:mi>
                      <mml:mi>S</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:msub>
                        <mml:mi>O</mml:mi>
                        <mml:mn>4</mml:mn>
                      </mml:msub>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:msubsup>
                    <mml:mi>μ</mml:mi>
                    <mml:mrow>
                      <mml:mi>Z</mml:mi>
                      <mml:mi>r</mml:mi>
                      <mml:mi>S</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:msub>
                        <mml:mi>O</mml:mi>
                        <mml:mn>4</mml:mn>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mi>o</mml:mi>
                  </mml:msubsup>
                  <mml:mo>+</mml:mo>
                  <mml:mi>R</mml:mi>
                  <mml:mi>T</mml:mi>
                  <mml:mo>log</mml:mo>
                  <mml:mrow>
                    <mml:mo stretchy="true" form="prefix">(</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mrow>
                            <mml:mi>Z</mml:mi>
                            <mml:mi>r</mml:mi>
                            <mml:mi>S</mml:mi>
                            <mml:mi>i</mml:mi>
                            <mml:msub>
                              <mml:mi>O</mml:mi>
                              <mml:mn>4</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">(</mml:mo>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msub>
                          <mml:mo>−</mml:mo>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>w</mml:mi>
                          </mml:msub>
                          <mml:mo stretchy="true" form="postfix">)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:msubsup>
                        <mml:mi>y</mml:mi>
                        <mml:mi>T</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msubsup>
                    </mml:mfrac>
                    <mml:mo stretchy="true" form="postfix">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mi>s</mml:mi>
                  </mml:munderover>
                  <mml:msub>
                    <mml:mi>W</mml:mi>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mrow>
                        <mml:mi>Z</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mi>S</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>4</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mfrac>
                    <mml:msub>
                      <mml:mi>y</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                    <mml:msub>
                      <mml:mi>y</mml:mi>
                      <mml:mi>T</mml:mi>
                    </mml:msub>
                  </mml:mfrac>
                  <mml:mo>−</mml:mo>
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mi>s</mml:mi>
                  </mml:munderover>
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mi>s</mml:mi>
                  </mml:munderover>
                  <mml:msub>
                    <mml:mi>W</mml:mi>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>y</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:msub>
                        <mml:mi>y</mml:mi>
                        <mml:mi>j</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                    <mml:msubsup>
                      <mml:mi>y</mml:mi>
                      <mml:mi>T</mml:mi>
                      <mml:mn>2</mml:mn>
                    </mml:msubsup>
                  </mml:mfrac>
                  <mml:mspace width="2.0em"/>
                  <mml:mrow>
                    <mml:mo stretchy="true" form="prefix">(</mml:mo>
                    <mml:mn>2</mml:mn>
                    <mml:mo stretchy="true" form="postfix">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:math>
            </alternatives>
          </disp-formula>
        </styled-content>
      </p>
      <p>Evaluation of <xref alt="Equation 2" rid="eq-2">Equation 2</xref>
  requires (1) a functional form and parameterization of
  <inline-formula><alternatives><tex-math><![CDATA[\mu_{ZrSiO_4}^o \left( T,P \right)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow><mml:mi>o</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  (2) estimated values for <inline-formula><alternatives><tex-math><![CDATA[W_{i,j}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
  and (3) solution of the three conditions of homogeneous
  equilibrium,</p>
      <p>
        <styled-content id="eq-3">
          <disp-formula>
            <alternatives>
              <tex-math><![CDATA[
  \left( \frac{\partial G}{\partial y_{CaCO_3}} \right)_{n_i} = \left( \frac{\partial G}{\partial y_{Na_4ZrSi_2O_8}} \right)_{n_i} = \left( \frac{\partial G}{\partial y_{K_4ZrSi_2O_8}} \right)_{n_i} = 0
   \qquad(3)]]></tex-math>
              <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mi>∂</mml:mi>
                          <mml:mi>G</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>∂</mml:mi>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mrow>
                              <mml:mi>C</mml:mi>
                              <mml:mi>a</mml:mi>
                              <mml:mi>C</mml:mi>
                              <mml:msub>
                                <mml:mi>O</mml:mi>
                                <mml:mn>3</mml:mn>
                              </mml:msub>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mfrac>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:msub>
                      <mml:mi>n</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mi>∂</mml:mi>
                          <mml:mi>G</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>∂</mml:mi>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                              <mml:msub>
                                <mml:mi>a</mml:mi>
                                <mml:mn>4</mml:mn>
                              </mml:msub>
                              <mml:mi>Z</mml:mi>
                              <mml:mi>r</mml:mi>
                              <mml:mi>S</mml:mi>
                              <mml:msub>
                                <mml:mi>i</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msub>
                              <mml:msub>
                                <mml:mi>O</mml:mi>
                                <mml:mn>8</mml:mn>
                              </mml:msub>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mfrac>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:msub>
                      <mml:mi>n</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mi>∂</mml:mi>
                          <mml:mi>G</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>∂</mml:mi>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>K</mml:mi>
                                <mml:mn>4</mml:mn>
                              </mml:msub>
                              <mml:mi>Z</mml:mi>
                              <mml:mi>r</mml:mi>
                              <mml:mi>S</mml:mi>
                              <mml:msub>
                                <mml:mi>i</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msub>
                              <mml:msub>
                                <mml:mi>O</mml:mi>
                                <mml:mn>8</mml:mn>
                              </mml:msub>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mfrac>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:msub>
                      <mml:mi>n</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mspace width="2.0em"/>
                  <mml:mrow>
                    <mml:mo stretchy="true" form="prefix">(</mml:mo>
                    <mml:mn>3</mml:mn>
                    <mml:mo stretchy="true" form="postfix">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:math>
            </alternatives>
          </disp-formula>
        </styled-content>
      </p>
      <p>to determine equilibrium concentrations of species mole numbers
  (<inline-formula><alternatives><tex-math><![CDATA[y_{CaCO_3}, y_{Na_4ZrSi_2O_8}, y_{K_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>)
  for a given bulk composition (<inline-formula><alternatives><tex-math><![CDATA[n_i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>).</p>
      <p><xref alt="Equation 2" rid="eq-2">Equation 2</xref> may be utilized
  to compute the saturation chemical affinity for zircon,</p>
      <p>
        <styled-content id="eq-4">
          <disp-formula>
            <alternatives>
              <tex-math><![CDATA[
  \textbf{A}^{zircon} = \mu_{ZrSiO_4}^{liquid} - \mu_{ZrSiO_4}^{o,zircon}
   \qquad(4)]]></tex-math>
              <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                <mml:mrow>
                  <mml:msup>
                    <mml:mtext mathvariant="bold">𝐀</mml:mtext>
                    <mml:mrow>
                      <mml:mi>z</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>r</mml:mi>
                      <mml:mi>c</mml:mi>
                      <mml:mi>o</mml:mi>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>=</mml:mo>
                  <mml:msubsup>
                    <mml:mi>μ</mml:mi>
                    <mml:mrow>
                      <mml:mi>Z</mml:mi>
                      <mml:mi>r</mml:mi>
                      <mml:mi>S</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:msub>
                        <mml:mi>O</mml:mi>
                        <mml:mn>4</mml:mn>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>l</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>q</mml:mi>
                      <mml:mi>u</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>d</mml:mi>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo>−</mml:mo>
                  <mml:msubsup>
                    <mml:mi>μ</mml:mi>
                    <mml:mrow>
                      <mml:mi>Z</mml:mi>
                      <mml:mi>r</mml:mi>
                      <mml:mi>S</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:msub>
                        <mml:mi>O</mml:mi>
                        <mml:mn>4</mml:mn>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>o</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>z</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>r</mml:mi>
                      <mml:mi>c</mml:mi>
                      <mml:mi>o</mml:mi>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mspace width="2.0em"/>
                  <mml:mrow>
                    <mml:mo stretchy="true" form="prefix">(</mml:mo>
                    <mml:mn>4</mml:mn>
                    <mml:mo stretchy="true" form="postfix">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:math>
            </alternatives>
          </disp-formula>
        </styled-content>
      </p>
      <p>or equivalent zirconium-bearing solid phase, with solid-liquid
  heterogeneous equilibrium (saturation) acheived when
  <inline-formula><alternatives><tex-math><![CDATA[\textbf{A}^{zircon}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msup><mml:mtext mathvariant="bold">𝐀</mml:mtext><mml:mrow><mml:mi>z</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>
  is zero.</p>
    </sec>
    <sec id="data-sources-for-parameter-calibration">
      <title>Data Sources for Parameter Calibration</title>
      <p>We consider four principal sources of experimental data on zircon
  saturation for calibration of the model: (1) the original exploratory
  study of E. Bruce Watson
  (<xref alt="1979" rid="ref-watson1979zircon" ref-type="bibr">1979</xref>),
  (2) the followup study that constructed the first comprehensive
  calibration database by E. Bruce Watson and Harrison
  (<xref alt="1983" rid="ref-WATSON1983295" ref-type="bibr">1983</xref>),
  (3) the study by Boehnke et al.
  (<xref alt="2013" rid="ref-boehnke2013zircon" ref-type="bibr">2013</xref>)
  that extended the experimental dataset to 2.5 GPa, and (4) the more
  recent study of Gervasoni et al.
  (<xref alt="2016" rid="ref-gervasoni2016zircon" ref-type="bibr">2016</xref>)
  that focused on alkaline and aluminous melts. Of these four studies,
  the two of E. Bruce Watson and Harrison
  (<xref alt="1983" rid="ref-WATSON1983295" ref-type="bibr">1983</xref>)
  and Boehnke et al.
  (<xref alt="2013" rid="ref-boehnke2013zircon" ref-type="bibr">2013</xref>)
  will be used for model parameter calibration. E. Bruce Watson
  (<xref alt="1979" rid="ref-watson1979zircon" ref-type="bibr">1979</xref>)
  focused on understanding alakli-zirconate speciation in melts and to
  do so utilized synthetic-, compositionally-restricted systems. While
  his results are valuable in that they illuminate the effect of alakli
  content on zircon saturation, his liquid compositions lie outside of
  the applicable compositional domain of the MELTS model and
  consequently cannot be used to provide quantitative constraints. The
  experimental study of Gervasoni et al.
  (<xref alt="2016" rid="ref-gervasoni2016zircon" ref-type="bibr">2016</xref>)
  extends the compositional range of natural liquids beyond that
  investigated previously, however, the liquids underwent near 100%
  iron-loss to the capsules during each experimental run, raising the
  liklihood that the experiments never achieved equilibrium. Tellingly,
  the zircon saturation geothermometer calibrated by Gervasoni et al.
  (<xref alt="2016" rid="ref-gervasoni2016zircon" ref-type="bibr">2016</xref>)
  yields results on meta-aluminous high silica rhyolites dramatically at
  odds with previous models based on the E. Bruce Watson and Harrison
  (<xref alt="1983" rid="ref-WATSON1983295" ref-type="bibr">1983</xref>)
  and Boehnke et al.
  (<xref alt="2013" rid="ref-boehnke2013zircon" ref-type="bibr">2013</xref>)
  datasets. This observation suggests that the three datasets are
  mutually inconsistent, and we choose to utilize as calibrants the two
  studies whose results are less problematic.</p>
    </sec>
    <sec id="calibration">
      <title>Calibration</title>
      <sec id="assumptions">
        <title>Assumptions</title>
        <p>Our model expression for the chemical potential of the ZrSiO4
    component (<xref alt="Equation 2" rid="eq-2">Equation 2</xref>) will
    be parameterized under the following assumptions:</p>
        <list list-type="order">
          <list-item>
            <label>(1)</label>
            <p>To be compatible with Ghiorso and Gualda
        (<xref alt="2015" rid="ref-ghiorso2015h" ref-type="bibr">2015</xref>)
        (and consequently MELTS and rhyolite-MELTS) the standard state
        properties of all non-zirconium bearing liquid components and
        species will be adopted from Ghiorso and Sack
        (<xref alt="1995" rid="ref-ghiorso1995chemical" ref-type="bibr">1995</xref>)
        as modified by Ghiorso and Gualda
        (<xref alt="2015" rid="ref-ghiorso2015h" ref-type="bibr">2015</xref>).
        In addition, all regular solution interaction parameters not
        involving zirconium-bearing species will be adopted from the
        same source. By so doing we choose to render our Zr-liquid model
        calibration internally consistent with rhyolite-MELTS 1.1
        (<xref alt="Ghiorso and Gualda 2015" rid="ref-ghiorso2015h" ref-type="bibr">Ghiorso
        and Gualda 2015</xref>), which permits calculation of mixed
        H2O-CO2 fluid saturated melt, yet preserves phase equilibrium
        relations associated with the two-feldspar-quartz,
        water-saturated ternary minimum.</p>
          </list-item>
          <list-item>
            <label>(2)</label>
            <p>There are 19 species interaction parameters like
        <inline-formula><alternatives><tex-math><![CDATA[W_{ZrSiO_4, i}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
        another 19 like <inline-formula><alternatives><tex-math><![CDATA[W_{Na_4ZrSi_2O_8, i}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
        and another 19 like <inline-formula><alternatives><tex-math><![CDATA[W_{K_4ZrSi_2O_8, i}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>.
        As there are not enough calibration data of sufficient
        compositional variability to constrain all but a few of them, we
        will assume that all 57 of these paramaters have values of zero.
        This assumption is supported by the observation that all
        naturally occuring magmatic liquids have low concentrations of
        Zr, making it a trace species of low mole fraction.
        Consequently, energetic contributions to the Gibbs Free energy
        via the regular solution terms involving zirconium-bearing
        species will be minimal; Henrian non-ideality will be accounted
        solely by the standard state and entropic terms in
        <xref alt="Equation 1" rid="eq-1">Equation 1</xref> and
        <xref alt="Equation 2" rid="eq-2">Equation 2</xref>.</p>
          </list-item>
          <list-item>
            <label>(3)</label>
            <p>We will assume that <inline-formula><alternatives><tex-math><![CDATA[\mu_{ZrSiO_4}^{o}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow><mml:mi>o</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>
        can be parameterized as</p>
          </list-item>
        </list>
        <p>
          <styled-content id="eq-5">
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
    \mu_{ZrSiO_4}^{o} = \Delta H_{ZrSiO_4} - T \Delta S_{ZrSiO_4} + \left( P - 1 \right) \Delta V_{ZrSiO_4} + \mu_{ZrSiO_4}^{o,zircon}
     \qquad(5)]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mi>μ</mml:mi>
                      <mml:mrow>
                        <mml:mi>Z</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mi>S</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>4</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mi>o</mml:mi>
                    </mml:msubsup>
                    <mml:mo>=</mml:mo>
                    <mml:mi>Δ</mml:mi>
                    <mml:msub>
                      <mml:mi>H</mml:mi>
                      <mml:mrow>
                        <mml:mi>Z</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mi>S</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>4</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>−</mml:mo>
                    <mml:mi>T</mml:mi>
                    <mml:mi>Δ</mml:mi>
                    <mml:msub>
                      <mml:mi>S</mml:mi>
                      <mml:mrow>
                        <mml:mi>Z</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mi>S</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>4</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>+</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mi>P</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mi>Δ</mml:mi>
                    <mml:msub>
                      <mml:mi>V</mml:mi>
                      <mml:mrow>
                        <mml:mi>Z</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mi>S</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>4</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>+</mml:mo>
                    <mml:msubsup>
                      <mml:mi>μ</mml:mi>
                      <mml:mrow>
                        <mml:mi>Z</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mi>S</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>4</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>o</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>z</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mi>c</mml:mi>
                        <mml:mi>o</mml:mi>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mspace width="2.0em"/>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mn>5</mml:mn>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </styled-content>
        </p>
        <p>where <inline-formula><alternatives><tex-math><![CDATA[\Delta H_{ZrSiO_4}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
    <inline-formula><alternatives><tex-math><![CDATA[\Delta S_{ZrSiO_4}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
    and <inline-formula><alternatives><tex-math><![CDATA[\Delta V_{ZrSiO_4}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
    are model parameters that account for the offset of the enthalpy,
    entropy and volume from the solid in the liquid state. Similarly, we
    will assume that <inline-formula><alternatives><tex-math><![CDATA[\mu_{Na_4ZrSi_2O_8}^{o}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow><mml:mi>o</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>
    can be parameterized as</p>
        <p>
          <styled-content id="eq-6">
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
    \mu_{Na_4ZrSi_2O_8}^{o} = \Delta H_{Na_4ZrSi_2O_8} - T \Delta S_{Na_4ZrSi_2O_8} + \left( P - 1 \right) \Delta V_{Na_4ZrSi_2O_8} + \mu_{ZrSiO_4}^{o} + 2 \mu_{Na_2SiO_3}^{o} - \mu_{SiO_2}^{o}
     \qquad(6)]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mi>μ</mml:mi>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                        <mml:msub>
                          <mml:mi>a</mml:mi>
                          <mml:mn>4</mml:mn>
                        </mml:msub>
                        <mml:mi>Z</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mi>S</mml:mi>
                        <mml:msub>
                          <mml:mi>i</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>8</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mi>o</mml:mi>
                    </mml:msubsup>
                    <mml:mo>=</mml:mo>
                    <mml:mi>Δ</mml:mi>
                    <mml:msub>
                      <mml:mi>H</mml:mi>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                        <mml:msub>
                          <mml:mi>a</mml:mi>
                          <mml:mn>4</mml:mn>
                        </mml:msub>
                        <mml:mi>Z</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mi>S</mml:mi>
                        <mml:msub>
                          <mml:mi>i</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>8</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>−</mml:mo>
                    <mml:mi>T</mml:mi>
                    <mml:mi>Δ</mml:mi>
                    <mml:msub>
                      <mml:mi>S</mml:mi>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                        <mml:msub>
                          <mml:mi>a</mml:mi>
                          <mml:mn>4</mml:mn>
                        </mml:msub>
                        <mml:mi>Z</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mi>S</mml:mi>
                        <mml:msub>
                          <mml:mi>i</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>8</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>+</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mi>P</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mi>Δ</mml:mi>
                    <mml:msub>
                      <mml:mi>V</mml:mi>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                        <mml:msub>
                          <mml:mi>a</mml:mi>
                          <mml:mn>4</mml:mn>
                        </mml:msub>
                        <mml:mi>Z</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mi>S</mml:mi>
                        <mml:msub>
                          <mml:mi>i</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>8</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>+</mml:mo>
                    <mml:msubsup>
                      <mml:mi>μ</mml:mi>
                      <mml:mrow>
                        <mml:mi>Z</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mi>S</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>4</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mi>o</mml:mi>
                    </mml:msubsup>
                    <mml:mo>+</mml:mo>
                    <mml:mn>2</mml:mn>
                    <mml:msubsup>
                      <mml:mi>μ</mml:mi>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                        <mml:msub>
                          <mml:mi>a</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                        <mml:mi>S</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>3</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mi>o</mml:mi>
                    </mml:msubsup>
                    <mml:mo>−</mml:mo>
                    <mml:msubsup>
                      <mml:mi>μ</mml:mi>
                      <mml:mrow>
                        <mml:mi>S</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mi>o</mml:mi>
                    </mml:msubsup>
                    <mml:mspace width="2.0em"/>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mn>6</mml:mn>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </styled-content>
        </p>
        <p>where <inline-formula><alternatives><tex-math><![CDATA[\Delta H_{Na_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
    <inline-formula><alternatives><tex-math><![CDATA[\Delta S_{Na_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
    and <inline-formula><alternatives><tex-math><![CDATA[\Delta V_{Na_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
    are additional model parameters that account for the non-coplanarity
    of the standard state free energy of the reciporcal reaction:</p>
        <p>ZrSiO4 + 2Na2SiO3 = Na4ZrSi2O8 + SiO2</p>
        <p>Similarly, <inline-formula><alternatives><tex-math><![CDATA[\mu_{K_4ZrSi_2O_8}^{o}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow><mml:mi>o</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>
    can be parameterized as</p>
        <p>
          <styled-content id="eq-7">
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
    \mu_{K_4ZrSi_2O_8}^{o} = \Delta H_{K_4ZrSi_2O_8} - T \Delta S_{K_4ZrSi_2O_8} + \left( P - 1 \right) \Delta V_{K_4ZrSi_2O_8} + \mu_{ZrSiO_4}^{o} + 4 \mu_{KAlSiO_4}^{o} - 2 \mu_{Al_2O_3}^{o} - 3 \mu_{SiO_2}^{o}
     \qquad(7)]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mi>μ</mml:mi>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>K</mml:mi>
                          <mml:mn>4</mml:mn>
                        </mml:msub>
                        <mml:mi>Z</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mi>S</mml:mi>
                        <mml:msub>
                          <mml:mi>i</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>8</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mi>o</mml:mi>
                    </mml:msubsup>
                    <mml:mo>=</mml:mo>
                    <mml:mi>Δ</mml:mi>
                    <mml:msub>
                      <mml:mi>H</mml:mi>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>K</mml:mi>
                          <mml:mn>4</mml:mn>
                        </mml:msub>
                        <mml:mi>Z</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mi>S</mml:mi>
                        <mml:msub>
                          <mml:mi>i</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>8</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>−</mml:mo>
                    <mml:mi>T</mml:mi>
                    <mml:mi>Δ</mml:mi>
                    <mml:msub>
                      <mml:mi>S</mml:mi>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>K</mml:mi>
                          <mml:mn>4</mml:mn>
                        </mml:msub>
                        <mml:mi>Z</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mi>S</mml:mi>
                        <mml:msub>
                          <mml:mi>i</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>8</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>+</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mi>P</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mi>Δ</mml:mi>
                    <mml:msub>
                      <mml:mi>V</mml:mi>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>K</mml:mi>
                          <mml:mn>4</mml:mn>
                        </mml:msub>
                        <mml:mi>Z</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mi>S</mml:mi>
                        <mml:msub>
                          <mml:mi>i</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>8</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>+</mml:mo>
                    <mml:msubsup>
                      <mml:mi>μ</mml:mi>
                      <mml:mrow>
                        <mml:mi>Z</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mi>S</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>4</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mi>o</mml:mi>
                    </mml:msubsup>
                    <mml:mo>+</mml:mo>
                    <mml:mn>4</mml:mn>
                    <mml:msubsup>
                      <mml:mi>μ</mml:mi>
                      <mml:mrow>
                        <mml:mi>K</mml:mi>
                        <mml:mi>A</mml:mi>
                        <mml:mi>l</mml:mi>
                        <mml:mi>S</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>4</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mi>o</mml:mi>
                    </mml:msubsup>
                    <mml:mo>−</mml:mo>
                    <mml:mn>2</mml:mn>
                    <mml:msubsup>
                      <mml:mi>μ</mml:mi>
                      <mml:mrow>
                        <mml:mi>A</mml:mi>
                        <mml:msub>
                          <mml:mi>l</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>3</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mi>o</mml:mi>
                    </mml:msubsup>
                    <mml:mo>−</mml:mo>
                    <mml:mn>3</mml:mn>
                    <mml:msubsup>
                      <mml:mi>μ</mml:mi>
                      <mml:mrow>
                        <mml:mi>S</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mi>o</mml:mi>
                    </mml:msubsup>
                    <mml:mspace width="2.0em"/>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mn>7</mml:mn>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </styled-content>
        </p>
        <p>where <inline-formula><alternatives><tex-math><![CDATA[\Delta H_{K_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
    <inline-formula><alternatives><tex-math><![CDATA[\Delta S_{K_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
    and <inline-formula><alternatives><tex-math><![CDATA[\Delta V_{K_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
    are model parameters that account for the non-coplanarity of the
    standard state free energy of the reciporcal reaction:</p>
        <p>ZrSiO4 + 4KAlSiO4 = K4ZrSi2O8 + 2Al2O3 + 3SiO2</p>
        <p>These simplifying assumptions yield a nine-parameter model
    expression for evaluation of the liquid chemical potential term in
    <xref alt="Equation 4" rid="eq-4">Equation 4</xref>. For the
    Zr-bearing solid phases, we adopt thermodynamic properties of zircon
    and badeleyite from Robie et al. (1995).</p>
      </sec>
      <sec id="method">
        <title>Method</title>
        <p>The fitting procedure used to calibrate the model requires an
    initial guess of parameter values. We evaluate
    <xref alt="Equation 4" rid="eq-4">Equation 4</xref> for each datum
    in E. Bruce Watson and Harrison
    (<xref alt="1983" rid="ref-WATSON1983295" ref-type="bibr">1983</xref>)
    and Boehnke et al.
    (<xref alt="2013" rid="ref-boehnke2013zircon" ref-type="bibr">2013</xref>)
    using a data reduction workflow documented in the accompanying
    <ext-link ext-link-type="uri" xlink:href="./notebooks/6-Liquid-MELTS-calib-2.ipynb">Jupyter
    notebook</ext-link>. Using a linear least squares proceedure from
    the statmodels Python package
    (<xref alt="Seabold and Perktold 2010" rid="ref-seabold2010statsmodels" ref-type="bibr">Seabold
    and Perktold 2010</xref>), we estimate preliminary values of
    <inline-formula><alternatives><tex-math><![CDATA[\Delta H_{ZrSiO_4}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
    <inline-formula><alternatives><tex-math><![CDATA[\Delta S_{ZrSiO_4}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
    and <inline-formula><alternatives><tex-math><![CDATA[\Delta V_{ZrSiO_4}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
    that minimize residuals of the chemical affinity and negate any
    temperature or pressure dependence to those residuals. Next, from
    the conditions of homogeneous equilibrium
    (<xref alt="Equation 3" rid="eq-3">Equation 3</xref>) we estimate
    equilibrium concentrations of melt zirconium-bearing species and
    choose values of <inline-formula><alternatives><tex-math><![CDATA[\Delta H_{Na_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
    and <inline-formula><alternatives><tex-math><![CDATA[\Delta H_{K_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
    so that all species have concentrations within three orders of
    magnitude of each other. The objective of this exercise is to
    construct an initial guess speciation model that does not embody a
    bias towards the dominance of a particular melt species. Initial
    values of <inline-formula><alternatives><tex-math><![CDATA[\Delta S_{Na_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
    <inline-formula><alternatives><tex-math><![CDATA[\Delta V_{Na_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
    <inline-formula><alternatives><tex-math><![CDATA[\Delta S_{K_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
    and <inline-formula><alternatives><tex-math><![CDATA[\Delta V_{K_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
    are set to zero.</p>
        <p>Parameter refinement is obtained utilizing the trust region
    non-linear least squares method of the optimize module in the SciPy
    Python package
    (<xref alt="Virtanen et al. 2020" rid="ref-2020SciPy-NMeth" ref-type="bibr">Virtanen
    et al. 2020</xref>). On initial refinement, two issues emerged.
    First, the parameter correlation matrix confirmed our expectation
    that derived values of <inline-formula><alternatives><tex-math><![CDATA[\Delta S_{ZrSiO_4}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
    <inline-formula><alternatives><tex-math><![CDATA[\Delta S_{Na_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
    and <inline-formula><alternatives><tex-math><![CDATA[\Delta S_{K_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
    are highly correlated; <inline-formula><alternatives><tex-math><![CDATA[\Delta V_{ZrSiO_4}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
    <inline-formula><alternatives><tex-math><![CDATA[\Delta V_{Na_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
    and <inline-formula><alternatives><tex-math><![CDATA[\Delta V_{K_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
    are also highly correlated. This data driven observation allows us
    to make the simplying assumption that <inline-formula><alternatives><tex-math><![CDATA[\Delta S_{Na_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
    <inline-formula><alternatives><tex-math><![CDATA[\Delta S_{K_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
    <inline-formula><alternatives><tex-math><![CDATA[\Delta S_{K_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
    and <inline-formula><alternatives><tex-math><![CDATA[\Delta V_{K_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
    are zero, which results in the temperature and pressure dependence
    of <inline-formula><alternatives><tex-math><![CDATA[\mu_{Na_4ZrSi_2O_8}^{o}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow><mml:mi>o</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>
    and <inline-formula><alternatives><tex-math><![CDATA[\mu_{K_4ZrSi_2O_8}^{o}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow><mml:mi>o</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>
    to be modeled by <inline-formula><alternatives><tex-math><![CDATA[\Delta S_{ZrSiO_4}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
    and <inline-formula><alternatives><tex-math><![CDATA[\Delta V_{ZrSiO_4}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
    respectively, reducing the parameterization of the model to five
    unknowns. The second issue that emerged from initial refinement is
    that the relative abundance of Na4ZrSi2O8 dominated that of
    K4ZrSi2O8 by orders of magnitude, and did not reflect the relative
    abundance of Na and K in the experimental glass composition. This
    result runs contrary to the observation of E. Bruce Watson and
    Harrison
    (<xref alt="1983" rid="ref-WATSON1983295" ref-type="bibr">1983</xref>)
    who concluded that alkali-zirconate speciation is independent of the
    identity of the alkali. Further parameter refinement clearly
    requires a constraint to be adopted that implements the priors
    observation of E. Bruce Watson and Harrison
    (<xref alt="1983" rid="ref-WATSON1983295" ref-type="bibr">1983</xref>).</p>
        <p>Parameter refinement proceeded by adding an additional residual
    for each experimental observation of the form:</p>
        <p>
          <styled-content id="eq-8">
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
    w_p \log \left( \frac{ \frac{2 n_{12}}{n_{13}} }{ \frac{y_{19}}{y_{20}} } \right)
     \qquad(8)]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>w</mml:mi>
                      <mml:mi>p</mml:mi>
                    </mml:msub>
                    <mml:mo>log</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mfrac>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>12</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>13</mml:mn>
                          </mml:msub>
                        </mml:mfrac>
                        <mml:mfrac>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mn>19</mml:mn>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mn>20</mml:mn>
                          </mml:msub>
                        </mml:mfrac>
                      </mml:mfrac>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mspace width="2.0em"/>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mn>8</mml:mn>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </styled-content>
        </p>
        <p>which corresponds to a weighted (<inline-formula><alternatives><tex-math><![CDATA[w_p]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>w</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math></alternatives></inline-formula>)
    Bayesian logistics function that forces analytical vales of Na/K
    (<inline-formula><alternatives><tex-math><![CDATA[\frac{2 n_{12}}{n_{13}}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>13</mml:mn></mml:msub></mml:mfrac></mml:math></alternatives></inline-formula>)
    to reflect model estimates of (Na,K)-zirconate species abundance
    (<inline-formula><alternatives><tex-math><![CDATA[\frac{y_{19}}{y_{20}}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mfrac><mml:msub><mml:mi>y</mml:mi><mml:mn>19</mml:mn></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mn>20</mml:mn></mml:msub></mml:mfrac></mml:math></alternatives></inline-formula>).
    The weighting is chosen to make the logistic residual the same oder
    of magnitude as the affinity residual, ~2500 J.</p>
        <fig id="tbl-2">
          <caption>
            <p>Table 2: Solution model: Parameter
      estimates</p>
          </caption>
          <table-wrap>
            <table>
              <thead>
                <tr>
                  <th align="left">Parameter:</th>
                  <th align="right">Value:</th>
                  <th align="right">Uncertainty:</th>
                  <th align="right">Units:</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[\Delta H_{ZrSiO_4}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:mrow>
                            <mml:mi>Δ</mml:mi>
                            <mml:msub>
                              <mml:mi>H</mml:mi>
                              <mml:mrow>
                                <mml:mi>Z</mml:mi>
                                <mml:mi>r</mml:mi>
                                <mml:mi>S</mml:mi>
                                <mml:mi>i</mml:mi>
                                <mml:msub>
                                  <mml:mi>O</mml:mi>
                                  <mml:mn>4</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="right">163044</td>
                  <td align="right">6506</td>
                  <td align="right">J</td>
                </tr>
                <tr>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[\Delta S_{ZrSiO_4}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:mrow>
                            <mml:mi>Δ</mml:mi>
                            <mml:msub>
                              <mml:mi>S</mml:mi>
                              <mml:mrow>
                                <mml:mi>Z</mml:mi>
                                <mml:mi>r</mml:mi>
                                <mml:mi>S</mml:mi>
                                <mml:mi>i</mml:mi>
                                <mml:msub>
                                  <mml:mi>O</mml:mi>
                                  <mml:mn>4</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="right">69.24</td>
                  <td align="right">5.26</td>
                  <td align="right">J/K</td>
                </tr>
                <tr>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[\Delta V_{ZrSiO_4}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:mrow>
                            <mml:mi>Δ</mml:mi>
                            <mml:msub>
                              <mml:mi>V</mml:mi>
                              <mml:mrow>
                                <mml:mi>Z</mml:mi>
                                <mml:mi>r</mml:mi>
                                <mml:mi>S</mml:mi>
                                <mml:mi>i</mml:mi>
                                <mml:msub>
                                  <mml:mi>O</mml:mi>
                                  <mml:mn>4</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="right">0.10</td>
                  <td align="right">0.0548</td>
                  <td align="right">J/bar</td>
                </tr>
                <tr>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[\Delta H_{Na_4ZrSi_2O_8}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:mrow>
                            <mml:mi>Δ</mml:mi>
                            <mml:msub>
                              <mml:mi>H</mml:mi>
                              <mml:mrow>
                                <mml:mi>N</mml:mi>
                                <mml:msub>
                                  <mml:mi>a</mml:mi>
                                  <mml:mn>4</mml:mn>
                                </mml:msub>
                                <mml:mi>Z</mml:mi>
                                <mml:mi>r</mml:mi>
                                <mml:mi>S</mml:mi>
                                <mml:msub>
                                  <mml:mi>i</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msub>
                                <mml:msub>
                                  <mml:mi>O</mml:mi>
                                  <mml:mn>8</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="right">-267990</td>
                  <td align="right">5511</td>
                  <td align="right">J</td>
                </tr>
                <tr>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[\Delta H_{K_4ZrSi_2O_8}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:mrow>
                            <mml:mi>Δ</mml:mi>
                            <mml:msub>
                              <mml:mi>H</mml:mi>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mi>K</mml:mi>
                                  <mml:mn>4</mml:mn>
                                </mml:msub>
                                <mml:mi>Z</mml:mi>
                                <mml:mi>r</mml:mi>
                                <mml:mi>S</mml:mi>
                                <mml:msub>
                                  <mml:mi>i</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msub>
                                <mml:msub>
                                  <mml:mi>O</mml:mi>
                                  <mml:mn>8</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="right">-74062</td>
                  <td align="right">5371</td>
                  <td align="right">J</td>
                </tr>
                <tr>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[\Delta S_{Na_4ZrSi_2O_8}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:mrow>
                            <mml:mi>Δ</mml:mi>
                            <mml:msub>
                              <mml:mi>S</mml:mi>
                              <mml:mrow>
                                <mml:mi>N</mml:mi>
                                <mml:msub>
                                  <mml:mi>a</mml:mi>
                                  <mml:mn>4</mml:mn>
                                </mml:msub>
                                <mml:mi>Z</mml:mi>
                                <mml:mi>r</mml:mi>
                                <mml:mi>S</mml:mi>
                                <mml:msub>
                                  <mml:mi>i</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msub>
                                <mml:msub>
                                  <mml:mi>O</mml:mi>
                                  <mml:mn>8</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="right">0</td>
                  <td align="right">5.26</td>
                  <td align="right">J/K</td>
                </tr>
                <tr>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[\Delta S_{K_4ZrSi_2O_8}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:mrow>
                            <mml:mi>Δ</mml:mi>
                            <mml:msub>
                              <mml:mi>S</mml:mi>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mi>K</mml:mi>
                                  <mml:mn>4</mml:mn>
                                </mml:msub>
                                <mml:mi>Z</mml:mi>
                                <mml:mi>r</mml:mi>
                                <mml:mi>S</mml:mi>
                                <mml:msub>
                                  <mml:mi>i</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msub>
                                <mml:msub>
                                  <mml:mi>O</mml:mi>
                                  <mml:mn>8</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="right">0</td>
                  <td align="right">5.26</td>
                  <td align="right">J/K</td>
                </tr>
                <tr>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[\Delta V_{Na_4ZrSi_2O_8}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:mrow>
                            <mml:mi>Δ</mml:mi>
                            <mml:msub>
                              <mml:mi>V</mml:mi>
                              <mml:mrow>
                                <mml:mi>N</mml:mi>
                                <mml:msub>
                                  <mml:mi>a</mml:mi>
                                  <mml:mn>4</mml:mn>
                                </mml:msub>
                                <mml:mi>Z</mml:mi>
                                <mml:mi>r</mml:mi>
                                <mml:mi>S</mml:mi>
                                <mml:msub>
                                  <mml:mi>i</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msub>
                                <mml:msub>
                                  <mml:mi>O</mml:mi>
                                  <mml:mn>8</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="right">0</td>
                  <td align="right">0.0548</td>
                  <td align="right">J/bar</td>
                </tr>
                <tr>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[\Delta V_{K_4ZrSi_2O_8}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:mrow>
                            <mml:mi>Δ</mml:mi>
                            <mml:msub>
                              <mml:mi>V</mml:mi>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mi>K</mml:mi>
                                  <mml:mn>4</mml:mn>
                                </mml:msub>
                                <mml:mi>Z</mml:mi>
                                <mml:mi>r</mml:mi>
                                <mml:mi>S</mml:mi>
                                <mml:msub>
                                  <mml:mi>i</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msub>
                                <mml:msub>
                                  <mml:mi>O</mml:mi>
                                  <mml:mn>8</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="right">0</td>
                  <td align="right">0.0548</td>
                  <td align="right">J/bar</td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
        </fig>
        <fig id="tbl-3">
          <caption>
            <p>Table 3: Solution model: Variance-covariance
      matrix</p>
          </caption>
          <table-wrap>
            <table>
              <colgroup>
                <col width="17%"/>
                <col width="17%"/>
                <col width="17%"/>
                <col width="17%"/>
                <col width="17%"/>
                <col width="17%"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="left"/>
                  <th align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[\Delta H_{Na_4ZrSi_2O_8}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:mrow>
                            <mml:mi>Δ</mml:mi>
                            <mml:msub>
                              <mml:mi>H</mml:mi>
                              <mml:mrow>
                                <mml:mi>N</mml:mi>
                                <mml:msub>
                                  <mml:mi>a</mml:mi>
                                  <mml:mn>4</mml:mn>
                                </mml:msub>
                                <mml:mi>Z</mml:mi>
                                <mml:mi>r</mml:mi>
                                <mml:mi>S</mml:mi>
                                <mml:msub>
                                  <mml:mi>i</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msub>
                                <mml:msub>
                                  <mml:mi>O</mml:mi>
                                  <mml:mn>8</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </th>
                  <th align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[\Delta H_{K_4ZrSi_2O_8}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:mrow>
                            <mml:mi>Δ</mml:mi>
                            <mml:msub>
                              <mml:mi>H</mml:mi>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mi>K</mml:mi>
                                  <mml:mn>4</mml:mn>
                                </mml:msub>
                                <mml:mi>Z</mml:mi>
                                <mml:mi>r</mml:mi>
                                <mml:mi>S</mml:mi>
                                <mml:msub>
                                  <mml:mi>i</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msub>
                                <mml:msub>
                                  <mml:mi>O</mml:mi>
                                  <mml:mn>8</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </th>
                  <th align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[\Delta H_{ZrSiO_4}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:mrow>
                            <mml:mi>Δ</mml:mi>
                            <mml:msub>
                              <mml:mi>H</mml:mi>
                              <mml:mrow>
                                <mml:mi>Z</mml:mi>
                                <mml:mi>r</mml:mi>
                                <mml:mi>S</mml:mi>
                                <mml:mi>i</mml:mi>
                                <mml:msub>
                                  <mml:mi>O</mml:mi>
                                  <mml:mn>4</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </th>
                  <th align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[\Delta S_{ZrSiO_4}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:mrow>
                            <mml:mi>Δ</mml:mi>
                            <mml:msub>
                              <mml:mi>S</mml:mi>
                              <mml:mrow>
                                <mml:mi>Z</mml:mi>
                                <mml:mi>r</mml:mi>
                                <mml:mi>S</mml:mi>
                                <mml:mi>i</mml:mi>
                                <mml:msub>
                                  <mml:mi>O</mml:mi>
                                  <mml:mn>4</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </th>
                  <th align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[\Delta V_{ZrSiO_4}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:mrow>
                            <mml:mi>Δ</mml:mi>
                            <mml:msub>
                              <mml:mi>V</mml:mi>
                              <mml:mrow>
                                <mml:mi>Z</mml:mi>
                                <mml:mi>r</mml:mi>
                                <mml:mi>S</mml:mi>
                                <mml:mi>i</mml:mi>
                                <mml:msub>
                                  <mml:mi>O</mml:mi>
                                  <mml:mn>4</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[\Delta H_{Na_4ZrSi_2O_8}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:mrow>
                            <mml:mi>Δ</mml:mi>
                            <mml:msub>
                              <mml:mi>H</mml:mi>
                              <mml:mrow>
                                <mml:mi>N</mml:mi>
                                <mml:msub>
                                  <mml:mi>a</mml:mi>
                                  <mml:mn>4</mml:mn>
                                </mml:msub>
                                <mml:mi>Z</mml:mi>
                                <mml:mi>r</mml:mi>
                                <mml:mi>S</mml:mi>
                                <mml:msub>
                                  <mml:mi>i</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msub>
                                <mml:msub>
                                  <mml:mi>O</mml:mi>
                                  <mml:mn>8</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">3.03716421e+07</td>
                  <td align="left">2.88194625e+07</td>
                  <td align="left">3.43669687e+07</td>
                  <td align="left">2.80147056e+04</td>
                  <td align="left">1.24200080e+02</td>
                </tr>
                <tr>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[\Delta H_{K_4ZrSi_2O_8}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:mrow>
                            <mml:mi>Δ</mml:mi>
                            <mml:msub>
                              <mml:mi>H</mml:mi>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mi>K</mml:mi>
                                  <mml:mn>4</mml:mn>
                                </mml:msub>
                                <mml:mi>Z</mml:mi>
                                <mml:mi>r</mml:mi>
                                <mml:mi>S</mml:mi>
                                <mml:msub>
                                  <mml:mi>i</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msub>
                                <mml:msub>
                                  <mml:mi>O</mml:mi>
                                  <mml:mn>8</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">2.88194625e+07</td>
                  <td align="left">2.88456358e+07</td>
                  <td align="left">3.37646855e+07</td>
                  <td align="left">2.75552018e+04</td>
                  <td align="left">1.36610058e+02</td>
                </tr>
                <tr>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[\Delta H_{ZrSiO_4}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:mrow>
                            <mml:mi>Δ</mml:mi>
                            <mml:msub>
                              <mml:mi>H</mml:mi>
                              <mml:mrow>
                                <mml:mi>Z</mml:mi>
                                <mml:mi>r</mml:mi>
                                <mml:mi>S</mml:mi>
                                <mml:mi>i</mml:mi>
                                <mml:msub>
                                  <mml:mi>O</mml:mi>
                                  <mml:mn>4</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">3.43669687e+07</td>
                  <td align="left">3.37646855e+07</td>
                  <td align="left">4.23270965e+07</td>
                  <td align="left">3.40635609e+04</td>
                  <td align="left">1. 76449856e+02</td>
                </tr>
                <tr>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[\Delta S_{ZrSiO_4}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:mrow>
                            <mml:mi>Δ</mml:mi>
                            <mml:msub>
                              <mml:mi>S</mml:mi>
                              <mml:mrow>
                                <mml:mi>Z</mml:mi>
                                <mml:mi>r</mml:mi>
                                <mml:mi>S</mml:mi>
                                <mml:mi>i</mml:mi>
                                <mml:msub>
                                  <mml:mi>O</mml:mi>
                                  <mml:mn>4</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">2.80147056e+04</td>
                  <td align="left">2.75552018e+04</td>
                  <td align="left">3.40635609e+04</td>
                  <td align="left">2.76605628e+01</td>
                  <td align="left">1.54646644e-01</td>
                </tr>
                <tr>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[\Delta V_{ZrSiO_4}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:mrow>
                            <mml:mi>Δ</mml:mi>
                            <mml:msub>
                              <mml:mi>V</mml:mi>
                              <mml:mrow>
                                <mml:mi>Z</mml:mi>
                                <mml:mi>r</mml:mi>
                                <mml:mi>S</mml:mi>
                                <mml:mi>i</mml:mi>
                                <mml:msub>
                                  <mml:mi>O</mml:mi>
                                  <mml:mn>4</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">1.24200080e+02</td>
                  <td align="left">1.36610058e+02</td>
                  <td align="left">1.76449856e+02</td>
                  <td align="left">1.54646644e-01</td>
                  <td align="left">3.00057280e-03</td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
        </fig>
        <p>Calibration results in the parameter values provided in
    <xref alt="Table 2" rid="tbl-2">Table 2</xref> and the
    variance-coveriance matrix reported in
    <xref alt="Table 3" rid="tbl-3">Table 3</xref>. The standard
    deviation of recovery of zircon affinities is 3756 J/mol.</p>
        <fig id="fig-1">
          <caption>
            <p>Figure 1: Model Residuals (J) plotted against (upper
      left) sodium content of the liquid, as moles of Na2SiO3, (upper
      right) potasssium content of the liquid, as moles of KAlSiO4,
      (lower left) temperature (K), and (lower right) pressure (bars).
      Red crosses correspond to residuals in the chemical affinity for
      the zircon saturation reaction, and blue crosses correspond to
      residuals in the Na/K logistic function utilized to inforce the
      prior that the ratio of Na to K zirconate species abundance is
      strongly correlated to the measured Na/K ratio in the
      liquid.</p>
          </caption>
          <graphic mimetype="image" mime-subtype="png" xlink:href="images/Figure_Residuals.png"/>
        </fig>
        <fig id="fig-2">
          <caption>
            <p>Figure 2: Model Reported Zr concentrations (ordinate)
      plotted against model estimate Zr concentrations (abscissa) for
      the calibration data set. The estimate is constructed by finding
      the Zr concentration that zeros the chemical affinity for zircon
      saturation in the experimental liquid at fixed temperature and
      pressure.</p>
          </caption>
          <graphic mimetype="image" mime-subtype="png" xlink:href="images/Figure_Zr_Zr.png"/>
        </fig>
        <fig id="fig-3">
          <caption>
            <p>Figure 3: Model predicted Na/K ratios of
      alkali-zirconate species in the liquid (abscissa) plotted against
      measured bulk Na/K ratio in the liquid (ordinate). Green line
      refers to exact correlation. This constraint is imposed as a
      logistic on model calibration. See text.</p>
          </caption>
          <graphic mimetype="image" mime-subtype="png" xlink:href="images/Figure_Na_K.png"/>
        </fig>
        <p>Quality of fit is evaluated in
    <xref alt="Figure 1" rid="fig-1">Figure 1</xref>,
    <xref alt="Figure 2" rid="fig-2">Figure 2</xref> and
    <xref alt="Figure 3" rid="fig-3">Figure 3</xref>.
    <xref alt="Figure 1" rid="fig-1">Figure 1</xref> demonstrates that
    residuals in zircon affinity show no correlation to alakli-content
    of the liquid, nor to temperature and pressure. The lack of
    temperature and pressure dependence of residuals supports our
    simplifying assumption that <inline-formula><alternatives><tex-math><![CDATA[\Delta S_{Na_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
    <inline-formula><alternatives><tex-math><![CDATA[\Delta S_{K_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
    <inline-formula><alternatives><tex-math><![CDATA[\Delta S_{K_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
    and <inline-formula><alternatives><tex-math><![CDATA[\Delta V_{K_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
    may be set to zero. The absence of residual correlation to
    alkali-content implies that alkli-zirconate speciation accounts for
    the alkali-effect on the “effective-concentration” (i.e., the
    activity) of ZrSiO4 in alkali-rich liquids.
    <xref alt="Figure 2" rid="fig-2">Figure 2</xref> demonstrates
    recovery of Zr liquid concentration, calculated by adjusting liquid
    Zr-content in order to zero zircon affinity, plotted against
    measured values. Estimated Zr concentrations scatter about a 1:1
    line plotted against reported concentrations. There is no systematic
    change in scatter of predicted versus measured value as a function
    of Zr-concentration over two orders of magnitude.
    <xref alt="Figure 3" rid="fig-3">Figure 3</xref> illustrates
    recovery of priors residuals for the regression data set. While
    priors residuals are small (fall close to the green line) for
    typical Na/K melt ratios, there is significant deviation at elevated
    Na/K. The consequences of these deviations may effect recovery of
    zircon phase relations in phonolitic or pantelleritic composition
    melts with high Na/K, and this isue will be further examined
    below.</p>
      </sec>
    </sec>
    <sec id="discussion">
      <title>Discussion</title>
      <p>The model calibrated above is evaluated in this section by
  constructing zircon saturation curves for a variety of natural magma
  types and by examing zircon saturation in conjunction with phase
  equilibrium calculations using an augmented rhyolite-MELTS model.</p>
      <fig id="tbl-4">
        <caption>
          <p>Table 4: Bulk compositions of lavas (wt%): [1]
    Carmichael, Turner, and Verhoogen
    (<xref alt="1974" rid="ref-carmichael1974igneous" ref-type="bibr">1974</xref>),
    [2] Lowenstern and Mahood
    (<xref alt="1991" rid="ref-lowenstern1991new" ref-type="bibr">1991</xref>),
    [3] Gualda et al.
    (<xref alt="2012" rid="ref-gualda2012rhyolite" ref-type="bibr">2012</xref>),
    [4] Carmichael
    (<xref alt="1967" rid="ref-carmichael1967mineralogy" ref-type="bibr">1967</xref>),
    Madupite is LH.16 and contains appreciable wadeite, Zr2K4Si6O18.
    This rock has 0.27 wt% ZrO2. The Wyomingite is LH.3. The rock has no
    Zr analysis but other wyomingites have 0.28 wt% ZrO2. All the
    analyses are from Table 12 (page 50)</p>
        </caption>
        <table-wrap>
          <table>
            <colgroup>
              <col width="9%"/>
              <col width="9%"/>
              <col width="9%"/>
              <col width="9%"/>
              <col width="9%"/>
              <col width="9%"/>
              <col width="9%"/>
              <col width="9%"/>
              <col width="9%"/>
              <col width="9%"/>
              <col width="9%"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left"/>
                <th>High-silica rhyolite</th>
                <th>Iceland rhyolite</th>
                <th>California rhyolite</th>
                <th>dacite</th>
                <th>pantellerite</th>
                <th>comendite</th>
                <th>trachyte</th>
                <th>phonolite</th>
                <th>madupite</th>
                <th>wyomingite</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left"/>
                <td>[3]</td>
                <td>[1]</td>
                <td>[1]</td>
                <td>[1]</td>
                <td>[1],[2]</td>
                <td>[1]</td>
                <td>[1]</td>
                <td>[1]</td>
                <td>[4]</td>
                <td>[4]</td>
              </tr>
              <tr>
                <td align="left">SiO2</td>
                <td>77.5</td>
                <td>74.96</td>
                <td>75.04</td>
                <td>63.58</td>
                <td>69.81</td>
                <td>73.06</td>
                <td>57.73</td>
                <td>54.55</td>
                <td>43.56</td>
                <td>50.23</td>
              </tr>
              <tr>
                <td align="left">TiO2</td>
                <td>0.08</td>
                <td>0.23</td>
                <td>0.07</td>
                <td>0.64</td>
                <td>0.45</td>
                <td>0.23</td>
                <td>1.18</td>
                <td>1.60</td>
                <td>2.31</td>
                <td>2.27</td>
              </tr>
              <tr>
                <td align="left">Al2O3</td>
                <td>12.5</td>
                <td>12.55</td>
                <td>12.29</td>
                <td>16.67</td>
                <td>8.59</td>
                <td>9.76</td>
                <td>17.05</td>
                <td>19.00</td>
                <td>7.85</td>
                <td>11.22</td>
              </tr>
              <tr>
                <td align="left">Fe2O3</td>
                <td>0.207</td>
                <td>1.72</td>
                <td>0.33</td>
                <td>2.24</td>
                <td>2.28</td>
                <td>2.74</td>
                <td>2.55</td>
                <td>1.75</td>
                <td>5.57</td>
                <td>3.34</td>
              </tr>
              <tr>
                <td align="left">Cr2O3</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td>0.04</td>
                <td>-</td>
              </tr>
              <tr>
                <td align="left">FeO</td>
                <td>0.473</td>
                <td>0.71</td>
                <td>0.71</td>
                <td>3.00</td>
                <td>5.76</td>
                <td>2.70</td>
                <td>4.35</td>
                <td>3.78</td>
                <td>0.85</td>
                <td>1.84</td>
              </tr>
              <tr>
                <td align="left">MnO</td>
                <td>-</td>
                <td>0.04</td>
                <td>0.05</td>
                <td>0.11</td>
                <td>0.28</td>
                <td>0.13</td>
                <td>0.28</td>
                <td>0.16</td>
                <td>0.15</td>
                <td>0.05</td>
              </tr>
              <tr>
                <td align="left">MgO</td>
                <td>0.03</td>
                <td>0.02</td>
                <td>0.04</td>
                <td>2.12</td>
                <td>0.10</td>
                <td>0.10</td>
                <td>1.11</td>
                <td>1.76</td>
                <td>11.03</td>
                <td>7.09</td>
              </tr>
              <tr>
                <td align="left">CaO</td>
                <td>0.43</td>
                <td>0.90</td>
                <td>0.58</td>
                <td>5.53</td>
                <td>0.42</td>
                <td>0.32</td>
                <td>3.10</td>
                <td>4.07</td>
                <td>11.89</td>
                <td>5.99</td>
              </tr>
              <tr>
                <td align="left">Na2O</td>
                <td>3.98</td>
                <td>4.41</td>
                <td>4.03</td>
                <td>3.98</td>
                <td>6.46</td>
                <td>5.64</td>
                <td>6.81</td>
                <td>9.06</td>
                <td>0.74</td>
                <td>1.37</td>
              </tr>
              <tr>
                <td align="left">K2O</td>
                <td>4.88</td>
                <td>3.65</td>
                <td>4.66</td>
                <td>1.40</td>
                <td>4.49</td>
                <td>4.34</td>
                <td>4.27</td>
                <td>3.64</td>
                <td>7.19</td>
                <td>9.81</td>
              </tr>
              <tr>
                <td align="left">P2O5</td>
                <td>-</td>
                <td>0.04</td>
                <td>0.01</td>
                <td>-</td>
                <td>-</td>
                <td>0.02</td>
                <td>0.34</td>
                <td>0.20</td>
                <td>1.50</td>
                <td>1.89</td>
              </tr>
              <tr>
                <td align="left">H2O</td>
                <td>5.5</td>
                <td>5.5</td>
                <td>5.5</td>
                <td>3.00</td>
                <td>2.5</td>
                <td>2.5</td>
                <td>1.0</td>
                <td>1.0</td>
                <td>1.0</td>
                <td>2.0</td>
              </tr>
              <tr>
                <td align="left">CO2</td>
                <td>0.05</td>
                <td>0.05</td>
                <td>0.05</td>
                <td>0.05</td>
                <td>0.05</td>
                <td>0.05</td>
                <td>0.05</td>
                <td>0.05</td>
                <td>0.05</td>
                <td>0.05</td>
              </tr>
              <tr>
                <td align="left">Zr PPM</td>
                <td>100</td>
                <td>385</td>
                <td>-</td>
                <td>150</td>
                <td>1800</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td>2073</td>
                <td>2073</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </fig>
      <sec id="zircon-saturation-curves">
        <title>Zircon Saturation Curves</title>
        <p>Bulk compositions of a wide variety of silicic magma types are
    listed in <xref alt="Table 4" rid="tbl-4">Table 4</xref>. This
    tabulation includes determinations of Zr concentration. Bulk
    compositions listed in the first four columns of
    <xref alt="Table 4" rid="tbl-4">Table 4</xref> are likely zircon
    saturated, whereas magma types listed in columns five through ten
    are not associated with a zircon solid phase. The madupite and
    wyomingite represent extreme compositions and are saturated with the
    zirconium-bearing mineral wadeite, Zr2K4Si6O18, which forms in lieu
    of zircon in these rocks.</p>
        <p/>
        <fig id="fig-4">
          <caption>
            <p>Figure 4: Zircon Saturation Curves</p>
          </caption>
          <table-wrap>
            <table>
              <colgroup>
                <col width="100%"/>
              </colgroup>
              <tbody>
                <tr>
                  <td align="left">
                    <p specific-use="wrapper">
                      <boxed-text>
                        <fig id="fig-4a">
                          <caption>
                            <p>(a) High-silica rhyolite</p>
                          </caption>
                          <graphic mimetype="image" mime-subtype="png" xlink:href="images/zircon_sat_rhyolite.png"/>
                        </fig>
                      </boxed-text>
                    </p>
                  </td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
          <table-wrap>
            <table>
              <colgroup>
                <col width="100%"/>
              </colgroup>
              <tbody>
                <tr>
                  <td align="left">
                    <p specific-use="wrapper">
                      <boxed-text>
                        <fig id="fig-4b">
                          <caption>
                            <p>(b) Icelandic rhyolite</p>
                          </caption>
                          <graphic mimetype="image" mime-subtype="png" xlink:href="images/zircon_sat_Iceland-rhyolite.png"/>
                        </fig>
                      </boxed-text>
                    </p>
                  </td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
          <table-wrap>
            <table>
              <colgroup>
                <col width="100%"/>
              </colgroup>
              <tbody>
                <tr>
                  <td align="left">
                    <p specific-use="wrapper">
                      <boxed-text>
                        <fig id="fig-4c">
                          <caption>
                            <p>(c) California rhyolite</p>
                          </caption>
                          <graphic mimetype="image" mime-subtype="png" xlink:href="images/zircon_sat_California-rhyolite.png"/>
                        </fig>
                      </boxed-text>
                    </p>
                  </td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
          <table-wrap>
            <table>
              <colgroup>
                <col width="100%"/>
              </colgroup>
              <tbody>
                <tr>
                  <td align="left">
                    <p specific-use="wrapper">
                      <boxed-text>
                        <fig id="fig-4d">
                          <caption>
                            <p>(d) Dacite</p>
                          </caption>
                          <graphic mimetype="image" mime-subtype="png" xlink:href="images/zircon_sat_dacite.png"/>
                        </fig>
                      </boxed-text>
                    </p>
                  </td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
          <table-wrap>
            <table>
              <colgroup>
                <col width="100%"/>
              </colgroup>
              <tbody>
                <tr>
                  <td align="left">
                    <p specific-use="wrapper">
                      <boxed-text>
                        <fig id="fig-4e">
                          <caption>
                            <p>(e) Pantellerite</p>
                          </caption>
                          <graphic mimetype="image" mime-subtype="png" xlink:href="images/zircon_sat_pantellerite.png"/>
                        </fig>
                      </boxed-text>
                    </p>
                  </td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
          <table-wrap>
            <table>
              <colgroup>
                <col width="100%"/>
              </colgroup>
              <tbody>
                <tr>
                  <td align="left">
                    <p specific-use="wrapper">
                      <boxed-text>
                        <fig id="fig-4f">
                          <caption>
                            <p>(f) Comendite</p>
                          </caption>
                          <graphic mimetype="image" mime-subtype="png" xlink:href="images/zircon_sat_comendite.png"/>
                        </fig>
                      </boxed-text>
                    </p>
                  </td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
          <table-wrap>
            <table>
              <colgroup>
                <col width="100%"/>
              </colgroup>
              <tbody>
                <tr>
                  <td align="left">
                    <p specific-use="wrapper">
                      <boxed-text>
                        <fig id="fig-4g">
                          <caption>
                            <p>(g) Trachyte</p>
                          </caption>
                          <graphic mimetype="image" mime-subtype="png" xlink:href="images/zircon_sat_trachyte.png"/>
                        </fig>
                      </boxed-text>
                    </p>
                  </td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
          <table-wrap>
            <table>
              <colgroup>
                <col width="100%"/>
              </colgroup>
              <tbody>
                <tr>
                  <td align="left">
                    <p specific-use="wrapper">
                      <boxed-text>
                        <fig id="fig-4h">
                          <caption>
                            <p>(h) Phonolite</p>
                          </caption>
                          <graphic mimetype="image" mime-subtype="png" xlink:href="images/zircon_sat_phonolite.png"/>
                        </fig>
                      </boxed-text>
                    </p>
                  </td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
          <table-wrap>
            <table>
              <colgroup>
                <col width="100%"/>
              </colgroup>
              <tbody>
                <tr>
                  <td align="left">
                    <p specific-use="wrapper">
                      <boxed-text>
                        <fig id="fig-4i">
                          <caption>
                            <p>(i) Madupite</p>
                          </caption>
                          <graphic mimetype="image" mime-subtype="png" xlink:href="images/zircon_sat_madupite.png"/>
                        </fig>
                      </boxed-text>
                    </p>
                  </td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
          <table-wrap>
            <table>
              <colgroup>
                <col width="100%"/>
              </colgroup>
              <tbody>
                <tr>
                  <td align="left">
                    <p specific-use="wrapper">
                      <boxed-text>
                        <fig id="fig-4j">
                          <caption>
                            <p>(j) Wyomingite</p>
                          </caption>
                          <graphic mimetype="image" mime-subtype="png" xlink:href="images/zircon_sat_wyomingite.png"/>
                        </fig>
                      </boxed-text>
                    </p>
                  </td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
        </fig>
        <p>For each magma type listed in
    <xref alt="Table 4" rid="tbl-4">Table 4</xref> a zircon saturation
    curve is constructed and plotted in
    <xref alt="Figure 4 (a)" rid="fig-4a">Figure 4 (a)</xref> through
    <xref alt="Figure 4 (j)" rid="fig-4j">Figure 4 (j)</xref>. For each
    sub-figure, the mean zircon saturation curve is plotted along with
    its 5% and 95% quartile. Calculations are based on a Monte Carlo
    propoagtion of uncertainties using parameter estimates constructed
    from the variance-covariance matrix of
    <xref alt="Table 3" rid="tbl-3">Table 3</xref>. The right-most
    panels display abundances of zirconium-bearing species in the melt
    with equivalent quartile estimates.</p>
        <p>At reported Zr concentrations, saturation conditions for
    fluid-saturated high-silica rhyolite (Bishop Tuff,
    <xref alt="Figure 4 (a)" rid="fig-4a">Figure 4 (a)</xref>) are
    similar to those estimated using the empirical geothermometer of
    Watson and Harrison (1983). Saturation conditions for the Iceland
    rhyolite (Thingmuli, <xref alt="Figure 4 (b)" rid="fig-4b">Figure 4
    (b)</xref>) are consistent with expected higher-temperatures of
    these lavas given their lower water contents. The Iceland rhyolite
    also has a higher Na/K ratio than its continental equivalent. The
    northern California rhyolite displayed in
    <xref alt="Figure 4 (c)" rid="fig-4c">Figure 4 (c)</xref> has
    saturation conditions similar to the Bishop magma, and the dacite
    (<xref alt="Figure 4 (d)" rid="fig-4d">Figure 4 (d)</xref>) is
    undersaturated with zircon at the expected storage temperature
    conditions, but Zr contents are consistent with saturation for a
    rhyolitic residuum of this bulk composition.</p>
        <p>Despite their high Zr-concentrations, peralkaline rhyolites in
    <xref alt="Table 4" rid="tbl-4">Table 4</xref> (a pantellerite from
    Pantelleria and a comendite from Mayor Island, NZ) are not saturated
    with zircon. Water contents for the pantellerite (Lowenstern and
    Mahood, 1991) are ~1.8 wt% and consequently the inferred solidus
    temperatures are high, perhaps comparable to Icelandic rhyolites.
    Reported Zr abundances in these lavas (1800 and 2300 PPM,
    respectively) suggest model zircon saturation temperature below
    ~750°C (<xref alt="Figure 4 (e)" rid="fig-4e">Figure 4 (e)</xref>)
    and ~870°C (<xref alt="Figure 4 (f)" rid="fig-4f">Figure 4
    (f)</xref>). Arguing from the basis of phase relations for the
    ferromagesian silicates and the absence of Fe-Ti oxides associated
    with these lavas, Nicholls and Carmichael
    (<xref alt="1969" rid="ref-nicholls1969peralkaline" ref-type="bibr">1969</xref>)
    conclude that likely liquidus temperatures fall between 900°C and
    1025°C. Given that water contents of the magma indicate strongly
    undersaturated conditions, the solidus is likely to be within 100°C
    of liquidus. Our model predictions of zircon saturation are
    consistent with these conclusions, indicating that Zr-concentration
    is barely sufficient to saturate these lavas with zircon prior to
    eruption.</p>
        <p>Model stauration curves for trachyte
    (<xref alt="Figure 4 (g)" rid="fig-4g">Figure 4 (g)</xref>) and
    phonolite (<xref alt="Figure 4 (h)" rid="fig-4h">Figure 4
    (h)</xref>) reveal that Zr-concentrations must be on the order of a
    weight percent in order to saturate these liquids with zircon. An
    additional observation is that the shape of the saturation curves is
    strongly influenced by temperature. To understand why, consider that
    these liquids simultaneously have higher absolute concentrations Zr
    and Na and higher Na/K ratios; the Na-zirconate species has
    abundance comparable to ZrSiO4. Assuming
    <inline-formula><alternatives><tex-math><![CDATA[x]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula>
    is the fraction of Na-zirconate species and
    <inline-formula><alternatives><tex-math><![CDATA[1-x]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
    is the fraction of ZrSiO4, the dissolution of zircon proceeds via
    the reaction:</p>
        <p>ZrSiO4<italic>zircon</italic> + <inline-formula><alternatives><tex-math><![CDATA[2 x]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mn>2</mml:mn><mml:mi>x</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
    Na2SiO3<italic>liquid</italic> = <inline-formula><alternatives><tex-math><![CDATA[x]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula>
    Na4ZrSi2O8<italic>liquid</italic> + <inline-formula><alternatives><tex-math><![CDATA[\left( 1-x \right)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
    ZrSiO4<italic>liquid</italic> + <inline-formula><alternatives><tex-math><![CDATA[x]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula>
    SiO2<italic>liquid</italic></p>
        <p>The temperature dependence of zircon saturation is consequently a
    reflection of the entropy of this dissolution reaction, which is</p>
        <p>
          <styled-content id="eq-9">
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
    \Delta S = x \bar{s}_{Na_4ZrSi_2O_8}^{liquid} + \left( 1-x \right) \bar{s}_{ZrSiO_4}^{liquid} + x \bar{s}_{SiO_2}^{liquid} - 2 x \bar{s}_{Na_2SiO_3}^{liquid} - \bar{s}_{ZrSiO_4}^{zircon}
     \qquad(9)]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:mi>Δ</mml:mi>
                    <mml:mi>S</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mi>x</mml:mi>
                    <mml:msubsup>
                      <mml:mover>
                        <mml:mi>s</mml:mi>
                        <mml:mo accent="true">‾</mml:mo>
                      </mml:mover>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                        <mml:msub>
                          <mml:mi>a</mml:mi>
                          <mml:mn>4</mml:mn>
                        </mml:msub>
                        <mml:mi>Z</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mi>S</mml:mi>
                        <mml:msub>
                          <mml:mi>i</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>8</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:mi>q</mml:mi>
                        <mml:mi>u</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:mi>d</mml:mi>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo>+</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>−</mml:mo>
                      <mml:mi>x</mml:mi>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:msubsup>
                      <mml:mover>
                        <mml:mi>s</mml:mi>
                        <mml:mo accent="true">‾</mml:mo>
                      </mml:mover>
                      <mml:mrow>
                        <mml:mi>Z</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mi>S</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>4</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:mi>q</mml:mi>
                        <mml:mi>u</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:mi>d</mml:mi>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo>+</mml:mo>
                    <mml:mi>x</mml:mi>
                    <mml:msubsup>
                      <mml:mover>
                        <mml:mi>s</mml:mi>
                        <mml:mo accent="true">‾</mml:mo>
                      </mml:mover>
                      <mml:mrow>
                        <mml:mi>S</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:mi>q</mml:mi>
                        <mml:mi>u</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:mi>d</mml:mi>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo>−</mml:mo>
                    <mml:mn>2</mml:mn>
                    <mml:mi>x</mml:mi>
                    <mml:msubsup>
                      <mml:mover>
                        <mml:mi>s</mml:mi>
                        <mml:mo accent="true">‾</mml:mo>
                      </mml:mover>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                        <mml:msub>
                          <mml:mi>a</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                        <mml:mi>S</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>3</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:mi>q</mml:mi>
                        <mml:mi>u</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:mi>d</mml:mi>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo>−</mml:mo>
                    <mml:msubsup>
                      <mml:mover>
                        <mml:mi>s</mml:mi>
                        <mml:mo accent="true">‾</mml:mo>
                      </mml:mover>
                      <mml:mrow>
                        <mml:mi>Z</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mi>S</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>4</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>z</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mi>c</mml:mi>
                        <mml:mi>o</mml:mi>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mspace width="2.0em"/>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mn>9</mml:mn>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </styled-content>
        </p>
        <p>The standard state entropy change contribution to
    <xref alt="Equation 9" rid="eq-9">Equation 9</xref> is zero under
    the model calibration asumptions made previously, so, this
    expression reduces to:</p>
        <p>
          <styled-content id="eq-10">
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
    \Delta S \approx - x R \log X_{Na_4ZrSi_2O_8} - \left( 1-x \right) R \log X_{ZrSiO_4} - x R \log X_{SiO_2} + 2 x R \log X_{Na_2SiO_3} \approx - R \log \left( \frac{X_{Na_4ZrSi_2O_8}^x X_{ZrSiO_4}^{1-x} X_{SiO_2}^x}{X_{Na_2SiO_3}^{2x}} \right) = - R \log \left( X_{Na_4ZrSi_2O_8}^x X_{ZrSiO_4}^{1-x} \right) - R x \log \left( \frac{X_{SiO_2}}{X_{Na_2SiO_3}^{2}} \right)
     \qquad(10)]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:mi>Δ</mml:mi>
                    <mml:mi>S</mml:mi>
                    <mml:mo>≈</mml:mo>
                    <mml:mo>−</mml:mo>
                    <mml:mi>x</mml:mi>
                    <mml:mi>R</mml:mi>
                    <mml:mo>log</mml:mo>
                    <mml:msub>
                      <mml:mi>X</mml:mi>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                        <mml:msub>
                          <mml:mi>a</mml:mi>
                          <mml:mn>4</mml:mn>
                        </mml:msub>
                        <mml:mi>Z</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mi>S</mml:mi>
                        <mml:msub>
                          <mml:mi>i</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>8</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>−</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>−</mml:mo>
                      <mml:mi>x</mml:mi>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mi>R</mml:mi>
                    <mml:mo>log</mml:mo>
                    <mml:msub>
                      <mml:mi>X</mml:mi>
                      <mml:mrow>
                        <mml:mi>Z</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mi>S</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>4</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>−</mml:mo>
                    <mml:mi>x</mml:mi>
                    <mml:mi>R</mml:mi>
                    <mml:mo>log</mml:mo>
                    <mml:msub>
                      <mml:mi>X</mml:mi>
                      <mml:mrow>
                        <mml:mi>S</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>+</mml:mo>
                    <mml:mn>2</mml:mn>
                    <mml:mi>x</mml:mi>
                    <mml:mi>R</mml:mi>
                    <mml:mo>log</mml:mo>
                    <mml:msub>
                      <mml:mi>X</mml:mi>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                        <mml:msub>
                          <mml:mi>a</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                        <mml:mi>S</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mn>3</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>≈</mml:mo>
                    <mml:mo>−</mml:mo>
                    <mml:mi>R</mml:mi>
                    <mml:mo>log</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mi>X</mml:mi>
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                              <mml:msub>
                                <mml:mi>a</mml:mi>
                                <mml:mn>4</mml:mn>
                              </mml:msub>
                              <mml:mi>Z</mml:mi>
                              <mml:mi>r</mml:mi>
                              <mml:mi>S</mml:mi>
                              <mml:msub>
                                <mml:mi>i</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msub>
                              <mml:msub>
                                <mml:mi>O</mml:mi>
                                <mml:mn>8</mml:mn>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:msubsup>
                          <mml:msubsup>
                            <mml:mi>X</mml:mi>
                            <mml:mrow>
                              <mml:mi>Z</mml:mi>
                              <mml:mi>r</mml:mi>
                              <mml:mi>S</mml:mi>
                              <mml:mi>i</mml:mi>
                              <mml:msub>
                                <mml:mi>O</mml:mi>
                                <mml:mn>4</mml:mn>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                              <mml:mo>−</mml:mo>
                              <mml:mi>x</mml:mi>
                            </mml:mrow>
                          </mml:msubsup>
                          <mml:msubsup>
                            <mml:mi>X</mml:mi>
                            <mml:mrow>
                              <mml:mi>S</mml:mi>
                              <mml:mi>i</mml:mi>
                              <mml:msub>
                                <mml:mi>O</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:msubsup>
                        </mml:mrow>
                        <mml:msubsup>
                          <mml:mi>X</mml:mi>
                          <mml:mrow>
                            <mml:mi>N</mml:mi>
                            <mml:msub>
                              <mml:mi>a</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                            <mml:mi>S</mml:mi>
                            <mml:mi>i</mml:mi>
                            <mml:msub>
                              <mml:mi>O</mml:mi>
                              <mml:mn>3</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mfrac>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:mo>−</mml:mo>
                    <mml:mi>R</mml:mi>
                    <mml:mo>log</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:msubsup>
                        <mml:mi>X</mml:mi>
                        <mml:mrow>
                          <mml:mi>N</mml:mi>
                          <mml:msub>
                            <mml:mi>a</mml:mi>
                            <mml:mn>4</mml:mn>
                          </mml:msub>
                          <mml:mi>Z</mml:mi>
                          <mml:mi>r</mml:mi>
                          <mml:mi>S</mml:mi>
                          <mml:msub>
                            <mml:mi>i</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>O</mml:mi>
                            <mml:mn>8</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mi>x</mml:mi>
                      </mml:msubsup>
                      <mml:msubsup>
                        <mml:mi>X</mml:mi>
                        <mml:mrow>
                          <mml:mi>Z</mml:mi>
                          <mml:mi>r</mml:mi>
                          <mml:mi>S</mml:mi>
                          <mml:mi>i</mml:mi>
                          <mml:msub>
                            <mml:mi>O</mml:mi>
                            <mml:mn>4</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                          <mml:mo>−</mml:mo>
                          <mml:mi>x</mml:mi>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>−</mml:mo>
                    <mml:mi>R</mml:mi>
                    <mml:mi>x</mml:mi>
                    <mml:mo>log</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mfrac>
                        <mml:msub>
                          <mml:mi>X</mml:mi>
                          <mml:mrow>
                            <mml:mi>S</mml:mi>
                            <mml:mi>i</mml:mi>
                            <mml:msub>
                              <mml:mi>O</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msubsup>
                          <mml:mi>X</mml:mi>
                          <mml:mrow>
                            <mml:mi>N</mml:mi>
                            <mml:msub>
                              <mml:mi>a</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                            <mml:mi>S</mml:mi>
                            <mml:mi>i</mml:mi>
                            <mml:msub>
                              <mml:mi>O</mml:mi>
                              <mml:mn>3</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:msubsup>
                      </mml:mfrac>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mspace width="2.0em"/>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mn>10</mml:mn>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </styled-content>
        </p>
        <p>if we consider non-ideal contributions to the Gibbs Free Energy
    to be second order. If <inline-formula><alternatives><tex-math><![CDATA[z]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>z</mml:mi></mml:math></alternatives></inline-formula>
    is the total mole fraction of all zirconate species, then
    <inline-formula><alternatives><tex-math><![CDATA[X_{Na_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
    is approximately <inline-formula><alternatives><tex-math><![CDATA[z x]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>z</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
    and <inline-formula><alternatives><tex-math><![CDATA[X_{ZrSiO_4}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
    is approcimately <inline-formula><alternatives><tex-math><![CDATA[z \left( 1-x \right)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
    and <xref alt="Equation 10" rid="eq-10">Equation 10</xref>
    becomes</p>
        <p>
          <styled-content id="eq-11">
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
    \Delta S \approx - R \log \left[ z^x x^x z^{1-x} \left( 1 - x \right) ^{1-x} \right] - R x \log \left( \frac{X_{SiO_2}}{X_{Na_2SiO_3}^{2}} \right) = -R \log z - R \left[ x^x \left( 1 - x \right) ^{1-x} \right] - R x \log \left( \frac{X_{SiO_2}}{X_{Na_2SiO_3}^{2}} \right)
     \qquad(11)]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:mi>Δ</mml:mi>
                    <mml:mi>S</mml:mi>
                    <mml:mo>≈</mml:mo>
                    <mml:mo>−</mml:mo>
                    <mml:mi>R</mml:mi>
                    <mml:mo>log</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">[</mml:mo>
                      <mml:msup>
                        <mml:mi>z</mml:mi>
                        <mml:mi>x</mml:mi>
                      </mml:msup>
                      <mml:msup>
                        <mml:mi>x</mml:mi>
                        <mml:mi>x</mml:mi>
                      </mml:msup>
                      <mml:msup>
                        <mml:mi>z</mml:mi>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                          <mml:mo>−</mml:mo>
                          <mml:mi>x</mml:mi>
                        </mml:mrow>
                      </mml:msup>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">(</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo>−</mml:mo>
                          <mml:mi>x</mml:mi>
                          <mml:mo stretchy="true" form="postfix">)</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                          <mml:mo>−</mml:mo>
                          <mml:mi>x</mml:mi>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo stretchy="true" form="postfix">]</mml:mo>
                    </mml:mrow>
                    <mml:mo>−</mml:mo>
                    <mml:mi>R</mml:mi>
                    <mml:mi>x</mml:mi>
                    <mml:mo>log</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mfrac>
                        <mml:msub>
                          <mml:mi>X</mml:mi>
                          <mml:mrow>
                            <mml:mi>S</mml:mi>
                            <mml:mi>i</mml:mi>
                            <mml:msub>
                              <mml:mi>O</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msubsup>
                          <mml:mi>X</mml:mi>
                          <mml:mrow>
                            <mml:mi>N</mml:mi>
                            <mml:msub>
                              <mml:mi>a</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                            <mml:mi>S</mml:mi>
                            <mml:mi>i</mml:mi>
                            <mml:msub>
                              <mml:mi>O</mml:mi>
                              <mml:mn>3</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:msubsup>
                      </mml:mfrac>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:mo>−</mml:mo>
                    <mml:mi>R</mml:mi>
                    <mml:mo>log</mml:mo>
                    <mml:mi>z</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mi>R</mml:mi>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">[</mml:mo>
                      <mml:msup>
                        <mml:mi>x</mml:mi>
                        <mml:mi>x</mml:mi>
                      </mml:msup>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">(</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo>−</mml:mo>
                          <mml:mi>x</mml:mi>
                          <mml:mo stretchy="true" form="postfix">)</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                          <mml:mo>−</mml:mo>
                          <mml:mi>x</mml:mi>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo stretchy="true" form="postfix">]</mml:mo>
                    </mml:mrow>
                    <mml:mo>−</mml:mo>
                    <mml:mi>R</mml:mi>
                    <mml:mi>x</mml:mi>
                    <mml:mo>log</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mfrac>
                        <mml:msub>
                          <mml:mi>X</mml:mi>
                          <mml:mrow>
                            <mml:mi>S</mml:mi>
                            <mml:mi>i</mml:mi>
                            <mml:msub>
                              <mml:mi>O</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msubsup>
                          <mml:mi>X</mml:mi>
                          <mml:mrow>
                            <mml:mi>N</mml:mi>
                            <mml:msub>
                              <mml:mi>a</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                            <mml:mi>S</mml:mi>
                            <mml:mi>i</mml:mi>
                            <mml:msub>
                              <mml:mi>O</mml:mi>
                              <mml:mn>3</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:msubsup>
                      </mml:mfrac>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mspace width="2.0em"/>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mn>11</mml:mn>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </styled-content>
        </p>
        <p>The last logaithmic term in
    <xref alt="Equation 11" rid="eq-11">Equation 11</xref> is a linear
    function of the fraction of Na-zirconate species
    (<inline-formula><alternatives><tex-math><![CDATA[x]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula>)
    and for the trachyte bulk composition is approximately
    <inline-formula><alternatives><tex-math><![CDATA[- 41 x]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>−</mml:mo><mml:mn>41</mml:mn><mml:mi>x</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
    J. The first term has a value of approximately 40 J, but decreases
    as Zr concentration in the melt increases. The central term has a
    positive maximum at <inline-formula><alternatives><tex-math><![CDATA[x = \frac{1}{2}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>
    of ~ 6 J and falls parabolically to zero at lower or higher
    Na-zirconate mole fractions.</p>
        <p>This analysis allows us to better understand the shape of the
    zircon saturation curves for the trachyte and phonolite. A positive
    slope for these curves requires a positive
    <inline-formula><alternatives><tex-math><![CDATA[\Delta S]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>,
    as the dissolution reaction must go to the right as temperature
    increases, and in previous cases, where the total mole fraction of
    Zr-bearing species in the liquid is very low, the first term in
    <xref alt="Equation 11" rid="eq-11">Equation 11</xref> dominates and
    the saturation curves have a positive slope. However, as the
    Zr-concentration in the melt increases, the dominance of the first
    term diminishes, the contribution of the second and third terms
    become significant in determing the sign of the entropy change. In
    particular, if the fraction of Na-zirconate species decreaes with
    increasing <italic>T</italic>, then the third term in
    <xref alt="Equation 11" rid="eq-11">Equation 11</xref>, which is
    negative, is more likely to dominate the exression and lead to a
    turnover in the saturation curve. The conclusion is that higher
    overall concentration of Zr in the liquid coupled with the presence
    of near equal abundances of Na-zirconate and ZrSiO4 species, governs
    the unusual shape of the zircon saturation curves. If these magmas
    did saturate with zircon, its presence would lead to an
    unsatisfactory geothermometer.</p>
        <p>The final magma types considered, maduite
    (<xref alt="Figure 4 (i)" rid="fig-4i">Figure 4 (i)</xref>) and
    wyomingite (<xref alt="Figure 4 (j)" rid="fig-4j">Figure 4
    (j)</xref>), represent bulk compositions with extremely high K/Na
    ratios. Neither magma precipitates zircon, but both form a
    Zr-bearing phenocryst phase, wadeite. Reported concentrations of Zr
    are at the 2000 PPM level. Our model calculations suggest that
    measured concentrations are about an order of magnitude below those
    required to saturate zircon, and that Zr is predominantly presence
    as both K-zirconate and ZrSiO4 species in the melt.</p>
        <p>The calculations summarized in
    <xref alt="Figure 4 (a)" rid="fig-4a">Figure 4 (a)</xref> through
    <xref alt="Figure 4 (j)" rid="fig-4j">Figure 4 (j)</xref> were
    performed at a pressure of 200 MPa. The effect of pressure on these
    results is insignificant, e.g. for the high-silica rhyolite assuming
    100 PPM Zr in the liquid, the saturation temperature is 744.7°C at
    100 Ma, 745.5°C at 200 MPa, 745.9°C at 300 MPa. This effect is
    typical for all compositions examined.</p>
      </sec>
      <sec id="phase-equilibria">
        <title>Phase Equilibria</title>
        <fig id="fig-5">
          <caption>
            <p>Figure 5: Phase relations for high-silica rhyolite
      calculated using rhyolite-MELTS (v1.1) and the model presented in
      this paper. Equilibrium crystallization. Dashed line denotes the
      onset of zircon saturation at 757.4°C.</p>
          </caption>
          <graphic mimetype="image" mime-subtype="png" xlink:href="images/MELTS-zr-rhyolite.png"/>
        </fig>
        <p>As the calibrated model is compatible with rhyolite-MELTS (v.
    1.1), we may use it to calculate phase equilibria in zircon-bearing
    assemblages. In <xref alt="Figure 5" rid="fig-5">Figure 5</xref>
    phase proportions during crystallization of a high-silica rhyolite
    (<xref alt="Table 4" rid="tbl-4">Table 4</xref>) are illustrated.
    The workflow for this calculation is documented in
    <ext-link ext-link-type="uri" xlink:href="notebooks/7-MELTS-with-Zr.ipynb">this
    Jupyter notebook</ext-link>.</p>
        <p>The most notable feature of the phase diagram presented in
    <xref alt="Figure 5" rid="fig-5">Figure 5</xref> is that the onset
    of zircon saturation is at 757.4°C in contrast to the calculated
    geothermometer temperature of 745.9°C (see below). This temperature
    difference is due largely to the effect of expulsion of fluid and
    the crystallization of two feldspars and quartz, which elevates the
    concentration of the incompatible element Zr in the liquid,
    permiting saturation of zircon at higher temperature. This
    temperature discrepancy highlights the liklihood that application of
    zircon geothermometry to bulk rock compositions is problematic, even
    when such compositions are representitive of near eutectic melts. In
    practical terms, the uncertainty in calculated phase relations is
    large enough to encompass these temperature differences, but the
    relative offset is important to consider, and every effort should be
    made to utilize high quality glass analyses to avoid systematic
    bias.</p>
      </sec>
      <sec id="geothermometry">
        <title>Geothermometry</title>
        <p/>
        <fig id="fig-6">
          <caption>
            <p>Figure 6: Temperature recovery from zircon saturation
      data sets</p>
          </caption>
          <table-wrap>
            <table>
              <colgroup>
                <col width="100%"/>
              </colgroup>
              <tbody>
                <tr>
                  <td align="left">
                    <p specific-use="wrapper">
                      <boxed-text>
                        <fig id="fig-6a">
                          <caption>
                            <p>(a) Temperature recovery for the
                    calibration data set. Red symbols denote reported
                    temperatures and Zr concentration (with
                    uncertainties), green symbols the most likely model
                    temperature. Each green symbol is enclosed by a
                    parallelogram (in yellow) whose vertices are defined
                    by the 5% and 95% quartiles associated with Monte
                    Carlo error propagation of model parameters. The
                    reported and most likely model temperature are
                    connected by a black dashed line for each
                    expetimental datum. The inset plots reported
                    temperature against model temperature for the
                    average Zr concentration with error brackets at the
                    5% and 95% quartile.</p>
                          </caption>
                          <graphic mimetype="image" mime-subtype="png" xlink:href="images/Temperature_recovery.png"/>
                        </fig>
                      </boxed-text>
                    </p>
                  </td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
          <table-wrap>
            <table>
              <colgroup>
                <col width="100%"/>
              </colgroup>
              <tbody>
                <tr>
                  <td align="left">
                    <p specific-use="wrapper">
                      <boxed-text>
                        <fig id="fig-6b">
                          <caption>
                            <p>(b) Temperature recovery for the E.
                    Bruce Watson and Harrison
                    (<xref alt="1983" rid="ref-WATSON1983295" ref-type="bibr">1983</xref>)
                    data set. See legend for panel “a”.</p>
                          </caption>
                          <graphic mimetype="image" mime-subtype="png" xlink:href="images/WandH_1983_temperature_recovery.png"/>
                        </fig>
                      </boxed-text>
                    </p>
                  </td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
          <table-wrap>
            <table>
              <colgroup>
                <col width="100%"/>
              </colgroup>
              <tbody>
                <tr>
                  <td align="left">
                    <p specific-use="wrapper">
                      <boxed-text>
                        <fig id="fig-6c">
                          <caption>
                            <p>(c) Temperature recovery for the Boehnke
                    et al.
                    (<xref alt="2013" rid="ref-boehnke2013zircon" ref-type="bibr">2013</xref>)
                    data set. See legend for panel “a”.</p>
                          </caption>
                          <graphic mimetype="image" mime-subtype="png" xlink:href="images/Boehnke_2013_temperature_recovery.png"/>
                        </fig>
                      </boxed-text>
                    </p>
                  </td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
          <table-wrap>
            <table>
              <colgroup>
                <col width="100%"/>
              </colgroup>
              <tbody>
                <tr>
                  <td align="left">
                    <p specific-use="wrapper">
                      <boxed-text>
                        <fig id="fig-6d">
                          <caption>
                            <p>(d) Temperature predictions for the
                    Gervasoni et al. (2016) data set. Experiments are
                    labeled, indicating Zr concentration. Otherwsie,
                    symbols are plotted as described for panel
                    “a”.</p>
                          </caption>
                          <graphic mimetype="image" mime-subtype="png" xlink:href="images/Gervasoni_et_al.png"/>
                        </fig>
                      </boxed-text>
                    </p>
                  </td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
        </fig>
        <p>Software is available to utilize the model presented here as a
    <ext-link ext-link-type="uri" xlink:href="notebooks/6-Liquid-MELTS-calib-2.ipynb">geothermometer</ext-link>.
    In <xref alt="Figure 6 (a)" rid="fig-6a">Figure 6 (a)</xref> through
    <xref alt="Figure 6 (d)" rid="fig-6d">Figure 6 (d)</xref> we use
    this software to calculate apparent experimental temperatures for
    the calibration data set and for the data set of Gervasoni et al.
    (<xref alt="2016" rid="ref-gervasoni2016zircon" ref-type="bibr">2016</xref>).
    These results provide an alternative measure of how well the model
    recovers the calibration data set, and suggests some potential
    problems with attainment of equilibrium in the data set of
    Gervasoni.</p>
        <p>Temperature estimates for the calibration data set are plotted in
    <xref alt="Figure 6 (a)" rid="fig-6a">Figure 6 (a)</xref> with data
    from E. Bruce Watson and Harrison
    (<xref alt="1983" rid="ref-WATSON1983295" ref-type="bibr">1983</xref>)
    isolated in <xref alt="Figure 6 (b)" rid="fig-6b">Figure 6
    (b)</xref> and selected low-Zr experiments from Boehnke et al.
    (<xref alt="2013" rid="ref-boehnke2013zircon" ref-type="bibr">2013</xref>)
    displayed in <xref alt="Figure 6 (c)" rid="fig-6c">Figure 6
    (c)</xref>. Experimental values with uncertainties are plotted in
    red and temperature estimates with model uncertainties are plotted
    as yellow polygons, with a green dot at the most likely value. The
    inset on each panel shows model temperture estimates with associated
    5% and 95% quartiles, computed using the average analytical Zr
    concentration, plotted against reported experimental temperaure.</p>
        <p>Model temperature estimates scatter about experimental
    temperatures for Zr liquid concentrations below 4000 PPM. Above that
    concentration, the model tends to overestimate temperature. This
    failure is probably related to our model formulation assumption that
    regular solution interaction parameters involving Zr-species are
    zero, implicitely rendering the model applicable to a Henrian
    concentration limit. This assumption could be relaxed in order to
    accomodate these data, but there are so few data points at higher
    Zr-concentrations available for calibration that the danger of
    overfitting does not warrant this extension. Model error in
    temperature estimates due to parameter error propagation is -7.3°C,
    +8.1°C (5%, 95%) for the E. Bruce Watson and Harrison
    (<xref alt="1983" rid="ref-WATSON1983295" ref-type="bibr">1983</xref>)
    data set (<xref alt="Figure 6 (b)" rid="fig-6b">Figure 6
    (b)</xref>), with the average error in recovered experimental
    temperature of -14°C (± 35°C). Including measured uncertainty in Zr
    concentration brings the average recovered temperature within the
    range -34°C (Zr - 2 sigma) to 4°C (Zr + 2 sigma) with the standard
    deviation of the low and high estimates maintained at the same level
    as the average Zr value. For the Boehnke et al.
    (<xref alt="2013" rid="ref-boehnke2013zircon" ref-type="bibr">2013</xref>)
    data set (<xref alt="Figure 6 (c)" rid="fig-6c">Figure 6 (c)</xref>,
    ignoring the 4 data points above 4000 PPM Zr), the recovery of
    temperature estimates due to parameter error propagation is -11.6°C,
    +10.1°C (5%, 95%). The average error in recovered experimental
    temperature is -15°C (± 41°C) with the range -17°C ± 35°C (Zr - 2
    sigma) to -5°C ± 39°C (Zr + 2 sigma).</p>
        <p>Temperature recovery of the data set of Gervasoni et al.
    (<xref alt="2016" rid="ref-gervasoni2016zircon" ref-type="bibr">2016</xref>),
    which was not used in calibration, is shwon in
    <xref alt="Figure 6 (c)" rid="fig-6c">Figure 6 (c)</xref>. Note that
    model temperatures are overestimated for glass compositions with
    &gt; 6000 PPM Zr, as found with the data set of Boehnke et al.
    (<xref alt="2013" rid="ref-boehnke2013zircon" ref-type="bibr">2013</xref>).
    At experimental temperatures of 1200°C at at Zr concentrations &gt;
    2500 PPM and &lt; 6000 PPM, temperature recovery is comparable to
    the calibration data sets. At lower Zr concentrations and at lower
    temperatures, temperature recovery is systematically biased. The
    experimental data set of Gervasoni et al.
    (<xref alt="2016" rid="ref-gervasoni2016zircon" ref-type="bibr">2016</xref>)
    differes from the calibration data sets in showing almost complete
    iron-loss to the experimental capsule. In addition, these
    experiments were conducted under nominally dry conditions (unlike
    the other two studies) and run durations were realtively short (24
    hrs). Considering the absence of volatiles, which would aid reaction
    kinetics, all these factors support our contention that equilibrium
    was not achieved in the lower temperature, lower Zr-content runs. In
    fact, the partial agreement at 1200°C for the subset of
    “intermediate” Zr concentration experiments may simply be
    fortuitous.</p>
      </sec>
    </sec>
    <sec id="model-access">
      <title>Model Access</title>
      <p>The model and dependent calculations presented here can be
  replicated in full utilizing the associated Jupyter notebooks:
  <ext-link ext-link-type="uri" xlink:href="notebooks/1-Model-description.ipynb">Model-description</ext-link>,
  <ext-link ext-link-type="uri" xlink:href="notebooks/2-Endmembers-MELTS.ipynb">Endmembers</ext-link>,<ext-link ext-link-type="uri" xlink:href="notebooks/3-Liquid-MELTS-codegen.ipynb">Solution
  Model</ext-link>,
  <ext-link ext-link-type="uri" xlink:href="notebooks/4-Liquid-MELTS-API-tests.ipynb">Model
  Testing</ext-link>,
  <ext-link ext-link-type="uri" xlink:href="notebooks/5-Liquid-MELTS-calib-1.ipynb">Calibration
  1</ext-link>,
  <ext-link ext-link-type="uri" xlink:href="notebooks/6-Liquid-MELTS-calib-2.ipynb">Calibration
  2</ext-link>, and
  <ext-link ext-link-type="uri" xlink:href="notebooks/7-MELTS-with-Zr.ipynb">MELTS
  with Zr</ext-link>. These notebooks will execute on an
  <ext-link ext-link-type="uri" xlink:href="http://enki-portal.org/index.html">ENKI
  enabled server platform</ext-link> or, more conveniently, within a
  containerized image implementation of the ThermoEngine software
  ecosystem (the ENKI software engine) that may be downloaded from
  GitLab’s Docker image
  <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/ENKI-portal/ThermoEngine">containier
  repository</ext-link>. The container will execute on any computer that
  has a recent version of
  <ext-link ext-link-type="uri" xlink:href="https://www.docker.com">Docker</ext-link>
  installed.</p>
    </sec>
    <sec id="conclusions">
      <title>Conclusions</title>
      <p>This paper updates MELTS (v 1.1) to account for phase relations
  involving the trace element Zr. The saturation surface for zircon is
  calibrated using experimental data from E. Bruce Watson and Harrison
  (<xref alt="1983" rid="ref-WATSON1983295" ref-type="bibr">1983</xref>)
  and Boehnke et al.
  (<xref alt="2013" rid="ref-boehnke2013zircon" ref-type="bibr">2013</xref>).
  The model is formulated and optimized for Zr melt concentrations in
  the effective Henrian limit (&lt; 4000 PPM) and accounts for the
  effect of alkalis on zircon saturation via the adoption of an
  associated solution formulation that incorporates three Zr-bearing
  melt species: ZrSiO4, Na4ZrSi2O8, and K4ZrSi2O8. The model may be used
  (1) to calculate zircon phase relations in magmatic composition melts,
  (2) to construct zircon saturation diagrams for a given liquid bulk
  composition, and (3) as a geothermometer for zircon bearing igneous
  rocks.</p>
    </sec>
    <sec id="aknowledgements">
      <title>Aknowledgements</title>
      <p>MSG is grateful to the extended MESSY group at Vanderbilt
  University for suggesting this problem and for assisting in working
  through model assumptions and calibration data sets. MSG also
  acknowledges material support from NSF 17-25425 and from OFM
  Research.</p>
    </sec>
  </body>
  <back>
    <ref-list>
      <title/>
      <ref id="ref-Putirka_2008">
        <element-citation publication-type="paper-conference">
          <person-group person-group-type="author">
            <name>
              <surname>Putirka</surname>
              <given-names>Keith D.</given-names>
            </name>
          </person-group>
          <article-title>Thermometers and Barometers for Volcanic Systems</article-title>
          <source>MINERALS, INCLUSIONS AND VOLCANIC PROCESSES</source>
          <person-group person-group-type="editor">
            <string-name>Putirka, KD and Tepley, FJ</string-name>
          </person-group>
          <publisher-name>Amer Geophys Union; Mineralog Soc Amer; Dept Energy</publisher-name>
          <year iso-8601-date="2008">2008</year>
          <volume>69</volume>
          <isbn>{978-0-939950-83-6}</isbn>
          <issn>{1529-6466}</issn>
          <pub-id pub-id-type="doi">{10.2138/rmg.2008.69.3}</pub-id>
          <fpage>61</fpage>
          <lpage>120</lpage>
        </element-citation>
      </ref>
      <ref id="ref-WATSON1983295">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name>
              <surname>Watson</surname>
              <given-names>E. Bruce</given-names>
            </name>
            <name>
              <surname>Harrison</surname>
              <given-names>T. Mark</given-names>
            </name>
          </person-group>
          <article-title>Zircon saturation revisited: Temperature and composition effects in a variety of crustal magma types</article-title>
          <source>Earth and Planetary Science Letters</source>
          <year iso-8601-date="1983">1983</year>
          <volume>64</volume>
          <issue>2</issue>
          <issn>0012-821X</issn>
          <uri>http://www.sciencedirect.com/science/article/pii/0012821X8390211X</uri>
          <pub-id pub-id-type="doi">https://doi.org/10.1016/0012-821X(83)90211-X</pub-id>
          <fpage>295 </fpage>
          <lpage> 304</lpage>
        </element-citation>
      </ref>
      <ref id="ref-seabold2010statsmodels">
        <element-citation publication-type="paper-conference">
          <person-group person-group-type="author">
            <name>
              <surname>Seabold</surname>
              <given-names>Skipper</given-names>
            </name>
            <name>
              <surname>Perktold</surname>
              <given-names>Josef</given-names>
            </name>
          </person-group>
          <article-title>Statsmodels: Econometric and statistical modeling with python</article-title>
          <source>9th python in science conference</source>
          <year iso-8601-date="2010">2010</year>
        </element-citation>
      </ref>
      <ref id="ref-2020SciPy-NMeth">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name>
              <surname>Virtanen</surname>
              <given-names>Pauli</given-names>
            </name>
            <name>
              <surname>Gommers</surname>
              <given-names>Ralf</given-names>
            </name>
            <name>
              <surname>Oliphant</surname>
              <given-names>Travis E.</given-names>
            </name>
            <name>
              <surname>Haberland</surname>
              <given-names>Matt</given-names>
            </name>
            <name>
              <surname>Reddy</surname>
              <given-names>Tyler</given-names>
            </name>
            <name>
              <surname>Cournapeau</surname>
              <given-names>David</given-names>
            </name>
            <name>
              <surname>Burovski</surname>
              <given-names>Evgeni</given-names>
            </name>
            <name>
              <surname>Peterson</surname>
              <given-names>Pearu</given-names>
            </name>
            <name>
              <surname>Weckesser</surname>
              <given-names>Warren</given-names>
            </name>
            <name>
              <surname>Bright</surname>
              <given-names>Jonathan</given-names>
            </name>
            <name>
              <surname>van der Walt</surname>
              <given-names>Stéfan J.</given-names>
            </name>
            <name>
              <surname>Brett</surname>
              <given-names>Matthew</given-names>
            </name>
            <name>
              <surname>Wilson</surname>
              <given-names>Joshua</given-names>
            </name>
            <name>
              <surname>Millman</surname>
              <given-names>K. Jarrod</given-names>
            </name>
            <name>
              <surname>Mayorov</surname>
              <given-names>Nikolay</given-names>
            </name>
            <name>
              <surname>Nelson</surname>
              <given-names>Andrew R. J.</given-names>
            </name>
            <name>
              <surname>Jones</surname>
              <given-names>Eric</given-names>
            </name>
            <name>
              <surname>Kern</surname>
              <given-names>Robert</given-names>
            </name>
            <name>
              <surname>Larson</surname>
              <given-names>Eric</given-names>
            </name>
            <name>
              <surname>Carey</surname>
              <given-names>C J</given-names>
            </name>
            <name>
              <surname>Polat</surname>
              <given-names>İlhan</given-names>
            </name>
            <name>
              <surname>Feng</surname>
              <given-names>Yu</given-names>
            </name>
            <name>
              <surname>Moore</surname>
              <given-names>Eric W.</given-names>
            </name>
            <name>
              <surname>VanderPlas</surname>
              <given-names>Jake</given-names>
            </name>
            <name>
              <surname>Laxalde</surname>
              <given-names>Denis</given-names>
            </name>
            <name>
              <surname>Perktold</surname>
              <given-names>Josef</given-names>
            </name>
            <name>
              <surname>Cimrman</surname>
              <given-names>Robert</given-names>
            </name>
            <name>
              <surname>Henriksen</surname>
              <given-names>Ian</given-names>
            </name>
            <name>
              <surname>Quintero</surname>
              <given-names>E. A.</given-names>
            </name>
            <name>
              <surname>Harris</surname>
              <given-names>Charles R.</given-names>
            </name>
            <name>
              <surname>Archibald</surname>
              <given-names>Anne M.</given-names>
            </name>
            <name>
              <surname>Ribeiro</surname>
              <given-names>Antônio H.</given-names>
            </name>
            <name>
              <surname>Pedregosa</surname>
              <given-names>Fabian</given-names>
            </name>
            <name>
              <surname>van Mulbregt</surname>
              <given-names>Paul</given-names>
            </name>
            <string-name>SciPy 1.0 Contributors</string-name>
          </person-group>
          <article-title>SciPy 1.0: Fundamental Algorithms for Scientific Computing in Python</article-title>
          <source>Nature Methods</source>
          <year iso-8601-date="2020">2020</year>
          <volume>17</volume>
          <pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id>
          <fpage>261</fpage>
          <lpage>272</lpage>
        </element-citation>
      </ref>
      <ref id="ref-boehnke2013zircon">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name>
              <surname>Boehnke</surname>
              <given-names>Patrick</given-names>
            </name>
            <name>
              <surname>Watson</surname>
              <given-names>E Bruce</given-names>
            </name>
            <name>
              <surname>Trail</surname>
              <given-names>Dustin</given-names>
            </name>
            <name>
              <surname>Harrison</surname>
              <given-names>T Mark</given-names>
            </name>
            <name>
              <surname>Schmitt</surname>
              <given-names>Axel K</given-names>
            </name>
          </person-group>
          <article-title>Zircon saturation re-revisited</article-title>
          <source>Chemical Geology</source>
          <publisher-name>Elsevier</publisher-name>
          <year iso-8601-date="2013">2013</year>
          <volume>351</volume>
          <fpage>324</fpage>
          <lpage>334</lpage>
        </element-citation>
      </ref>
      <ref id="ref-gervasoni2016zircon">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name>
              <surname>Gervasoni</surname>
              <given-names>Fernanda</given-names>
            </name>
            <name>
              <surname>Klemme</surname>
              <given-names>Stephan</given-names>
            </name>
            <name>
              <surname>Rocha-Júnior</surname>
              <given-names>Eduardo RV</given-names>
            </name>
            <name>
              <surname>Berndt</surname>
              <given-names>Jasper</given-names>
            </name>
          </person-group>
          <article-title>Zircon saturation in silicate melts: A new and improved model for aluminous and alkaline melts</article-title>
          <source>Contributions to Mineralogy and Petrology</source>
          <publisher-name>Springer</publisher-name>
          <year iso-8601-date="2016">2016</year>
          <volume>171</volume>
          <issue>3</issue>
          <fpage>21</fpage>
          <lpage/>
        </element-citation>
      </ref>
      <ref id="ref-robie1995thermodynamic">
        <element-citation publication-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Robie</surname>
              <given-names>Richard A</given-names>
            </name>
            <name>
              <surname>Hemingway</surname>
              <given-names>Bruce S</given-names>
            </name>
          </person-group>
          <source>Thermodynamic properties of minerals and related substances at 298.15 k and 1 bar (105 pascals) pressure and at higher temperatures</source>
          <publisher-name>US Government Printing Office</publisher-name>
          <year iso-8601-date="1995">1995</year>
          <volume>2131</volume>
        </element-citation>
      </ref>
      <ref id="ref-watson1979zircon">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name>
              <surname>Watson</surname>
              <given-names>E Bruce</given-names>
            </name>
          </person-group>
          <article-title>Zircon saturation in felsic liquids: Experimental results and applications to trace element geochemistry</article-title>
          <source>Contributions to Mineralogy and Petrology</source>
          <publisher-name>Springer</publisher-name>
          <year iso-8601-date="1979">1979</year>
          <volume>70</volume>
          <issue>4</issue>
          <fpage>407</fpage>
          <lpage>419</lpage>
        </element-citation>
      </ref>
      <ref id="ref-nicholls1969peralkaline">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name>
              <surname>Nicholls</surname>
              <given-names>Jim</given-names>
            </name>
            <name>
              <surname>Carmichael</surname>
              <given-names>ISE</given-names>
            </name>
          </person-group>
          <article-title>Peralkaline acid liquids: A petrological study</article-title>
          <source>Contributions to mineralogy and petrology</source>
          <publisher-name>Springer</publisher-name>
          <year iso-8601-date="1969">1969</year>
          <volume>20</volume>
          <issue>3</issue>
          <fpage>268</fpage>
          <lpage>294</lpage>
        </element-citation>
      </ref>
      <ref id="ref-carmichael1967mineralogy">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name>
              <surname>Carmichael</surname>
              <given-names>Ian SE</given-names>
            </name>
          </person-group>
          <article-title>The mineralogy and petrology of the volcanic rocks from the leucite hills, wyoming</article-title>
          <source>Contributions to Mineralogy and Petrology</source>
          <publisher-name>Springer</publisher-name>
          <year iso-8601-date="1967">1967</year>
          <volume>15</volume>
          <issue>1</issue>
          <fpage>24</fpage>
          <lpage>66</lpage>
        </element-citation>
      </ref>
      <ref id="ref-linthout1984alkali">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name>
              <surname>Linthout</surname>
              <given-names>K</given-names>
            </name>
          </person-group>
          <article-title>Alkali-zirconosilicates in peralkaline rocks</article-title>
          <source>Contributions to Mineralogy and Petrology</source>
          <publisher-name>Springer</publisher-name>
          <year iso-8601-date="1984">1984</year>
          <volume>86</volume>
          <issue>2</issue>
          <fpage>155</fpage>
          <lpage>158</lpage>
        </element-citation>
      </ref>
      <ref id="ref-carmichael1974igneous">
        <element-citation publication-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Carmichael</surname>
              <given-names>Ian SE</given-names>
            </name>
            <name>
              <surname>Turner</surname>
              <given-names>Francis J</given-names>
            </name>
            <name>
              <surname>Verhoogen</surname>
              <given-names>John</given-names>
            </name>
          </person-group>
          <source>Igneous petrology</source>
          <publisher-name>New York, McGraw-Hill</publisher-name>
          <year iso-8601-date="1974">1974</year>
        </element-citation>
      </ref>
      <ref id="ref-lowenstern1991new">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name>
              <surname>Lowenstern</surname>
              <given-names>Jacob B</given-names>
            </name>
            <name>
              <surname>Mahood</surname>
              <given-names>Gail A</given-names>
            </name>
          </person-group>
          <article-title>New data on magmatic h 2 o contents of pantellerites, with implications for petrogenesis and eruptive dynamics at pantelleria</article-title>
          <source>Bulletin of Volcanology</source>
          <publisher-name>Springer</publisher-name>
          <year iso-8601-date="1991">1991</year>
          <volume>54</volume>
          <issue>1</issue>
          <fpage>78</fpage>
          <lpage>83</lpage>
        </element-citation>
      </ref>
      <ref id="ref-ghiorso1995chemical">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name>
              <surname>Ghiorso</surname>
              <given-names>Mark S</given-names>
            </name>
            <name>
              <surname>Sack</surname>
              <given-names>Richard O</given-names>
            </name>
          </person-group>
          <article-title>Chemical mass transfer in magmatic processes IV. A revised and internally consistent thermodynamic model for the interpolation and extrapolation of liquid-solid equilibria in magmatic systems at elevated temperatures and pressures</article-title>
          <source>Contributions to Mineralogy and Petrology</source>
          <publisher-name>Springer</publisher-name>
          <year iso-8601-date="1995">1995</year>
          <volume>119</volume>
          <issue>2-3</issue>
          <fpage>197</fpage>
          <lpage>212</lpage>
        </element-citation>
      </ref>
      <ref id="ref-gualda2012rhyolite">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name>
              <surname>Gualda</surname>
              <given-names>Guilherme AR</given-names>
            </name>
            <name>
              <surname>Ghiorso</surname>
              <given-names>Mark S</given-names>
            </name>
            <name>
              <surname>Lemons</surname>
              <given-names>Robin V</given-names>
            </name>
            <name>
              <surname>Carley</surname>
              <given-names>Tamara L</given-names>
            </name>
          </person-group>
          <article-title>Rhyolite-MELTS: A modified calibration of MELTS optimized for silica-rich, fluid-bearing magmatic systems</article-title>
          <source>Journal of Petrology</source>
          <publisher-name>Oxford University Press</publisher-name>
          <year iso-8601-date="2012">2012</year>
          <volume>53</volume>
          <issue>5</issue>
          <fpage>875</fpage>
          <lpage>890</lpage>
        </element-citation>
      </ref>
      <ref id="ref-ghiorso1983gibbs">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name>
              <surname>Ghiorso</surname>
              <given-names>Mark S</given-names>
            </name>
            <name>
              <surname>Carmichael</surname>
              <given-names>Ian SE</given-names>
            </name>
            <name>
              <surname>Rivers</surname>
              <given-names>Mark L</given-names>
            </name>
            <name>
              <surname>Sack</surname>
              <given-names>Richard O</given-names>
            </name>
          </person-group>
          <article-title>The gibbs free energy of mixing of natural silicate liquids; an expanded regular solution approximation for the calculation of magmatic intensive variables</article-title>
          <source>Contributions to Mineralogy and Petrology</source>
          <publisher-name>Springer</publisher-name>
          <year iso-8601-date="1983">1983</year>
          <volume>84</volume>
          <issue>2-3</issue>
          <fpage>107</fpage>
          <lpage>145</lpage>
        </element-citation>
      </ref>
      <ref id="ref-ghiorso2015h">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name>
              <surname>Ghiorso</surname>
              <given-names>Mark S</given-names>
            </name>
            <name>
              <surname>Gualda</surname>
              <given-names>Guilherme AR</given-names>
            </name>
          </person-group>
          <article-title>An H2O–CO2 mixed fluid saturation model compatible with rhyolite-MELTS</article-title>
          <source>Contributions to Mineralogy and Petrology</source>
          <publisher-name>Springer</publisher-name>
          <year iso-8601-date="2015">2015</year>
          <volume>169</volume>
          <issue>6</issue>
          <fpage>53</fpage>
          <lpage/>
        </element-citation>
      </ref>
    </ref-list>
  </back>
  <sub-article article-type="notebook" id="nb-3-nb-1">
    <front-stub>
      <title-group>
        <article-title>4-Tests: MELTS liquid model with ZrSiO4</article-title>
      </title-group>
    </front-stub>
    <body>
      <sec id="cell-0-nb-1" specific-use="notebook-content">
        <sec id="tests-melts-liquid-model-with-zrsio4-nb-1">
          <title>4-Tests: MELTS liquid model with ZrSiO4</title>
          <p>
            <bold>API tests.</bold>
            <bold>Run Endmembers-MELTS and Liquid-MELTS-codegen notebooks
  first!</bold>
          </p>
          <p>Proposed associated solution model:</p>
          <table-wrap>
            <table>
              <colgroup>
                <col width="19%"/>
                <col width="14%"/>
                <col width="16%"/>
                <col width="16%"/>
                <col width="18%"/>
                <col width="18%"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="left">Components:</th>
                  <th align="left">Species:</th>
                  <th align="left">Reaction:</th>
                  <th align="left">Variable:</th>
                  <th align="left">Component:</th>
                  <th align="left">Species X:</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left">SiO2</td>
                  <td align="left">SiO2</td>
                  <td align="left"/>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_1]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_1]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">TiO2</td>
                  <td align="left">TiO2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_1]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_2]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_2]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Al2O3</td>
                  <td align="left">Al2O3</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_2]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_3]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>3</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_3]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>3</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Fe2O3</td>
                  <td align="left">Fe2O3</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_3]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>3</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_4]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>4</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_4]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>4</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">MgCr2O4</td>
                  <td align="left">MgCr2O4</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_4]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>4</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_5]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>5</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_5]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>5</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Fe2SiO4</td>
                  <td align="left">Fe2SiO4</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_5]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>5</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_6]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>6</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_6]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>6</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">MnSi1/2O2</td>
                  <td align="left">MnSi1/2O2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_6]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>6</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_7]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>7</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_7]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>7</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Mg2SiO4</td>
                  <td align="left">Mg2SiO4</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_7]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>7</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_8]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>8</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_8]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>8</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">NiSi1/2O2</td>
                  <td align="left">NiSi1/2O2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_8]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>8</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_9]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>9</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_9]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>9</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">CoSi1/2O2</td>
                  <td align="left">CoSi1/2O2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_9]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>9</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{10}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>10</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{10}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>10</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">CaSiO3</td>
                  <td align="left">CaSiO3</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{10}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>10</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{11}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>11</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{11}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>11</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Na2SiO3</td>
                  <td align="left">Na2SiO3</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{11}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>11</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{12}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>12</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{12}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>12</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">KAlSiO4</td>
                  <td align="left">KAlSiO4</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{12}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>12</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{13}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>13</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{13}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>13</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Ca3(PO4)2</td>
                  <td align="left">Ca3(PO4)2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{13}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>13</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{14}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>14</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{14}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>14</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">H2O</td>
                  <td align="left">H2O</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{14}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>14</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{15}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>15</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{15}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>15</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">CO2</td>
                  <td align="left">CO2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{15}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>15</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{16}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>16</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{16}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>16</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">ZrSiO4</td>
                  <td align="left">ZrSiO4</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{16}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>16</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{17}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>17</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{17}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>17</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left"/>
                  <td align="left">CaCO3</td>
                  <td align="left">CO2 + CaSiO3 = CaCO3 + SiO2</td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[s_1]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>s</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{18}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>18</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left"/>
                  <td align="left">Na4ZrSi2O8</td>
                  <td align="left">ZrSiO4 + 2Na2SiO3 = Na4ZrSi2O8 + SiO2</td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[s_2]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>s</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{19}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>19</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left"/>
                  <td align="left">K4ZrSi2O8</td>
                  <td align="left">ZrSiO4 + 4KAlSiO4 = K4ZrSi2O8 + 2Al2O3 +
          3SiO2</td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[s_3]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>s</mml:mi>
                            <mml:mn>3</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{20}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>20</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
        </sec>
        <sec id="cell-1-nb-1" specific-use="notebook-code">
          <code language="python">import pandas as pd
import numpy as np
from thermoengine import core
from thermoengine.model import Database
db = Database()
import warnings
warnings.filterwarnings("ignore", category=DeprecationWarning)
warnings.filterwarnings("ignore", category=FutureWarning)</code>
        </sec>
        <sec id="cell-2-nb-1" specific-use="notebook-content">
          <list list-type="bullet">
            <list-item>
              <p>Number of components = 17</p>
            </list-item>
            <list-item>
              <p>Number of species = 24</p>
            </list-item>
            <list-item>
              <p>Number of “ordering parameters” (i.e., dependent species) =
      7</p>
            </list-item>
          </list>
        </sec>
        <sec id="cell-3-nb-1" specific-use="notebook-code">
          <code language="python">nc = 17
nw = 20
ns = 3</code>
        </sec>
        <sec id="cell-4-nb-1" specific-use="notebook-code">
          <code language="python">model_working_dir = "working"
%cd {model_working_dir}
from pyximport import install
install()
import rMELTS_ZR
%cd ..</code>
        </sec>
        <sec id="cell-5-nb-1" specific-use="notebook-content">
          <sec id="test-t-in-k-p-in-bars-nb-1">
            <title>Test (T in K, P in bars)</title>
          </sec>
          <sec id="cell-6-nb-1" specific-use="notebook-code">
            <code language="python">t = 1000.00
p = 1000.0</code>
          </sec>
          <sec id="cell-7-nb-1" specific-use="notebook-content">
            <p>Test identifier routines</p>
          </sec>
          <sec id="cell-8-nb-1" specific-use="notebook-code">
            <code language="python">print(rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_identifier())
print(rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_name())</code>
          </sec>
          <sec id="cell-9-nb-1" specific-use="notebook-content">
  </sec>
          <sec id="adjust-parameters-to-initial-estimates-nb-1">
            <title>Adjust parameters to initial estimates</title>
          </sec>
          <sec id="cell-10-nb-1" specific-use="notebook-code">
            <code language="python">mu0_SiO2 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_mu0(0, t, p)
mu0_Al2O3 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_mu0(2, t, p)
mu0_Fe2O3 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_mu0(3, t, p)
mu0_Fe2SiO4 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_mu0(5, t, p)
mu0_CaSiO3 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_mu0(10, t, p)
mu0_Na2SiO3 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_mu0(11, t, p)
mu0_KAlSiO4 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_mu0(12, t, p)
mu0_CO2 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_mu0(15, t, p)
mu0_ZrSiO4 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_mu0(16, t, p)
#
mu0dT_SiO2 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dT(0, t, p)
mu0dT_Al2O3 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dT(2, t, p)
mu0dT_Fe2O3 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dT(3, t, p)
mu0dT_Fe2SiO4 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dT(5, t, p)
mu0dT_CaSiO3 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dT(10, t, p)
mu0dT_Na2SiO3 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dT(11, t, p)
mu0dT_KAlSiO4 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dT(12, t, p)
mu0dT_CO2 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dT(15, t, p)
mu0dT_ZrSiO4 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dT(16, t, p)
#
mu0dP_SiO2 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dP(0, t, p)
mu0dP_Al2O3 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dP(2, t, p)
mu0dP_Fe2O3 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dP(3, t, p)
mu0dP_Fe2SiO4 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dP(5, t, p)
mu0dP_CaSiO3 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dP(10, t, p)
mu0dP_Na2SiO3 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dP(11, t, p)
mu0dP_KAlSiO4 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dP(12, t, p)
mu0dP_CO2 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dP(15, t, p)
mu0dP_ZrSiO4 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dP(16, t, p)</code>
          </sec>
          <sec id="cell-11-nb-1" specific-use="notebook-content">
            <p>Compute properties of CaCO3: - CaCO3 calibration adjustments are
    from Ghiorso and Gualda (2015)</p>
            <preformat>known_depen_species_values = [
    -1.7574497522747e+01*1000.0, 0.0, -1.9034060173857e+00, # H, S, V, CaCO3
]</preformat>
          </sec>
          <sec id="cell-12-nb-1" specific-use="notebook-code">
            <code language="python">h_delta_calib_CaCO3 = -1.7574497522747e+01*1000.0
s_delta_calib_CaCO3 = 0.0
v_delta_calib_CaCO3 = -1.9034060173857e+00
mu0_CaCO3   = mu0_CO2 + mu0_CaSiO3 - mu0_SiO2
mu0dT_CaCO3 = mu0dT_CO2 + mu0dT_CaSiO3 - mu0dT_SiO2
mu0dP_CaCO3 = mu0dP_CO2 + mu0dP_CaSiO3 - mu0dP_SiO2
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(2, mu0_CaCO3 - t*mu0dT_CaCO3 + h_delta_calib_CaCO3) 
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(3, -mu0dT_CaCO3 + s_delta_calib_CaCO3) 
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(4,  mu0dP_CaCO3 + v_delta_calib_CaCO3)
mu0_CaCO3 + h_delta_calib_CaCO3, mu0_CaCO3 - t*mu0dT_CaCO3 + h_delta_calib_CaCO3, -mu0dT_CaCO3 + s_delta_calib_CaCO3, mu0dP_CaCO3 + v_delta_calib_CaCO3</code>
          </sec>
          <sec id="cell-13-nb-1" specific-use="notebook-content">
            <p>Properties of the zirconium species are estimated by choosing a
    value for h, s, and v that zeros the delta difference of the
    exchange reaction</p>
          </sec>
          <sec id="cell-14-nb-1" specific-use="notebook-content">
            <p>Na4ZrSi2O8</p>
          </sec>
          <sec id="cell-15-nb-1" specific-use="notebook-code">
            <code language="python">mu0_Na4ZrSi2O8   = mu0_ZrSiO4   + 2.0*mu0_Na2SiO3   - mu0_SiO2
mu0dT_Na4ZrSi2O8 = mu0dT_ZrSiO4 + 2.0*mu0dT_Na2SiO3 - mu0dT_SiO2
mu0dP_Na4ZrSi2O8 = mu0dP_ZrSiO4 + 2.0*mu0dP_Na2SiO3 - mu0dP_SiO2
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(5, mu0_Na4ZrSi2O8 - t*mu0dT_Na4ZrSi2O8 - (p-1.0)*mu0dP_Na4ZrSi2O8)
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(6, -mu0dT_Na4ZrSi2O8)
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(7, mu0dP_Na4ZrSi2O8)
mu0_Na4ZrSi2O8, mu0_Na4ZrSi2O8 - t*mu0dT_Na4ZrSi2O8 - (p-1.0)*mu0dP_Na4ZrSi2O8, -mu0dT_Na4ZrSi2O8, mu0dP_Na4ZrSi2O8</code>
          </sec>
          <sec id="cell-16-nb-1" specific-use="notebook-code">
            <code language="python">mu0_K4ZrSi2O8   = mu0_ZrSiO4   + 4.0*mu0_KAlSiO4   - 3.0*mu0_SiO2   - 2.0*mu0_Al2O3
mu0dT_K4ZrSi2O8 = mu0dT_ZrSiO4 + 4.0*mu0dT_KAlSiO4 - 3.0*mu0dT_SiO2 - 2.0*mu0dT_Al2O3
mu0dP_K4ZrSi2O8 = mu0dP_ZrSiO4 + 4.0*mu0dP_KAlSiO4 - 3.0*mu0dP_SiO2 - 2.0*mu0dP_Al2O3
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(8, mu0_K4ZrSi2O8 - t*mu0dT_K4ZrSi2O8 - (p-1.0)*mu0dP_K4ZrSi2O8)
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(9, -mu0dT_K4ZrSi2O8)
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(10, mu0dP_K4ZrSi2O8)
mu0_K4ZrSi2O8, mu0_K4ZrSi2O8 - t*mu0dT_K4ZrSi2O8 - (p-1.0)*mu0dP_K4ZrSi2O8, -mu0dT_K4ZrSi2O8, mu0dP_K4ZrSi2O8</code>
          </sec>
          <sec id="cell-17-nb-1" specific-use="notebook-code">
            <code language="python">rMELTS_ZR.cy_Liquid_rMELTS_ZR_get_param_values()</code>
          </sec>
          <sec id="cell-18-nb-1" specific-use="notebook-content">
  </sec>
          <sec id="input-composition-and-retrieve-the-ordering-parameter-nb-1">
            <title>Input composition and retrieve the ordering parameter</title>
          </sec>
          <sec id="cell-19-nb-1" specific-use="notebook-code">
            <code language="python">wtZrSiO4 = 183.31*0.001 # weight of ZrSiO4 equal to 0.001 moles of Zr</code>
          </sec>
          <sec id="cell-20-nb-1" specific-use="notebook-code">
            <code language="python">elm_sys = ['H','O','Na','Mg','Al','Si','P','K','Ca','Ti','Cr','Mn','Fe','Co','Ni']
grm_oxides = {
    'SiO2':  77.5, 
    'TiO2':   0.08, 
    'Al2O3': 12.5, 
    'Fe2O3':  0.207,
    'Cr2O3':  0.0, 
    'FeO':    0.473, 
    'MnO':    0.0,
    'MgO':    0.03, 
    'NiO':    0.0, 
    'CoO':    0.0,
    'CaO':    0.43, 
    'Na2O':   3.98, 
    'K2O':    4.88, 
    'P2O5':   0.0, 
    'H2O':    5.5,
    'CO2':    0.05
}
tot_grm_oxides = 0.0
for key in grm_oxides.keys():
    tot_grm_oxides += grm_oxides[key]
mol_oxides = core.chem.format_mol_oxide_comp(grm_oxides, convert_grams_to_moles=True)
mol_elm = core.chem.mol_oxide_to_elem(mol_oxides)
elm = np.zeros(107)
for i,sym in enumerate(
    ['Si', 'Ti', 'Al', 'Fe', 'Cr', 'Mn', 'Mg', 'Ni', 'Co', 'Ca', 'Na', 'K', 'P', 'H', 'C', 'O']):
    index = core.chem.PERIODIC_ORDER.tolist().index(sym)
    elm[index] = mol_elm[i]
elm[core.chem.PERIODIC_ORDER.tolist().index('Zr')] += wtZrSiO4/183.31
elm[core.chem.PERIODIC_ORDER.tolist().index('Si')] += wtZrSiO4/183.31
elm[core.chem.PERIODIC_ORDER.tolist().index('O')]  += wtZrSiO4*4.0/183.31
n = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_conv_elm_to_moles(elm)
for i,x in enumerate(n):
    print ("{0:&lt;12.12s} {1:10.6f} {2:10.6f}".format(rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_name(i), x, mol_oxides[i] if i&lt;16 else 0))
if not rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_test_moles(n):
    print ('Output of intrinsic composition calculation fails tests for permissible values.')</code>
          </sec>
          <sec id="cell-21-nb-1" specific-use="notebook-code">
            <code language="python">def print_species(n, s):
    fmt = '{0:&gt;10s} {1:13.6g}'
    print (fmt.format('      SiO2', n[0]+s[0]+s[1]+3*s[2]))
    print (fmt.format('      TiO2', n[1]))
    print (fmt.format('     Al2O3', n[2]+2*s[2]))
    print (fmt.format('     Fe2O3', n[3]))
    print (fmt.format('     Cr2O3', n[4]))
    print (fmt.format('   Fe2SiO4', n[5]))
    print (fmt.format(' MnSi1/2O2', n[6]))
    print (fmt.format('   Mg2SiO4', n[7]))
    print (fmt.format(' NiSi1/2O2', n[8]))
    print (fmt.format(' CoSi1/2O2', n[9]))
    print (fmt.format('    CaSiO3', n[10]-s[0]))
    print (fmt.format('   Na2SiO3', n[11]-2*s[1]))
    print (fmt.format('   KAlSiO4', n[12]-4*s[2]))
    print (fmt.format(' Ca3(PO4)2', n[13]))
    print (fmt.format('       H2O', n[14]))
    print (fmt.format('       CO2', n[15]-s[0]))
    print (fmt.format('    ZrSiO4', n[16]-s[1]-s[2]))
    print (fmt.format('     CaCO3', s[0]))
    print (fmt.format('Na4ZrSi2O8', s[1]))
    print (fmt.format(' K4ZrSi2O8', s[2]))</code>
          </sec>
          <sec id="cell-22-nb-1" specific-use="notebook-content">
            <p>Speciation results</p>
          </sec>
          <sec id="cell-23-nb-1" specific-use="notebook-code">
            <code language="python">s = rMELTS_ZR.cy_Liquid_rMELTS_ZR_order_params(t, p, n)
print_species(n, s)</code>
          </sec>
          <sec id="cell-24-nb-1" specific-use="notebook-content">
  </sec>
          <sec id="test-calls-to-api-nb-1">
            <title>Test calls to API</title>
            <p>Test some composition retrieval functions</p>
          </sec>
          <sec id="cell-25-nb-1" specific-use="notebook-code">
            <code language="python">e = np.zeros(106)
sum = np.sum(n)
for index in range(0,nc):
    end = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_elements(index)
    for i in range(0,106):
        e[i] += end[i]*n[index]/sum
nConv = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_conv_elm_to_moles(e)
for i in range(0,nc):
    print ('X[{0:2d}] input {1:13.6e}, calc {2:13.6e}, diff {3:13.6e}'.format(
        i, n[i]/sum, nConv[i], nConv[i]-n[i]/sum))
if not rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_test_moles(nConv):
    print ('Output of intrinsic composition calculation fails tests for permissible values.')</code>
          </sec>
          <sec id="cell-26-nb-1" specific-use="notebook-content">
            <p>Test various conversion routines …</p>
          </sec>
          <sec id="cell-27-nb-1" specific-use="notebook-code">
            <code language="python">print (rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_conv_moles_to_tot_moles(n))
print (rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_conv_moles_to_mole_frac(n))
e = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_conv_moles_to_elm(n)
print (e)
print (rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_conv_elm_to_moles(e))
print (rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_conv_elm_to_tot_moles(e))
print (rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_conv_elm_to_tot_grams(e))</code>
          </sec>
          <sec id="cell-28-nb-1" specific-use="notebook-content">
            <sec id="execute-the-standard-thermodynamic-property-retrieval-functions-nb-1">
              <title>Execute the standard thermodynamic property retrieval
      functions:</title>
            </sec>
            <sec id="cell-29-nb-1" specific-use="notebook-code">
              <code language="python">fmt = "{0:&lt;10.10s} {1:13.6e} {2:&lt;10.10s}"
print(fmt.format('G', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_g(t,p,n), 'J'))
print(fmt.format('dGdT', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_dgdt(t,p,n), 'J/K'))
print(fmt.format('dGdP', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_dgdp(t,p,n), 'J/bar'))
print(fmt.format('d2GdT2', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d2gdt2(t,p,n), 'J/K^2'))
print(fmt.format('d2GdTdP', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d2gdtdp(t,p,n), 'J/K-bar'))
print(fmt.format('d2GdP2', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d2gdp2(t,p,n), 'J/bar^2'))
print(fmt.format('d3GdT3', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d3gdt3(t,p,n), 'J/K^3'))
print(fmt.format('d3GdT2dP', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d3gdt2dp(t,p,n), 'J/K^2-bar'))
print(fmt.format('d3GdTdP2', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d3gdtdp2(t,p,n), 'J/K-bar^2'))
print(fmt.format('d3GdP3', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d3gdp3(t,p,n), 'J/bar^3'))
print(fmt.format('S', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_s(t,p,n), 'J/K'))
print(fmt.format('V', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_v(t,p,n), 'J/bar'))
print(fmt.format('Cv', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_cv(t,p,n), 'J/K'))
print(fmt.format('Cp', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_cp(t,p,n), 'J/K'))
print(fmt.format('dCpdT', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_dcpdt(t,p,n), 'J/K^2'))
print(fmt.format('alpha', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_alpha(t,p,n), '1/K'))
print(fmt.format('beta', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_beta(t,p,n), '1/bar'))
print(fmt.format('K', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_K(t,p,n), 'bar'))
print(fmt.format('Kp', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_Kp(t,p,n), ''))</code>
            </sec>
            <sec id="cell-30-nb-1" specific-use="notebook-content">
    </sec>
            <sec id="execute-functions-that-access-endmember-properties-nb-1">
              <title>Execute functions that access endmember properties:</title>
            </sec>
            <sec id="cell-31-nb-1" specific-use="notebook-code">
              <code language="python">fmt = "{0:&lt;10.10s} {1:13.6e} {2:&lt;15.15s}"
print ("number of components", rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_number())
for index in range(0, nc):
    print ("{0:&lt;20.20s}".format(rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_name(index)), end=' ')
    print ("{0:&lt;20.20s}".format(rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_formula(index)), end=' ')
    print ("mw: {0:10.2f}".format(rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_mw(index)))
    print (fmt.format('mu0', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_mu0(index,t,p), 'J/mol'))
    print (fmt.format('dmu0dT', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dT(index,t,p), 'J/K-mol'))
    print (fmt.format('dmu0dP', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dP(index,t,p), 'J/bar-mol'))
    print (fmt.format('d2mu0dT2', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_d2mu0dT2(index,t,p), 'J/K^2-mol'))
    print (fmt.format('d2mu0dTdP', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_d2mu0dTdP(index,t,p), 'J/K-bar-mol'))
    print (fmt.format('d2mu0dP2', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_d2mu0dP2(index,t,p), 'J/bar^2-mol'))
    print (fmt.format('d3mu0dT3', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_d3mu0dT3(index,t,p), 'J/K^3-mol'))
    print (fmt.format('d3mu0dT2dP', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_d3mu0dT2dP(index,t,p), 'J/K^2-bar-mol'))
    print (fmt.format('d3mu0dTdP2', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_d3mu0dTdP2(index,t,p), 'J/K-bar^2-mol'))
    print (fmt.format('d3mu0dP3', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_d3mu0dP3(index,t,p), 'J/bar^3-mol'))
    print ("Element array:")
    print (rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_elements(index))
    print ()</code>
            </sec>
            <sec id="cell-32-nb-1" specific-use="notebook-content">
    </sec>
            <sec id="execute-functions-that-access-species-properties-nb-1">
              <title>Execute functions that access species properties:</title>
            </sec>
            <sec id="cell-33-nb-1" specific-use="notebook-code">
              <code language="python">fmt = "{0:&lt;10.10s} {1:13.6e} {2:&lt;15.15s}"
print ("number of species", rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_species_number())
for index in range(0, nc):
    print ("{0:&lt;20.20s}".format(rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_species_name(index)), end=' ')
    print ("{0:&lt;20.20s}".format(rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_species_formula(index)), end=' ')
    print ("mw: {0:10.2f}".format(rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_species_mw(index)))
    print ("Element array:")
    print (rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_species_elements(index))
    print ()</code>
            </sec>
            <sec id="cell-34-nb-1" specific-use="notebook-content">
    </sec>
            <sec id="execute-functions-for-molar-derivatives-nb-1">
              <title>Execute functions for molar derivatives</title>
              <sec id="first-derivative-vectors-nb-1">
                <title>First derivative vectors:</title>
              </sec>
              <sec id="cell-35-nb-1" specific-use="notebook-code">
                <code language="python">def printResult(name, result, units):
    print ("{0:&lt;10.10s}".format(name), end=' ')
    [print ("{0:13.6e}".format(x), end=' ') for x in result]
    print ("{0:&lt;10.10s}".format(units))
def printLabels(n):
    print ("{0:&lt;18.18s}".format(''), end=' ')
    [print ("[{0:3d}]{1:&lt;8.8s}".format(idx, ''), end=' ') for idx in range(len(n))]
    print ()
printLabels(n)
printResult('dGdn', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_dgdn(t,p,n), 'J/m')
printResult('d2GdndT', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d2gdndt(t,p,n), 'J/K-m')
printResult('d2GdndP', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d2gdndp(t,p,n), 'J/bar-m')
printResult('d3GdndT2', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d3gdndt2(t,p,n), 'J/K^2-m')
printResult('d3GdndTdP', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d3gdndtdp(t,p,n), 'J/K-bar-m')
printResult('d3GdndP2', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d3gdndp2(t,p,n), 'J/bar^2-m')
printResult('d4GdndT3', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d4gdndt3(t,p,n), 'J/K^3-m')
printResult('d4GdndT2dP', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d4gdndt2dp(t,p,n), 'J/K^2-bar-m')
printResult('d4GdndTdP2', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d4gdndtdp2(t,p,n), 'J/K-bar^2-m')
printResult('d4GdndP3', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d4gdndp3(t,p,n), 'J/bar^3-m')</code>
              </sec>
              <sec id="cell-36-nb-1" specific-use="notebook-content">
      </sec>
              <sec id="the-hessian-matrix-molar-second-derivative-matrix-is-stored-as-a-compact-linear-array-nb-1">
                <title>The Hessian matrix (molar second derivative matrix) is
        stored as a compact linear array</title>
                <p>A function is provided to map matrix indices to compact
        storage 1-D array indices</p>
              </sec>
              <sec id="cell-37-nb-1" specific-use="notebook-code">
                <code language="python">def printResult(name, result, units):
    print ("{0:&lt;10.10s}".format(name), end=' ')
    [print ("{0:13.6e}".format(x), end=' ') for x in result]
    print ("{0:&lt;10.10s}".format(units))
def printLabels(n):
    print ("{0:&lt;18.18s}".format(''), end=' ')
    maxIdx = int(len(n)*(len(n)-1)/2 + len(n))
    [print ("[{0:3d}]{1:&lt;8.8s}".format(idx, ''), end=' ') for idx in range(maxIdx)]
    print ()
printLabels(n)
printResult('d2Gdn2', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d2gdn2(t,p,n), 'J/m^2')
printResult('d3Gdn2dT', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d3gdn2dt(t,p,n), 'J/K-m^2')
printResult('d3Gdn2dP', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d3gdn2dp(t,p,n), 'J/bar-m^2')
printResult('d4Gdn2dT2', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d4gdn2dt2(t,p,n), 'J/K^2-m^2')
printResult('d4Gdn2dTdP', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d4gdn2dtdp(t,p,n), 'J/K-bar-m^2')
printResult('d4Gdn2dP2', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d4gdn2dp2(t,p,n), 'J/bar^2-m^2')
printResult('d5Gdn2dT3', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d5gdn2dt3(t,p,n), 'J/K^3-m^2')
printResult('d5Gdn2dT2dP', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d5gdn2dt2dp(t,p,n), 'J/K^2-bar-m^2')
printResult('d5Gdn2dTdP2', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d5gdn2dtdp2(t,p,n), 'J/K-bar^2-m^2')
printResult('d5Gdn2dP3', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d5gdn2dp3(t,p,n), 'J/bar^3-m^2')</code>
              </sec>
              <sec id="cell-38-nb-1" specific-use="notebook-content">
      </sec>
              <sec id="the-3-d-tensor-molar-third-derivative-tensor-is-stored-as-a-compact-linear-array-nb-1">
                <title>The 3-D Tensor (molar third derivative tensor) is stored
        as a compact linear array</title>
                <p>A function is provided to map matrix indices to compact
        storage 1-D array indices:
        If <inline-formula><alternatives><tex-math><![CDATA[n_c]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
        represents the number of components in the solution, and
        if <inline-formula><alternatives><tex-math><![CDATA[n_d]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
        represents the dimensionality of molar derivative (in this case
        3), then
        the number of numerically ordered permutations of
        <inline-formula><alternatives><tex-math><![CDATA[n_c]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
        molar derivatives taken <inline-formula><alternatives><tex-math><![CDATA[n_d]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
        at a time is:</p>
              </sec>
              <sec id="cell-39-nb-1" specific-use="notebook-code">
                <code language="python">def printResult(name, result, units):
    print ("{0:&lt;10.10s}".format(name), end=' ')
    [print ("{0:10.3e}".format(x), end=' ') for x in result]
    print ("{0:&lt;14.14s}".format(units))
def printLabels(n):
    print ("{0:&lt;15.15s}".format(''), end=' ')
    maxIdx = int(len(n)*(len(n)+1)*(len(n)+2)/6)
    [print ("[{0:3d}]{1:&lt;5.5s}".format(idx, ''), end=' ') for idx in range(maxIdx)]
    print ()
printLabels(n)
printResult('d3Gdn3', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d3gdn3(t,p,n), 'J/m^3')
printResult('d4Gdn3dT', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d4gdn3dt(t,p,n), 'J/K-m^3')
printResult('d4Gdn3dP', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d4gdn3dp(t,p,n), 'J/bar-m^3')
printResult('d5Gdn3dT2', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d5gdn3dt2(t,p,n), 'J/K^2-m^3')
printResult('d5Gdn3dTdP', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d5gdn3dtdp(t,p,n), 'J/K-bar-m^3')
printResult('d5Gdn3dP2', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d5gdn3dp2(t,p,n), 'J/bar^2-m^3')
printResult('d6Gdn3dT3', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d6gdn3dt3(t,p,n), 'J/K^3-m^3')
printResult('d6Gdn3dT2dP', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d6gdn3dt2dp(t,p,n), 'J/K^2-bar-m^3')
printResult('d6Gdn3dTdP2', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d6gdn3dtdp2(t,p,n), 'J/K-bar^2-m^3')
printResult('d6Gdn3dP3', rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_d6gdn3dp3(t,p,n), 'J/bar^3-m^3')</code>
              </sec>
              <sec id="cell-40-nb-1" specific-use="notebook-code">
                <code language="python">nparam = 0</code>
              </sec>
              <sec id="cell-41-nb-1" specific-use="notebook-code">
                <code language="python">nparam = rMELTS_ZR.cy_Liquid_rMELTS_ZR_get_param_number()
names = rMELTS_ZR.cy_Liquid_rMELTS_ZR_get_param_names()
units = rMELTS_ZR.cy_Liquid_rMELTS_ZR_get_param_units()
values = rMELTS_ZR.cy_Liquid_rMELTS_ZR_get_param_values()
fmt = "{0:&lt;10.10s} {1:13.6e} {2:13.6e} {3:&lt;10.10s}"
for i in range(0,nparam):
    print(fmt.format(names[i], values[i], rMELTS_ZR.cy_Liquid_rMELTS_ZR_get_param_value(i), units[i]))</code>
              </sec>
              <sec id="cell-42-nb-1" specific-use="notebook-content">
      </sec>
            </sec>
            <sec id="functions-that-evaluate-parameter-derivatives-nb-1">
              <title>Functions that evaluate parameter derivatives …</title>
            </sec>
            <sec id="cell-43-nb-1" specific-use="notebook-code">
              <code language="python">fmt = "    {0:&lt;10.10s} {1:13.6e}"
for i in range(0, nparam):
    print ('Derivative with respect to parameter: ', names[i], ' of')
    print (fmt.format('G', rMELTS_ZR.cy_Liquid_rMELTS_ZR_dparam_g(t, p, n, i)))
    print (fmt.format('dGdT', rMELTS_ZR.cy_Liquid_rMELTS_ZR_dparam_dgdt(t, p, n, i)))
    print (fmt.format('dGdP', rMELTS_ZR.cy_Liquid_rMELTS_ZR_dparam_dgdp(t, p, n, i)))
    print (fmt.format('d2GdT2', rMELTS_ZR.cy_Liquid_rMELTS_ZR_dparam_d2gdt2(t, p, n, i)))
    print (fmt.format('d2GdTdP', rMELTS_ZR.cy_Liquid_rMELTS_ZR_dparam_d2gdtdp(t, p, n, i)))
    print (fmt.format('d2GdP2', rMELTS_ZR.cy_Liquid_rMELTS_ZR_dparam_d2gdp2(t, p, n, i)))
    print (fmt.format('d3GdT3', rMELTS_ZR.cy_Liquid_rMELTS_ZR_dparam_d3gdt3(t, p, n, i)))
    print (fmt.format('d3GdT2dP', rMELTS_ZR.cy_Liquid_rMELTS_ZR_dparam_d3gdt2dp(t, p, n, i)))
    print (fmt.format('d3GdTdP2', rMELTS_ZR.cy_Liquid_rMELTS_ZR_dparam_d3gdtdp2(t, p, n, i)))
    print (fmt.format('d3GdP3', rMELTS_ZR.cy_Liquid_rMELTS_ZR_dparam_d3gdp3(t, p, n, i)))</code>
            </sec>
            <sec id="cell-44-nb-1" specific-use="notebook-content">
    </sec>
            <sec id="parameter-derivatives-of-the-chemical-potential-nb-1">
              <title>Parameter derivatives of the chemical potential</title>
            </sec>
            <sec id="cell-45-nb-1" specific-use="notebook-code">
              <code language="python">def printResult(name, result, units):
    print ("dmu[*]/d {0:&lt;10.10s}".format(name), end=' ')
    [print ("{0:13.6e}".format(x), end=' ') for x in result]
    print ("{0:&lt;12.12s}".format(units))
def printLabels(n):
    print ("         {0:&lt;18.18s}".format(''), end=' ')
    [print ("[{0:3d}]{1:&lt;8.8s}".format(idx, ''), end=' ') for idx in range(len(n))]
    print ()
printLabels(n)
for i in range(0, nparam):
    result = rMELTS_ZR.cy_Liquid_rMELTS_ZR_dparam_dgdn(t,p,n, i)
    printResult(names[i], result, 'J/m^2/p-unit')</code>
            </sec>
          </sec>
        </sec>
      </sec>
    </body>
    <back>
</back>
  </sub-article>
  <sub-article article-type="notebook" id="nb-6-nb-2">
    <front-stub>
      <title-group>
        <article-title>1-Endmembers: MELTS Liquid Components Standard State Code
Generator</article-title>
      </title-group>
    </front-stub>
    <body>
      <sec id="cell-0-nb-2" specific-use="notebook-content">
        <sec id="endmembers-melts-liquid-components-standard-state-code-generator-nb-2">
          <title>1-Endmembers: MELTS Liquid Components Standard State Code
  Generator</title>
          <p>This notebook generates code to implement endmember component
  thermodynamic properties for a rhyolite-MELTS liquid model extended to
  include CO2 and ZrSiO4</p>
          <p>after:
  <bold>Ghiorso MS, Sack RO (1995) Chemical Mass Transfer in Magmatic
  Processes IV. A revised and internally consistent thermodynamic model
  for the interpolation and extrapolation of liquid-solid equilibria in
  magmatic systems at elevated temperatures and pressures. Contrib
  Mineral Petrology 119, 197-212</bold>
  and
  <bold>Gualda, G.A.R., Ghiorso, M.S., Lemons, R.V., Carley, T.L. (2012)
  Rhyolite-MELTS: A modified calibration of MELTS optimized for
  silica-rich, fluid-bearing magmatic systems. Journal of Petrology, 53,
  875-890</bold>
  and
  <bold>Ghiorso, M.S., Gualda, G.A.R. (2015) An H2O-CO2 mixed fluid
  saturation model compatible with rhyolite-MELTS. Contributions to
  Mineralogy and Petrology, doi:10.1007/s00410-015-1141-8</bold></p>
        </sec>
        <sec id="cell-1-nb-2" specific-use="notebook-code">
          <code language="python">import pandas as pd
import numpy as np
import sympy as sym
import math
sym.init_printing()
from thermoengine import coder,phases
import warnings
warnings.filterwarnings("ignore", category=DeprecationWarning)
warnings.filterwarnings("ignore", category=FutureWarning)</code>
        </sec>
        <sec id="cell-2-nb-2" specific-use="notebook-content">
          <sec id="special-case-sio2-nb-2">
            <title>Special case SiO2</title>
          </sec>
          <sec id="cell-3-nb-2" specific-use="notebook-code">
            <code language="python">model = coder.StdStateModel()
model.set_module_name('rMELTS_ZR')
model_type = "calib"
T = model.get_symbol_for_t()
P = model.get_symbol_for_p()
Tr = model.get_symbol_for_tr()
Pr = model.get_symbol_for_pr()</code>
          </sec>
          <sec id="cell-4-nb-2" specific-use="notebook-content">
            <p>G(liquid) Tr, Pr -&gt; G(liquid) Tg, Pr</p>
          </sec>
          <sec id="cell-5-nb-2" specific-use="notebook-code">
            <code language="python">h0,s0 = sym.symbols('h0 s0')
params = [('h0','J',h0), ('s0','J/K', s0)]
GPr = h0 - T*s0
model.add_expression_to_model(GPr, params)</code>
          </sec>
          <sec id="cell-6-nb-2" specific-use="notebook-code">
            <code language="python">al,bl,cl,dl,tg = sym.symbols('al bl cl dl tg')
params = [('al', 'J/K', al), ('bl', 'J/K^2', bl), ('cl', 'J-K^2', cl), ('dl', 'J-K^1/2', dl), ('tg', 'K', tg)]
Cpg = al + bl*T + cl/T**2 + dl/sym.sqrt(T)
GPr = sym.integrate(Cpg,(T,Tr,T)) - T*sym.integrate(Cpg/T,(T,Tr,T))
model.add_expression_to_model(GPr, params, exp_type='restricted', lower_limits=(Tr,None), upper_limits=(tg,None))</code>
          </sec>
          <sec id="cell-7-nb-2" specific-use="notebook-code">
            <code language="python">dummy = sym.symbols('dummy')
params = [('dummy', 'J', dummy)]
model.add_expression_to_model(GPr.subs(T,tg), params, exp_type='restricted', lower_limits=(tg,None), upper_limits=(None,None))</code>
          </sec>
          <sec id="cell-8-nb-2" specific-use="notebook-code">
            <code language="python">cpl = sym.symbols('cpl')
params = [('cpl', 'J/K', cpl)]
GPr = sym.integrate(cpl,(T,tg,T)) - T*sym.integrate(cpl/T,(T,tg,T))
model.add_expression_to_model(GPr, params, exp_type='restricted', lower_limits=(tg,None), upper_limits=(None,None))</code>
          </sec>
          <sec id="cell-9-nb-2" specific-use="notebook-code">
            <code language="python">v,dvdt,dvdp,d2vdtdp,d2vdp2,trl = sym.symbols('v dvdt dvdp d2vdtdp d2vdp2 trl')
params = [('v', 'J/bar', v), ('dvdt', 'J/bar-K', dvdt), ('dvdp', 'J/bar^2', dvdp), ('d2vdtdp', 'J/bar^2-K', d2vdtdp), 
          ('d2vdp2', 'J/bar^3', d2vdp2), ('trl','K',trl)]
GPrP = sym.integrate(v + dvdt*(T-trl) + (dvdp + d2vdtdp*(T-trl))*(P-Pr) + d2vdp2*(0.5*P**2 - Pr*(P-Pr)),(P,Pr,P))
model.add_expression_to_model(GPrP, params)</code>
          </sec>
          <sec id="cell-10-nb-2" specific-use="notebook-content">
            <sec id="build-instance-nb-2">
              <title>Build instance</title>
            </sec>
            <sec id="cell-11-nb-2" specific-use="notebook-code">
              <code language="python">model_working_dir = "working"
!mkdir -p {model_working_dir}
%cd {model_working_dir}</code>
            </sec>
            <sec id="cell-12-nb-2" specific-use="notebook-content">
              <p>Parameters from Ghiorso and Sack (1995)</p>
            </sec>
            <sec id="cell-13-nb-2" specific-use="notebook-code">
              <code language="python">param_dict = {
    'Phase': 'SiO2',
    'Formula': 'Si(1)O(2)',
    'h0':   -901554.0,
    's0':        48.475,
    'al':       127.200,
    'bl':       -10.777e-3,
    'cl':         4.3127e5,
    'dl':     -1463.8,
    'tg':      1480.0,
    'cpl':       81.373,
    'v':          2.690,
    'dvdt':       0.0,
    'dvdp':      -1.89e-5,
    'd2vdtdp':    1.3e-8,
    'd2vdp2':     3.6e-10, 
    'T_r':      298.15,
    'P_r':        1.0,
    'trl':     1673.15,
    'dummy':      1.0
}
result = model.create_code_module(phase=param_dict['Phase'], formula=param_dict['Formula'], params=param_dict, module_type=model_type)
%cp rMELTS_ZR.pyx endmembers.pyx
endmember_file_list = ['SiO2_rMELTS_ZR_calib.c']
endmember_name_list = ['SiO2']</code>
            </sec>
            <sec id="cell-14-nb-2" specific-use="notebook-content">
    </sec>
          </sec>
          <sec id="general-case-berman-solids---liquid-nb-2">
            <title>General case (Berman solids -&gt; liquid)</title>
          </sec>
          <sec id="cell-15-nb-2" specific-use="notebook-code">
            <code language="python">model = coder.StdStateModel()
model.set_module_name('rMELTS_ZR')
model_type = "calib"
T = model.get_symbol_for_t()
P = model.get_symbol_for_p()
Tr = model.get_symbol_for_tr()
Pr = model.get_symbol_for_pr()</code>
          </sec>
          <sec id="cell-16-nb-2" specific-use="notebook-content">
            <p>G(solid) at T, Pr: lattice heat capacity
    G(Solid) -&gt; G(liquid)</p>
          </sec>
          <sec id="cell-17-nb-2" specific-use="notebook-code">
            <code language="python">k0,k1,k2,k3,tFusion,sFusion,cpLiq = sym.symbols('k0 k1 k2 k3 tFusion sFusion cpLiq')
CpPr = k0 + k1/sym.sqrt(T) + k2/T**2 + k3/T**3
STrPr,HTrPr = sym.symbols('S_TrPr H_TrPr')
params = [('H_TrPr','J',HTrPr), ('S_TrPr','J/K',STrPr), ('k0','J/K-m',k0), ('k1','J-K^(1/2)-m',k1),
          ('k2','J-K/m',k2),  ('k3','J-K^2',k3), ('tFusion','J',tFusion), ('sFusion','J/K', sFusion), ('cpLiq', 'J/K', cpLiq)]
GPr = HTrPr + sym.integrate(CpPr,(T,Tr,tFusion)) - T*(STrPr + sym.integrate(CpPr/T,(T,Tr,tFusion))) \
    + sFusion*tFusion + cpLiq*(T-tFusion) - T*(sFusion + cpLiq*sym.log(T/tFusion))
model.add_expression_to_model(GPr, params)</code>
          </sec>
          <sec id="cell-18-nb-2" specific-use="notebook-code">
            <code language="python">GPr</code>
          </sec>
          <sec id="cell-19-nb-2" specific-use="notebook-content">
            <p>G(solid) at T, Pr: lambda transition</p>
          </sec>
          <sec id="cell-20-nb-2" specific-use="notebook-code">
            <code language="python">l1,l2 = sym.symbols('l1 l2')
Tl, Tlr = sym.symbols('T_lambda_Pr T_lambda_ref')
params = [('l1','(J/m)^(1/2)-K', l1), ('l2', '(J/m)^(1/2)/K^2', l2), ('T_lambda_Pr', 'K', Tl), ('T_lambda_ref', 'K', Tlr)]
Cpl = T*(l1+l2*T)**2
Gl = sym.integrate(Cpl,(T,Tlr,Tl)) - T*sym.integrate(Cpl/T,(T,Tlr,Tl))
model.add_expression_to_model(Gl, params, exp_type='restricted', lower_limits=(Tr,None), upper_limits=(None,None))</code>
          </sec>
          <sec id="cell-21-nb-2" specific-use="notebook-content">
            <p>G(solid) at T, Pr: first order phase transition</p>
          </sec>
          <sec id="cell-22-nb-2" specific-use="notebook-code">
            <code language="python">deltaHt = sym.symbols('H_t')
params = [('H_t','J/m', deltaHt)]
GaboveTl = -(T-Tl)*deltaHt/Tl
model.add_expression_to_model(GaboveTl , params, exp_type='restricted', lower_limits=(Tr,None), upper_limits=(None,None))</code>
          </sec>
          <sec id="cell-23-nb-2" specific-use="notebook-content">
            <p>G(liquid) at T, Pr -&gt; G(liquid) at T, P</p>
          </sec>
          <sec id="cell-24-nb-2" specific-use="notebook-code">
            <code language="python">Vtrl,dvdt,dvdp,d2vdtdp,d2vdp2,trl = sym.symbols('Vtrl dvdt dvdp d2vdtdp d2vdp2 trl')
params = [('Vtrl', 'J/bar', Vtrl), ('dvdt','J/bar-K',dvdt), ('dvdp','J/bar^2',dvdp), 
          ('d2vdtdp','J/bar^2-K',d2vdtdp),  ('d2vdp2','J/bar^3',d2vdp2), ('trl', 'K', trl)]
GTPrToP = (Vtrl + dvdt*(T-trl))*(P-Pr) + (dvdp + (T-trl)*d2vdtdp)*(P*P-Pr*Pr)/2 - (dvdp + (T-trl)*d2vdtdp)*Pr*(P-Pr) \
        + d2vdp2*( (P*P*P-Pr*Pr*Pr)/6 - Pr*(P*P-Pr*Pr)/2 + Pr*Pr*(P-Pr)/2 )
model.add_expression_to_model(GTPrToP, params)</code>
          </sec>
          <sec id="cell-25-nb-2" specific-use="notebook-code">
            <code language="python">GTPrToP</code>
          </sec>
          <sec id="cell-26-nb-2" specific-use="notebook-content">
            <sec id="build-instances-nb-2">
              <title>Build instances</title>
              <p>Parameters from Ghiorso and Sack (1995), unless noted.</p>
            </sec>
            <sec id="cell-27-nb-2" specific-use="notebook-content">
              <sec id="tio2-nb-2">
                <title>TiO2</title>
              </sec>
              <sec id="cell-28-nb-2" specific-use="notebook-code">
                <code language="python">param_dict = {
    'Phase': 'TiO2',
    'Formula': 'Ti(1)O(2)',
    'H_TrPr':   -944750.0,
    'S_TrPr':        50.460,
    'k0':            77.84,
    'k1':             0.0,
    'k2':           -33.678e5,
    'k3':            40.294e7,
    'l1':             0.0,
    'l2':             0.0,
    'T_lambda_Pr':    0.0,
    'T_lambda_ref':   0.0,
    'H_t':            0.0,
    'Vtrl':           2.316,
    'dvdt':           7.246e-4,
    'dvdp':          -2.310e-5,
    'd2vdtdp':        0.0,
    'd2vdp2':         5.0e-10, 
    'tFusion':     1870.0,
    'sFusion':       35.824,
    'cpLiq':        109.2,
    'T_r':          298.15,
    'P_r':            1.0,
    'trl':         1673.15
}
result = model.create_code_module(phase=param_dict['Phase'], formula=param_dict['Formula'], params=param_dict, module_type=model_type)
%cat rMELTS_ZR.pyx &gt;&gt; endmembers.pyx
endmember_file_list.append('TiO2_rMELTS_ZR_calib.c')
endmember_name_list.append('TiO2')</code>
              </sec>
              <sec id="cell-29-nb-2" specific-use="notebook-content">
      </sec>
              <sec id="al2o3-nb-2">
                <title>Al2O3</title>
              </sec>
              <sec id="cell-30-nb-2" specific-use="notebook-code">
                <code language="python">param_dict = {
    'Phase': 'Al2O3',
    'Formula': 'Al(2)O(3)',
    'H_TrPr':  -1675700.0,
    'S_TrPr':        50.82,
    'k0':           155.02,
    'k1':            -8.284E2,
    'k2':           -38.614E5,
    'k3':           40.908E7,
    'l1':             0.0,
    'l2':             0.0,
    'T_lambda_Pr':    0.0,
    'T_lambda_ref':   0.0,
    'H_t':            0.0,
    'Vtrl':           3.711,
    'dvdt':           2.62e-4,
    'dvdp':          -2.26e-5,
    'd2vdtdp':        2.7e-8,
    'd2vdp2':         4.0e-10, 
    'tFusion':     2319.65,
    'sFusion':       48.61,
    'cpLiq':        170.3,
    'T_r':          298.15,
    'P_r':            1.0,
    'trl':         1673.15
}
result = model.create_code_module(phase=param_dict['Phase'], formula=param_dict['Formula'], params=param_dict, module_type=model_type)
%cat rMELTS_ZR.pyx &gt;&gt; endmembers.pyx
endmember_file_list.append('Al2O3_rMELTS_ZR_calib.c')
endmember_name_list.append('Al2O3')</code>
              </sec>
              <sec id="cell-31-nb-2" specific-use="notebook-content">
      </sec>
              <sec id="fe2o3-nb-2">
                <title>Fe2O3</title>
              </sec>
              <sec id="cell-32-nb-2" specific-use="notebook-code">
                <code language="python">param_dict = {
    'Phase': 'Fe2O3',
    'Formula': 'Fe(2)O(3)',
    'H_TrPr':   -822000.0,
    'S_TrPr':        87.40,
    'k0':           146.86,
    'k1':             0.0,
    'k2':           -55.768E5,
    'k3':            52.563E7,
    'l1':            -7.403E-2,
    'l2':            27.921E-5,
    'T_lambda_Pr':  955.0,
    'T_lambda_ref': 298.15,
    'H_t':         1287.0,
    'Vtrl':           4.213,
    'dvdt':           9.09E-4,
    'dvdp':          -2.53E-5,
    'd2vdtdp':        3.1E-8,
    'd2vdp2':         4.4e-10, 
    'tFusion':     1895.0,
    'sFusion':       60.41,
    'cpLiq':        240.9,
    'T_r':          298.15,
    'P_r':            1.0,
    'trl':         1673.15
}
result = model.create_code_module(phase=param_dict['Phase'], formula=param_dict['Formula'], params=param_dict, module_type=model_type)
%cat rMELTS_ZR.pyx &gt;&gt; endmembers.pyx
endmember_file_list.append('Fe2O3_rMELTS_ZR_calib.c')
endmember_name_list.append('Fe2O3')</code>
              </sec>
              <sec id="cell-33-nb-2" specific-use="notebook-content">
      </sec>
              <sec id="mgcr2o4-nb-2">
                <title>MgCr2O4</title>
              </sec>
              <sec id="cell-34-nb-2" specific-use="notebook-code">
                <code language="python">param_dict = {
    'Phase': 'MgCr2O4',
    'Formula': 'Mg(1)Cr(2)O(4)',
    'H_TrPr':  -1783640.0,
    'S_TrPr':       106.02,
    'k0':           201.981,
    'k1':            -5.519E2,
    'k2':           -57.844E5,
    'k3':           57.729E7,
    'l1':             0.0,
    'l2':             0.0,
    'T_lambda_Pr':    0.0,
    'T_lambda_ref':   0.0,
    'H_t':            0.0,
    'Vtrl':           5.358,
    'dvdt':          11.71e-4,
    'dvdp':          -2.26e-5,
    'd2vdtdp':        1.8e-8,
    'd2vdp2':         4.67e-10, 
    'tFusion':     2673.15,
    'sFusion':       73.22,
    'cpLiq':        335.1,
    'T_r':          298.15,
    'P_r':            1.0,
    'trl':         1673.15
}
result = model.create_code_module(phase=param_dict['Phase'], formula=param_dict['Formula'], params=param_dict, module_type=model_type)
%cat rMELTS_ZR.pyx &gt;&gt; endmembers.pyx
endmember_file_list.append('MgCr2O4_rMELTS_ZR_calib.c')
endmember_name_list.append('MgCr2O4')</code>
              </sec>
              <sec id="cell-35-nb-2" specific-use="notebook-content">
      </sec>
              <sec id="fe2sio4-nb-2">
                <title>Fe2SiO4</title>
              </sec>
              <sec id="cell-36-nb-2" specific-use="notebook-code">
                <code language="python">param_dict = {
    'Phase': 'Fe2SiO4',
    'Formula': 'Fe(2)Si(1)O(4)',
    'H_TrPr':  -1479360.0,
    'S_TrPr':       150.930,
    'k0':           248.93,
    'k1':           -19.239E2,
    'k2':             0.0,
    'k3':           -13.910E7,
    'l1':             0.0,
    'l2':             0.0,
    'T_lambda_Pr':    0.0,
    'T_lambda_ref':   0.0,
    'H_t':            0.0,
    'Vtrl':           5.420,
    'dvdt':           5.84e-4,
    'dvdp':          -2.79e-5,
    'd2vdtdp':       -2.3e-8,
    'd2vdp2':        14.6e-10, 
    'tFusion':      1490.0,
    'sFusion':       59.9,
    'cpLiq':        240.2,
    'T_r':          298.15,
    'P_r':            1.0,
    'trl':         1673.15
}
result = model.create_code_module(phase=param_dict['Phase'], formula=param_dict['Formula'], params=param_dict, module_type=model_type)
%cat rMELTS_ZR.pyx &gt;&gt; endmembers.pyx
endmember_file_list.append('Fe2SiO4_rMELTS_ZR_calib.c')
endmember_name_list.append('Fe2SiO4')</code>
              </sec>
              <sec id="cell-37-nb-2" specific-use="notebook-content">
      </sec>
              <sec id="mnsi0.5o2-nb-2">
                <title>MnSi0.5O2</title>
              </sec>
              <sec id="cell-38-nb-2" specific-use="notebook-code">
                <code language="python">param_dict = {
    'Phase': 'MnSi1d2O2',
    'Formula': 'Mn(1)Si(0.5)O(2)',
    'H_TrPr':  -1732000.0/2.0,
    'S_TrPr':       155.9/2.0,
    'k0':           219.89/2.0,
    'k1':           -12.710E2/2.0,
    'k2':           -20.496E5/2.0,
    'k3':            17.652E7/2.0,
    'l1':             0.0,
    'l2':             0.0,
    'T_lambda_Pr':    0.0,
    'T_lambda_ref':   0.0,
    'H_t':            0.0,
    'Vtrl':           2.84,
    'dvdt':           5.84e-4/2.0,
    'dvdp':          -2.79e-5/2.0,
    'd2vdtdp':       -2.3e-8/2.0,
    'd2vdp2':        14.6e-10/2.0, 
    'tFusion':      1620.0,
    'sFusion':       27.6,
    'cpLiq':        121.6,
    'T_r':          298.15,
    'P_r':            1.0,
    'trl':         1673.15
}
result = model.create_code_module(phase=param_dict['Phase'], formula=param_dict['Formula'], params=param_dict, module_type=model_type)
%cat rMELTS_ZR.pyx &gt;&gt; endmembers.pyx
endmember_file_list.append('MnSi1d2O2_rMELTS_ZR_calib.c')
endmember_name_list.append('MnSi1d2O2')</code>
              </sec>
              <sec id="cell-39-nb-2" specific-use="notebook-content">
      </sec>
              <sec id="mg2sio4-nb-2">
                <title>Mg2SiO4</title>
              </sec>
              <sec id="cell-40-nb-2" specific-use="notebook-code">
                <code language="python">param_dict = {
    'Phase': 'Mg2SiO4',
    'Formula': 'Mg(2)Si(1)O(4)',
    'H_TrPr':  -2174420.0,
    'S_TrPr':        94.010,
    'k0':           238.64,
    'k1':           -20.013E2,
    'k2':             0.0,
    'k3':           -11.624E7,
    'l1':             0.0,
    'l2':             0.0,
    'T_lambda_Pr':    0.0,
    'T_lambda_ref':   0.0,
    'H_t':            0.0,
    'Vtrl':           4.980,
    'dvdt':           5.24e-4,
    'dvdp':          -1.35e-5,
    'd2vdtdp':       -1.3e-8,
    'd2vdp2':         4.14e-10, 
    'tFusion':      2163.0,
    'sFusion':       57.2,
    'cpLiq':        271.0,
    'T_r':          298.15,
    'P_r':            1.0,
    'trl':         1673.15
}
result = model.create_code_module(phase=param_dict['Phase'], formula=param_dict['Formula'], params=param_dict, module_type=model_type)
%cat rMELTS_ZR.pyx &gt;&gt; endmembers.pyx
endmember_file_list.append('Mg2SiO4_rMELTS_ZR_calib.c')
endmember_name_list.append('Mg2SiO4')</code>
              </sec>
              <sec id="cell-41-nb-2" specific-use="notebook-content">
      </sec>
              <sec id="nisi0.5o2-nb-2">
                <title>NiSi0.5O2</title>
              </sec>
              <sec id="cell-42-nb-2" specific-use="notebook-code">
                <code language="python">param_dict = {
    'Phase': 'NiSi1d2O2',
    'Formula': 'Ni(1)Si(0.5)O(2)',
    'H_TrPr':  -1395300.0/2.0,
    'S_TrPr':       128.1/2.0,
    'k0':           214.997/2.0,
    'k1':           -10.3075E2/2.0,
    'k2':           -49.4453E5/2.0,
    'k3':            62.375E7/2.0,
    'l1':             0.0,
    'l2':             0.0,
    'T_lambda_Pr':    0.0,
    'T_lambda_ref':   0.0,
    'H_t':            0.0,
    'Vtrl':           2.48,
    'dvdt':           5.84e-4/2.0,
    'dvdp':          -2.79e-5/2.0,
    'd2vdtdp':       -2.3e-8/2.0,
    'd2vdp2':        14.6e-10/2.0, 
    'tFusion':      1923.0,
    'sFusion':       29.0,
    'cpLiq':        119.3,
    'T_r':          298.15,
    'P_r':            1.0,
    'trl':         1673.15
}
result = model.create_code_module(phase=param_dict['Phase'], formula=param_dict['Formula'], params=param_dict, module_type=model_type)
%cat rMELTS_ZR.pyx &gt;&gt; endmembers.pyx
endmember_file_list.append('NiSi1d2O2_rMELTS_ZR_calib.c')
endmember_name_list.append('NiSi1d2O2')</code>
              </sec>
              <sec id="cell-43-nb-2" specific-use="notebook-content">
      </sec>
              <sec id="cosi0.5o2-nb-2">
                <title>CoSi0.5O2</title>
              </sec>
              <sec id="cell-44-nb-2" specific-use="notebook-code">
                <code language="python">param_dict = {
    'Phase': 'CoSi1d2O2',
    'Formula': 'Co(1)Si(0.5)O(2)',
    'H_TrPr':  -1414100.0/2.0,
    'S_TrPr':       142.6/2.0,
    'k0':           201.048/2.0,
    'k1':            -0.369E2/2.0,
    'k2':           -71.81E5/2.0,
    'k3':            90.05E7/2.0,
    'l1':             0.0,
    'l2':             0.0,
    'T_lambda_Pr':    0.0,
    'T_lambda_ref':   0.0,
    'H_t':            0.0,
    'Vtrl':           2.30,
    'dvdt':           5.84e-4/2.0,
    'dvdp':          -2.79e-5/2.0,
    'd2vdtdp':       -2.3e-8/2.0,
    'd2vdp2':        14.6e-10/2.0, 
    'tFusion':      1688.0,
    'sFusion':       29.0,
    'cpLiq':        125.3,
    'T_r':          298.15,
    'P_r':            1.0,
    'trl':         1673.15
}
result = model.create_code_module(phase=param_dict['Phase'], formula=param_dict['Formula'], params=param_dict, module_type=model_type)
%cat rMELTS_ZR.pyx &gt;&gt; endmembers.pyx
endmember_file_list.append('CoSi1d2O2_rMELTS_ZR_calib.c')
endmember_name_list.append('CoSi1d2O2')</code>
              </sec>
              <sec id="cell-45-nb-2" specific-use="notebook-content">
      </sec>
              <sec id="casio3-nb-2">
                <title>CaSiO3</title>
              </sec>
              <sec id="cell-46-nb-2" specific-use="notebook-code">
                <code language="python">param_dict = {
    'Phase': 'CaSiO3',
    'Formula': 'Ca(1)Si(1)O(3)',
    'H_TrPr':  -1627427.0,
    'S_TrPr':        85.279,
    'k0':           141.16,
    'k1':            -4.172e2,
    'k2':           -58.576e5,
    'k3':            94.074e7,
    'l1':             0.0,
    'l2':             0.0,
    'T_lambda_Pr':    0.0,
    'T_lambda_ref':   0.0,
    'H_t':            0.0,
    'Vtrl':           4.347,
    'dvdt':           2.92e-4,
    'dvdp':          -1.55e-5,
    'd2vdtdp':       -1.6e-8,
    'd2vdp2':         3.89e-10, 
    'tFusion':      1817.0,
    'sFusion':       31.5,
    'cpLiq':        172.4,
    'T_r':          298.15,
    'P_r':            1.0,
    'trl':         1673.15
}
result = model.create_code_module(phase=param_dict['Phase'], formula=param_dict['Formula'], params=param_dict, module_type=model_type)
%cat rMELTS_ZR.pyx &gt;&gt; endmembers.pyx
endmember_file_list.append('CaSiO3_rMELTS_ZR_calib.c')
endmember_name_list.append('CaSiO3')</code>
              </sec>
              <sec id="cell-47-nb-2" specific-use="notebook-content">
      </sec>
              <sec id="na2sio3-nb-2">
                <title>Na2SiO3</title>
              </sec>
              <sec id="cell-48-nb-2" specific-use="notebook-code">
                <code language="python">param_dict = {
    'Phase': 'Na2SiO3',
    'Formula': 'Na(2)Si(1)O(3)',
    'H_TrPr':   -373190.0*4.184,
    'S_TrPr':        27.21*4.184,
    'k0':           234.77,
    'k1':           -22.189E2,
    'k2':             0.0,
    'k3':            13.530E7,
    'l1':             0.0,
    'l2':             0.0,
    'T_lambda_Pr':    0.0,
    'T_lambda_ref':   0.0,
    'H_t':            0.0,
    'Vtrl':           5.568,
    'dvdt':           7.41e-4,
    'dvdp':          -4.29e-5,
    'd2vdtdp':       -5.3e-8,
    'd2vdp2':         8.4e-10, 
    'tFusion':      1361.0,
    'sFusion':       38.34,
    'cpLiq':        180.2,
    'T_r':          298.15,
    'P_r':            1.0,
    'trl':         1673.15
}
result = model.create_code_module(phase=param_dict['Phase'], formula=param_dict['Formula'], params=param_dict, module_type=model_type)
%cat rMELTS_ZR.pyx &gt;&gt; endmembers.pyx
endmember_file_list.append('Na2SiO3_rMELTS_ZR_calib.c')
endmember_name_list.append('Na2SiO3')</code>
              </sec>
              <sec id="cell-49-nb-2" specific-use="notebook-content">
      </sec>
              <sec id="kalsio4-nb-2">
                <title>KAlSiO4</title>
              </sec>
              <sec id="cell-50-nb-2" specific-use="notebook-code">
                <code language="python">param_dict = {
    'Phase': 'KAlSiO4',
    'Formula': 'K(1)Al(1)Si(1)O(4)',
    'H_TrPr':  -2111813.55,
    'S_TrPr':       133.9653,
    'k0':           186.0,
    'k1':             0.0,
    'k2':          -131.067E5,
    'k3':           213.893E7,
    'l1':            -7.096454E-2,
    'l2':            21.682E-5,
    'T_lambda_Pr':  800.15,
    'T_lambda_ref': 298.15,
    'H_t':         1154.0,
    'Vtrl':           6.8375,
    'dvdt':           7.265e-4,
    'dvdp':          -6.395e-5,
    'd2vdtdp':       -4.6e-8,
    'd2vdp2':        12.1e-10, 
    'tFusion':      2023.15,
    'sFusion':       24.5,
    'cpLiq':        217.0,
    'T_r':          298.15,
    'P_r':            1.0,
    'trl':         1673.15
}
result = model.create_code_module(phase=param_dict['Phase'], formula=param_dict['Formula'], params=param_dict, module_type=model_type)
%cat rMELTS_ZR.pyx &gt;&gt; endmembers.pyx
endmember_file_list.append('KAlSiO4_rMELTS_ZR_calib.c')
endmember_name_list.append('KAlSiO4')</code>
              </sec>
              <sec id="cell-51-nb-2" specific-use="notebook-content">
      </sec>
              <sec id="ca3po32-nb-2">
                <title>Ca3(PO3)2</title>
              </sec>
              <sec id="cell-52-nb-2" specific-use="notebook-code">
                <code language="python">param_dict = {
    'Phase': 'Ca3P2O8',
    'Formula': 'Ca(3)P(2)O(8)',
    'H_TrPr':  -4097169.0,
    'S_TrPr':       235.978,
    'k0':           402.997,
    'k1':           -28.0835E2,
    'k2':             0.0,
    'k3':           -32.6230E7,
    'l1':             2.5427E-2,
    'l2':            19.255E-5,
    'T_lambda_Pr': 1373.0,
    'T_lambda_ref': 298.15,
    'H_t':        14059.0,
    'Vtrl':          10.7382,
    'dvdt':           0.0,
    'dvdp':           0.0,
    'd2vdtdp':        0.0,
    'd2vdp2':         0.0, 
    'tFusion':      1943.15,
    'sFusion':       35.690,
    'cpLiq':        574.67,
    'T_r':          298.15,
    'P_r':            1.0,
    'trl':         1673.15
}
result = model.create_code_module(phase=param_dict['Phase'], formula=param_dict['Formula'], params=param_dict, module_type=model_type)
%cat rMELTS_ZR.pyx &gt;&gt; endmembers.pyx
endmember_file_list.append('Ca3P2O8_rMELTS_ZR_calib.c')
endmember_name_list.append('Ca3P2O8')</code>
              </sec>
              <sec id="cell-53-nb-2" specific-use="notebook-content">
      </sec>
              <sec id="h2o-nb-2">
                <title>H2O</title>
                <p>This is a placeholder model for the one described in Ghiorso
        and Gualda (2015). The real code is copied into the working
        directory.</p>
              </sec>
              <sec id="cell-54-nb-2" specific-use="notebook-code">
                <code language="python">param_dict = {
    'Phase': 'H2O',
    'Formula': 'H(2)O(1)',
    'H_TrPr':    -99999.0,
    'S_TrPr':         0.0,
    'k0':             0.0,
    'k1':             0.0,
    'k2':             0.0,
    'k3':             0.0,
    'l1':             0.0,
    'l2':             0.0,
    'T_lambda_Pr':    0.0,
    'T_lambda_ref':   0.0,
    'H_t':            0.0,
    'Vtrl':           0.0,
    'dvdt':           0.0,
    'dvdp':           0.0,
    'd2vdtdp':        0.0,
    'd2vdp2':         0.0, 
    'tFusion':     1000.0,
    'sFusion':        0.0,
    'cpLiq':          0.0,
    'T_r':          298.15,
    'P_r':            1.0,
    'trl':         1673.15
}
result = model.create_code_module(phase=param_dict['Phase'], formula=param_dict['Formula'], params=param_dict, module_type=model_type)
%cat rMELTS_ZR.pyx &gt;&gt; endmembers.pyx
%cp ../H2O_rMELTS_ZR_calib.c .
%cp ../H2O_rMELTS_ZR_calib.h .
endmember_file_list.append('H2O_rMELTS_ZR_calib.c')
endmember_name_list.append('H2O')</code>
              </sec>
              <sec id="cell-55-nb-2" specific-use="notebook-content">
      </sec>
              <sec id="co2-nb-2">
                <title>CO2</title>
                <p>The enthalpy, entropy, heat capacity and dCpDt entries are
        correction terms that should be added to Duan’s pure CO2
        This is a placeholder model for the one described in Ghiorso and
        Gualda (2015). The real code is copied into the working
        directory.</p>
              </sec>
              <sec id="cell-56-nb-2" specific-use="notebook-code">
                <code language="python">param_dict = {
    'Phase': 'CO2',
    'Formula': 'C(1)O(2)',
    'H_TrPr':        -6.3093193811701e-01*1000.0,
    'S_TrPr':        -1.0939331414050e+02,
    'k0':             0.0,
    'k1':             0.0,
    'k2':             0.0,
    'k3':             0.0,
    'l1':             0.0,
    'l2':             0.0,
    'T_lambda_Pr':    0.0,
    'T_lambda_ref':   0.0,
    'H_t':            0.0,
    'Vtrl':           4.0157994267547e+00,
    'dvdt':           1.2131890000000e+00/1000.0,
    'dvdp':          -4.2673870000000e-01/10000.0,
    'd2vdtdp':        0.0,
    'd2vdp2':         0.0, 
    'tFusion':     1000.0,
    'sFusion':        0.0,
    'cpLiq':          0.0,
    'T_r':          298.15,
    'P_r':            1.0,
    'trl':         1673.15
}
result = model.create_code_module(phase=param_dict['Phase'], formula=param_dict['Formula'], params=param_dict, module_type=model_type)
%cat rMELTS_ZR.pyx &gt;&gt; endmembers.pyx
%cp ../CO2_rMELTS_ZR_calib.c .
%cp ../CO2_rMELTS_ZR_calib.h .
endmember_file_list.append('CO2_rMELTS_ZR_calib.c')
endmember_name_list.append('CO2')</code>
              </sec>
              <sec id="cell-57-nb-2" specific-use="notebook-content">
      </sec>
            </sec>
          </sec>
          <sec id="special-case-zrsio4-nb-2">
            <title>Special case ZrSiO4</title>
            <p>New component, not in previously published material.
    Properties are derived from Robie and Hemingway, 1995:
    Robie RA, Hemingway BS (1995) Thermodynamic Properties of Minerals
    and Related Substances at 298.15 K and 1 Bar (105 Pascals) Pressure
    and at Higher Temperatures. US Geological Survey Bulletin 2131,
    461pp.</p>
          </sec>
          <sec id="cell-58-nb-2" specific-use="notebook-code">
            <code language="python">model = coder.StdStateModel()
model.set_module_name('rMELTS_ZR')
model_type = "calib"
T = model.get_symbol_for_t()
P = model.get_symbol_for_p()
Tr = model.get_symbol_for_tr()
Pr = model.get_symbol_for_pr()</code>
          </sec>
          <sec id="cell-59-nb-2" specific-use="notebook-content">
            <p>$C_P = A_1 + A_2 T + + + A_5 T^2 $</p>
          </sec>
          <sec id="cell-60-nb-2" specific-use="notebook-code">
            <code language="python">h0,s0,v0,a1,a2,a3,a4,a5 = sym.symbols('h0 s0 v0 a1 a2 a3 a4 a5')
params = [('h0','J',h0), ('s0', 'J/K', s0), ('v0', 'J/bar', v0), 
          ('a1', 'J/K', a1), ('a2', 'J/K^2', a2), ('a3', 'J-K', a3), ('a4', 'J/K^1/2', a4), ('a5', 'J/K^3', a5)]
Cp = a1 + a2*T + a3/T**2 + a4/sym.sqrt(T) +a5*T**2
H = h0 + sym.integrate(Cp,(T,Tr,T))
S = s0 + sym.integrate(Cp/T,(T,Tr,T))
GPrP = sym.integrate(v0,(P,Pr,P))
G = H - T*S + GPrP
G</code>
          </sec>
          <sec id="cell-61-nb-2" specific-use="notebook-code">
            <code language="python">model.add_expression_to_model(G, params)</code>
          </sec>
          <sec id="cell-62-nb-2" specific-use="notebook-code">
            <code language="python">param_dict = {
    'Phase': 'ZrSiO4',
    'Formula': 'Zr(1)Si(1)O(4)',
    'h0':  -2034200.0,          # Robie and Hemingway
    's0':        84.0,          # Robie and Hemingway
    'v0':         3.926,        # Robie and Hemingway
    'a1':         2.370e2,      # Robie and Hemingway
    'a2':        -1.788e-2,     # Robie and Hemingway
    'a3':        -1.496e5,      # Robie and Hemingway
    'a4':        -2.268e3,      # Robie and Hemingway
    'a5':         0.0,          # Robie and Hemingway
    'T_r':      298.15,
    'P_r':        1.0
}
result = model.create_code_module(phase=param_dict['Phase'], formula=param_dict['Formula'], params=param_dict, module_type=model_type)
%cat rMELTS_ZR.pyx &gt;&gt; endmembers.pyx
endmember_file_list.append('ZrSiO4_rMELTS_ZR_calib.c')
endmember_name_list.append('ZrSiO4')</code>
          </sec>
          <sec id="cell-63-nb-2" specific-use="notebook-content">
  </sec>
          <sec id="import-the-module-nb-2">
            <title>Import the module</title>
            <p>First, update the cython build file to include all of the
    endmember modules</p>
          </sec>
          <sec id="cell-64-nb-2" specific-use="notebook-code">
            <code language="python">with open('rMELTS_ZR.pyxbld', 'r') as f:
    fold = f.read()
    f.close()
old_file_list = "'" + endmember_file_list[-1] + "'"
new_file_list = ''
sep = ''
for x in endmember_file_list:
    new_file_list += sep + "'" + x + "'"
    sep = ", "
fnew = fold.replace(old_file_list, new_file_list)
with open('rMELTS_ZR.pyxbld', 'w') as f:
    f.write(fnew)
    f.close
%cp endmembers.pyx rMELTS_ZR.pyx</code>
          </sec>
          <sec id="cell-65-nb-2" specific-use="notebook-code">
            <code language="python">import rMELTS_ZR
%cd ..</code>
          </sec>
          <sec id="cell-66-nb-2" specific-use="notebook-content">
  </sec>
          <sec id="testing-nb-2">
            <title>Testing</title>
            <p>Evaluate test functions at temperature (K) and pressure
    (bars)</p>
          </sec>
          <sec id="cell-67-nb-2" specific-use="notebook-code">
            <code language="python">t = 1000.0
p = 1000.0</code>
          </sec>
          <sec id="cell-68-nb-2" specific-use="notebook-content">
            <p>Generic testing method, utilized here and below</p>
          </sec>
          <sec id="cell-69-nb-2" specific-use="notebook-code">
            <code language="python">from rubicon.objc import ObjCClass
src_cls = ObjCClass('LiquidMeltsPlusOldH2OandNewCO2')
src_obj = src_cls.alloc().init()</code>
          </sec>
          <sec id="cell-70-nb-2" specific-use="notebook-code">
            <code language="python">def compare_model_and_timers(new_model='SiO2', old_model_index=0, print_results=True, time_g=True):
    def cmp_output(ref, x, y):
        fmt = "{0:&lt;10.10s} {1:13.6e} {2:13.6e} {3:13.6e} {4:6.2f}%"
        if print_results:
            print(fmt.format(ref, x, y, x-y, 100.0*math.fabs((x-y)/y)))
        else:
            assert 100.0*math.fabs((x-y)/y) &lt; 0.01, ref+' fails comparison!'
    def tst_output(ref, x):
        fmts = "{0:&lt;10.10s} {1:13.6e}"
        if print_results:
            print(fmts.format(ref, x))
    refPhase = src_obj.endmembers[old_model_index]
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_g')(t,p)
    y = refPhase.getGibbsFreeEnergyFromT_andP_(t,p)
    cmp_output('G', x, y)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_dgdt')(t,p)
    y = -refPhase.getEntropyFromT_andP_(t,p)
    cmp_output('dGdT', x, y)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_dgdp')(t,p)
    y = refPhase.getVolumeFromT_andP_(t,p)
    cmp_output('dGdP', x, y) 
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_d2gdt2')(t,p)
    tst_output('d2GdT2', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_d2gdtdp')(t,p)
    tst_output('d2GdTdP', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_d2gdp2')(t,p)
    tst_output('d2GdP2', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_d3gdt3')(t,p)
    tst_output('d3GdT3', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_d3gdt2dp')(t,p)
    tst_output('d3GdT2dP', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_d3gdtdp2')(t,p)
    tst_output('d3GdTdP2', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_d3gdp3')(t,p)
    tst_output('d3GdP3', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_s')(t,p)
    y = refPhase.getEntropyFromT_andP_(t,p)
    cmp_output('S', x, y)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_v')(t,p)
    y = refPhase.getVolumeFromT_andP_(t,p)
    cmp_output('V', x, y)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_cv')(t,p)
    tst_output('Cv', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_cp')(t,p)
    y = refPhase.getHeatCapacityFromT_andP_(t,p)
    cmp_output('Cp', x, y)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_dcpdt')(t,p)
    tst_output('dCpdT', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_alpha')(t,p)
    tst_output('alpha', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_beta')(t,p)
    tst_output('beta', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_K')(t,p)
    tst_output('K', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_Kp')(t,p)
    tst_output('Kp', x)
    if time_g:
        print ('Time coder generated function ...')
        method = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_g')
        %timeit method(t, p)
        print ('Time provided Objective-C function ...')
        %timeit refPhase.getGibbsFreeEnergyFromT_andP_(t,p)</code>
          </sec>
          <sec id="cell-71-nb-2" specific-use="notebook-content">
            <p>Test and time code</p>
          </sec>
          <sec id="cell-72-nb-2" specific-use="notebook-code">
            <code language="python">for i,x in enumerate(endmember_name_list):
    if x != 'ZrSiO4':
        print ('Testing code for', x, '...')
        compare_model_and_timers(new_model=x, old_model_index=i, print_results=True, time_g=False)
        print ('')</code>
          </sec>
          <sec id="cell-73-nb-2" specific-use="notebook-code">
            <code language="python">def output_model_and_timers(new_model='SiO2', print_results=True, time_g=True):
    def tst_output(ref, x):
        fmts = "{0:&lt;10.10s} {1:13.6e}"
        if print_results:
            print(fmts.format(ref, x))
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_g')(t,p)
    tst_output('G', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_dgdt')(t,p)
    tst_output('dGdT', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_dgdp')(t,p)
    tst_output('dGdP', x) 
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_d2gdt2')(t,p)
    tst_output('d2GdT2', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_d2gdtdp')(t,p)
    tst_output('d2GdTdP', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_d2gdp2')(t,p)
    tst_output('d2GdP2', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_d3gdt3')(t,p)
    tst_output('d3GdT3', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_d3gdt2dp')(t,p)
    tst_output('d3GdT2dP', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_d3gdtdp2')(t,p)
    tst_output('d3GdTdP2', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_d3gdp3')(t,p)
    tst_output('d3GdP3', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_s')(t,p)
    tst_output('S', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_v')(t,p)
    tst_output('V', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_cv')(t,p)
    tst_output('Cv', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_cp')(t,p)
    tst_output('Cp', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_dcpdt')(t,p)
    tst_output('dCpdT', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_alpha')(t,p)
    tst_output('alpha', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_beta')(t,p)
    tst_output('beta', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_K')(t,p)
    tst_output('K', x)
    x = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_Kp')(t,p)
    tst_output('Kp', x)
    if time_g:
        print ('Time coder generated function ...')
        method = getattr(rMELTS_ZR, 'cy_'+new_model+'_rMELTS_ZR_calib_g')
        %timeit method(t, p)</code>
          </sec>
          <sec id="cell-74-nb-2" specific-use="notebook-content">
  </sec>
          <sec id="timing-the-zrsio4-code-nb-2">
            <title>Timing the ZrSiO4 code</title>
          </sec>
          <sec id="cell-75-nb-2" specific-use="notebook-code">
            <code language="python">output_model_and_timers(new_model='ZrSiO4', print_results=True, time_g=True)</code>
          </sec>
        </sec>
      </sec>
    </body>
    <back>
</back>
  </sub-article>
  <sub-article article-type="notebook" id="nb-9-nb-3">
    <front-stub>
      <title-group>
        <article-title>5-Initial parameter estimates: MELTS liquid model with
ZrSiO4</article-title>
      </title-group>
    </front-stub>
    <body>
      <sec id="cell-0-nb-3" specific-use="notebook-content">
        <sec id="initial-parameter-estimates-melts-liquid-model-with-zrsio4-nb-3">
          <title>5-Initial parameter estimates: MELTS liquid model with
  ZrSiO4</title>
          <p>
            <bold>Parameter and calibration exploration notebook.</bold>
            <bold>Run Endmembers-MELTS and Liquid-MELTS-codegen notebooks
  first!</bold>
          </p>
          <p>Proposed associated solution model:</p>
          <table-wrap>
            <table>
              <colgroup>
                <col width="19%"/>
                <col width="14%"/>
                <col width="16%"/>
                <col width="16%"/>
                <col width="18%"/>
                <col width="18%"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="left">Components:</th>
                  <th align="left">Species:</th>
                  <th align="left">Reaction:</th>
                  <th align="left">Variable:</th>
                  <th align="left">Component:</th>
                  <th align="left">Species X:</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left">SiO2</td>
                  <td align="left">SiO2</td>
                  <td align="left"/>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_1]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_1]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">TiO2</td>
                  <td align="left">TiO2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_1]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_2]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_2]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Al2O3</td>
                  <td align="left">Al2O3</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_2]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_3]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>3</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_3]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>3</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Fe2O3</td>
                  <td align="left">Fe2O3</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_3]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>3</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_4]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>4</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_4]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>4</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">MgCr2O4</td>
                  <td align="left">MgCr2O4</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_4]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>4</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_5]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>5</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_5]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>5</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Fe2SiO4</td>
                  <td align="left">Fe2SiO4</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_5]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>5</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_6]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>6</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_6]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>6</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">MnSi1/2O2</td>
                  <td align="left">MnSi1/2O2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_6]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>6</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_7]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>7</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_7]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>7</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Mg2SiO4</td>
                  <td align="left">Mg2SiO4</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_7]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>7</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_8]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>8</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_8]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>8</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">NiSi1/2O2</td>
                  <td align="left">NiSi1/2O2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_8]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>8</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_9]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>9</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_9]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>9</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">CoSi1/2O2</td>
                  <td align="left">CoSi1/2O2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_9]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>9</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{10}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>10</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{10}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>10</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">CaSiO3</td>
                  <td align="left">CaSiO3</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{10}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>10</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{11}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>11</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{11}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>11</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Na2SiO3</td>
                  <td align="left">Na2SiO3</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{11}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>11</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{12}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>12</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{12}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>12</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">KAlSiO4</td>
                  <td align="left">KAlSiO4</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{12}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>12</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{13}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>13</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{13}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>13</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Ca3(PO4)2</td>
                  <td align="left">Ca3(PO4)2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{13}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>13</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{14}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>14</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{14}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>14</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">H2O</td>
                  <td align="left">H2O</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{14}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>14</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{15}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>15</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{15}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>15</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">CO2</td>
                  <td align="left">CO2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{15}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>15</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{16}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>16</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{16}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>16</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">ZrSiO4</td>
                  <td align="left">ZrSiO4</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{16}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>16</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{17}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>17</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{17}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>17</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left"/>
                  <td align="left">CaCO3</td>
                  <td align="left">CO2 + CaSiO3 = CaCO3 + SiO2</td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[s_1]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>s</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{18}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>18</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left"/>
                  <td align="left">Na4ZrSi2O8</td>
                  <td align="left">ZrSiO4 + 2Na2SiO3 = Na4ZrSi2O8 + SiO2</td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[s_2]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>s</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{19}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>19</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left"/>
                  <td align="left">K4ZrSi2O8</td>
                  <td align="left">ZrSiO4 + 4KAlSiO4 = K4ZrSi2O8 + 2Al2O3 +
          3SiO2</td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[s_3]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>s</mml:mi>
                            <mml:mn>3</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{20}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>20</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
        </sec>
        <sec id="cell-1-nb-3" specific-use="notebook-code">
          <code language="python">import pandas as pd
import numpy as np
from thermoengine import core
from thermoengine.model import Database
db = Database()
import warnings
warnings.filterwarnings("ignore", category=DeprecationWarning)
warnings.filterwarnings("ignore", category=FutureWarning)</code>
        </sec>
        <sec id="cell-2-nb-3" specific-use="notebook-content">
          <list list-type="bullet">
            <list-item>
              <p>Number of components = 17</p>
            </list-item>
            <list-item>
              <p>Number of species = 20</p>
            </list-item>
            <list-item>
              <p>Number of “ordering parameters” (i.e., dependent species) =
      3</p>
            </list-item>
          </list>
        </sec>
        <sec id="cell-3-nb-3" specific-use="notebook-code">
          <code language="python">nc = 17
nw = 20
ns = 3</code>
        </sec>
        <sec id="cell-4-nb-3" specific-use="notebook-content">
          <p>Import previously generated and compiled model</p>
        </sec>
        <sec id="cell-5-nb-3" specific-use="notebook-code">
          <code language="python">model_working_dir = "working"
%cd {model_working_dir}
from pyximport import install
install()
import rMELTS_ZR
%cd ..</code>
        </sec>
        <sec id="cell-6-nb-3" specific-use="notebook-content">
          <p>Test identifier routines</p>
        </sec>
        <sec id="cell-7-nb-3" specific-use="notebook-code">
          <code language="python">print(rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_identifier())
print(rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_name())</code>
        </sec>
        <sec id="cell-8-nb-3" specific-use="notebook-content">
          <p>Set a default temperature and pressure (T in K, P in bars)</p>
        </sec>
        <sec id="cell-9-nb-3" specific-use="notebook-code">
          <code language="python">t = 1000.00
p = 1000.0</code>
        </sec>
        <sec id="cell-10-nb-3" specific-use="notebook-content">
          <sec id="read-common-scripts-nb-3">
            <title>Read common scripts</title>
            <p>Execute scripts in the Jupyter notebook namespace so that methods
    have access to notebook variables.</p>
          </sec>
          <sec id="cell-11-nb-3" specific-use="notebook-code">
            <code language="python">%run -i support_scripts.py</code>
          </sec>
          <sec id="cell-12-nb-3" specific-use="notebook-content">
  </sec>
          <sec id="construct-initial-parameter-estimates-nb-3">
            <title>Construct initial parameter estimates</title>
            <p>Standard state properties of endmember components</p>
          </sec>
          <sec id="cell-13-nb-3" specific-use="notebook-code">
            <code language="python">for x,y in zip(rMELTS_ZR.cy_Liquid_rMELTS_ZR_get_param_names(), rMELTS_ZR.cy_Liquid_rMELTS_ZR_get_param_values()):
    print ("{0:&lt;10.10s} {1:13.6g}".format(x,y))</code>
          </sec>
          <sec id="cell-14-nb-3" specific-use="notebook-code">
            <code language="python">mu0_SiO2 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_mu0(0, t, p)
mu0_Al2O3 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_mu0(2, t, p)
mu0_Fe2O3 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_mu0(3, t, p)
mu0_Fe2SiO4 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_mu0(5, t, p)
mu0_CaSiO3 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_mu0(10, t, p)
mu0_Na2SiO3 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_mu0(11, t, p)
mu0_KAlSiO4 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_mu0(12, t, p)
mu0_CO2 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_mu0(15, t, p)
mu0_ZrSiO4 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_mu0(16, t, p)
#
mu0dT_SiO2 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dT(0, t, p)
mu0dT_Al2O3 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dT(2, t, p)
mu0dT_Fe2O3 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dT(3, t, p)
mu0dT_Fe2SiO4 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dT(5, t, p)
mu0dT_CaSiO3 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dT(10, t, p)
mu0dT_Na2SiO3 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dT(11, t, p)
mu0dT_KAlSiO4 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dT(12, t, p)
mu0dT_CO2 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dT(15, t, p)
mu0dT_ZrSiO4 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dT(16, t, p)
#
mu0dP_SiO2 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dP(0, t, p)
mu0dP_Al2O3 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dP(2, t, p)
mu0dP_Fe2O3 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dP(3, t, p)
mu0dP_Fe2SiO4 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dP(5, t, p)
mu0dP_CaSiO3 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dP(10, t, p)
mu0dP_Na2SiO3 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dP(11, t, p)
mu0dP_KAlSiO4 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dP(12, t, p)
mu0dP_CO2 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dP(15, t, p)
mu0dP_ZrSiO4 = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dP(16, t, p)</code>
          </sec>
          <sec id="cell-15-nb-3" specific-use="notebook-content">
            <p>Compute properties of the CaCO3 dependent species: - CaCO3
    calibration adjustments are from Ghiorso and Gualda (2015)</p>
            <preformat>known_depen_species_values = [
    -1.7574497522747e+01*1000.0, 0.0, -1.9034060173857e+00, # H, S, V, CaCO3
]</preformat>
            <p>Set these parameter values in the model</p>
          </sec>
          <sec id="cell-16-nb-3" specific-use="notebook-code">
            <code language="python">h_delta_calib_CaCO3 = -1.7574497522747e+01*1000.0
s_delta_calib_CaCO3 = 0.0
v_delta_calib_CaCO3 = -1.9034060173857e+00
mu0_CaCO3 = mu0_CO2 + mu0_CaSiO3 - mu0_SiO2
mu0dT_CaCO3 = mu0dT_CO2 + mu0dT_CaSiO3 - mu0dT_SiO2
mu0dP_CaCO3 = mu0dP_CO2 + mu0dP_CaSiO3 - mu0dP_SiO2
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(2, mu0_CaCO3 - t*mu0dT_CaCO3 + h_delta_calib_CaCO3) 
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(3, -mu0dT_CaCO3 + s_delta_calib_CaCO3) 
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(4,  mu0dP_CaCO3 + v_delta_calib_CaCO3)
mu0_CaCO3 + h_delta_calib_CaCO3, mu0_CaCO3 - t*mu0dT_CaCO3 + h_delta_calib_CaCO3, -mu0dT_CaCO3 + s_delta_calib_CaCO3, mu0dP_CaCO3 + v_delta_calib_CaCO3</code>
          </sec>
          <sec id="cell-17-nb-3" specific-use="notebook-content">
            <sec id="properties-of-the-zirconium-species-are-estimated-by-choosing-a-value-for-h-s-and-v-that-zeros-the-delta-difference-of-the-exchange-reaction-nb-3">
              <title>Properties of the zirconium species are estimated by
      choosing a value for h, s, and v that zeros the delta difference
      of the exchange reaction</title>
            </sec>
            <sec id="cell-18-nb-3" specific-use="notebook-content">
              <p>ZrSiO4 + 2Na2SiO3 = Na4ZrSi2O8 + SiO2</p>
            </sec>
            <sec id="cell-19-nb-3" specific-use="notebook-code">
              <code language="python">mu0_Na4ZrSi2O8   = mu0_ZrSiO4   + 2.0*mu0_Na2SiO3   - mu0_SiO2
mu0dT_Na4ZrSi2O8 = mu0dT_ZrSiO4 + 2.0*mu0dT_Na2SiO3 - mu0dT_SiO2
mu0dP_Na4ZrSi2O8 = mu0dP_ZrSiO4 + 2.0*mu0dP_Na2SiO3 - mu0dP_SiO2
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(5, mu0_Na4ZrSi2O8 - t*mu0dT_Na4ZrSi2O8 - (p-1.0)*mu0dP_Na4ZrSi2O8)
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(6, -mu0dT_Na4ZrSi2O8)
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(7, mu0dP_Na4ZrSi2O8)
mu0_Na4ZrSi2O8, mu0_Na4ZrSi2O8 - t*mu0dT_Na4ZrSi2O8 - (p-1.0)*mu0dP_Na4ZrSi2O8, -mu0dT_Na4ZrSi2O8, mu0dP_Na4ZrSi2O8</code>
            </sec>
            <sec id="cell-20-nb-3" specific-use="notebook-content">
              <p>ZrSiO4 + 4KAlSiO4 = K4ZrSi2O8 + 2Al2O3 + 3SiO2</p>
            </sec>
            <sec id="cell-21-nb-3" specific-use="notebook-code">
              <code language="python">mu0_K4ZrSi2O8   = mu0_ZrSiO4   + 4.0*mu0_KAlSiO4   - 3.0*mu0_SiO2   - 2.0*mu0_Al2O3
mu0dT_K4ZrSi2O8 = mu0dT_ZrSiO4 + 4.0*mu0dT_KAlSiO4 - 3.0*mu0dT_SiO2 - 2.0*mu0dT_Al2O3
mu0dP_K4ZrSi2O8 = mu0dP_ZrSiO4 + 4.0*mu0dP_KAlSiO4 - 3.0*mu0dP_SiO2 - 2.0*mu0dP_Al2O3
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(8, mu0_K4ZrSi2O8 - t*mu0dT_K4ZrSi2O8 - (p-1.0)*mu0dP_K4ZrSi2O8)
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(9, -mu0dT_K4ZrSi2O8)
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(10, mu0dP_K4ZrSi2O8)
mu0_K4ZrSi2O8, mu0_K4ZrSi2O8 - t*mu0dT_K4ZrSi2O8 - (p-1.0)*mu0dP_K4ZrSi2O8, -mu0dT_K4ZrSi2O8, mu0dP_K4ZrSi2O8</code>
            </sec>
            <sec id="cell-22-nb-3" specific-use="notebook-content">
              <p>Summary of parameter estimates</p>
            </sec>
            <sec id="cell-23-nb-3" specific-use="notebook-code">
              <code language="python">for x,y in zip(rMELTS_ZR.cy_Liquid_rMELTS_ZR_get_param_names(), rMELTS_ZR.cy_Liquid_rMELTS_ZR_get_param_values()):
    print ("{0:&lt;10.10s} {1:13.6g}".format(x,y))</code>
            </sec>
            <sec id="cell-24-nb-3" specific-use="notebook-content">
    </sec>
          </sec>
          <sec id="specify-an-input-composition-nb-3">
            <title>Specify an input composition</title>
          </sec>
          <sec id="cell-25-nb-3" specific-use="notebook-code">
            <code language="python">wtZrSiO4 = 183.31*0.001 # weight of ZrSiO4 equal to 0.001 moles of Zr</code>
          </sec>
          <sec id="cell-26-nb-3" specific-use="notebook-code">
            <code language="python">elm_sys = ['H','O','Na','Mg','Al','Si','P','K','Ca','Ti','Cr','Mn','Fe','Co','Ni']
grm_oxides = {
    'SiO2':  77.5, 
    'TiO2':   0.08, 
    'Al2O3': 12.5, 
    'Fe2O3':  0.207,
    'Cr2O3':  0.0, 
    'FeO':    0.473, 
    'MnO':    0.0,
    'MgO':    0.03, 
    'NiO':    0.0, 
    'CoO':    0.0,
    'CaO':    0.43, 
    'Na2O':   3.98, 
    'K2O':    4.88, 
    'P2O5':   0.0, 
    'H2O':    5.5,
    'CO2':    0.05
}
tot_grm_oxides = 0.0
for key in grm_oxides.keys():
    tot_grm_oxides += grm_oxides[key]
mol_oxides = core.chem.format_mol_oxide_comp(grm_oxides, convert_grams_to_moles=True)
mol_elm = core.chem.mol_oxide_to_elem(mol_oxides)
elm = np.zeros(107)
for i,sym in enumerate(
    ['Si', 'Ti', 'Al', 'Fe', 'Cr', 'Mn', 'Mg', 'Ni', 'Co', 'Ca', 'Na', 'K', 'P', 'H', 'C', 'O']):
    index = core.chem.PERIODIC_ORDER.tolist().index(sym)
    elm[index] = mol_elm[i]
elm[core.chem.PERIODIC_ORDER.tolist().index('Zr')] += wtZrSiO4/183.31
elm[core.chem.PERIODIC_ORDER.tolist().index('Si')] += wtZrSiO4/183.31
elm[core.chem.PERIODIC_ORDER.tolist().index('O')]  += wtZrSiO4*4.0/183.31
n = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_conv_elm_to_moles(elm)
for i,x in enumerate(n):
    print ("{0:&lt;12.12s} {1:10.6f} {2:10.6f}".format(rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_name(i), x, mol_oxides[i] if i&lt;16 else 0))
if not rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_test_moles(n):
    print ('Output of intrinsic composition calculation fails tests for permissible values.')</code>
          </sec>
          <sec id="cell-27-nb-3" specific-use="notebook-content">
            <p>Modify the input composition to create - the most oxidized state
    (all ferric iron and sulfate) - or, the most reduced state (all
    ferrous iron and sulfide)</p>
          </sec>
          <sec id="cell-28-nb-3" specific-use="notebook-content">
  </sec>
          <sec id="speciate-the-solution-nb-3">
            <title>Speciate the solution</title>
          </sec>
          <sec id="cell-29-nb-3" specific-use="notebook-content">
            <p>Print equilibrium results</p>
          </sec>
          <sec id="cell-30-nb-3" specific-use="notebook-code">
            <code language="python">s = rMELTS_ZR.cy_Liquid_rMELTS_ZR_order_params(t, p, n)
print_species(n, s)</code>
          </sec>
          <sec id="cell-31-nb-3" specific-use="notebook-content">
  </sec>
          <sec id="save-revised-parameter-values-nb-3">
            <title>Save revised parameter values</title>
          </sec>
          <sec id="cell-32-nb-3" specific-use="notebook-code">
            <code language="python">param_values = rMELTS_ZR.cy_Liquid_rMELTS_ZR_get_param_values()
param_values</code>
          </sec>
          <sec id="cell-33-nb-3" specific-use="notebook-code">
            <code language="python">import pickle

with open('params.pickle', 'wb') as f:
    pickle.dump(param_values, f, pickle.HIGHEST_PROTOCOL)</code>
          </sec>
          <sec id="cell-34-nb-3" specific-use="notebook-code">
            <code language="python">import pickle

with open('params.pickle', 'rb') as f:
    params_stored = pickle.load(f)</code>
          </sec>
          <sec id="cell-35-nb-3" specific-use="notebook-code">
            <code language="python">params_stored</code>
          </sec>
        </sec>
      </sec>
    </body>
    <back>
</back>
  </sub-article>
  <sub-article article-type="notebook" id="nb-12-nb-4">
    <front-stub>
      <title-group>
        <article-title>2-Coding: MELTS liquid model with
zirconium</article-title>
      </title-group>
    </front-stub>
    <body>
      <sec id="cell-0-nb-4" specific-use="notebook-content">
        <sec id="coding-melts-liquid-model-with-zirconium-nb-4">
          <title>2-Coding: MELTS liquid model with zirconium</title>
          <p>
            <bold>Model formulation and code generation notebook.</bold>
            <bold>Run Endmembers-MELTS notebook first!</bold>
          </p>
          <p>Proposed associated solution model:</p>
          <table-wrap>
            <table>
              <colgroup>
                <col width="19%"/>
                <col width="14%"/>
                <col width="16%"/>
                <col width="16%"/>
                <col width="18%"/>
                <col width="18%"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="left">Components:</th>
                  <th align="left">Species:</th>
                  <th align="left">Reaction:</th>
                  <th align="left">Variable:</th>
                  <th align="left">Component:</th>
                  <th align="left">Species X:</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left">SiO2</td>
                  <td align="left">SiO2</td>
                  <td align="left"/>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_1]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_1]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">TiO2</td>
                  <td align="left">TiO2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_1]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_2]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_2]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Al2O3</td>
                  <td align="left">Al2O3</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_2]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_3]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>3</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_3]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>3</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Fe2O3</td>
                  <td align="left">Fe2O3</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_3]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>3</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_4]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>4</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_4]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>4</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">MgCr2O4</td>
                  <td align="left">MgCr2O4</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_4]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>4</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_5]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>5</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_5]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>5</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Fe2SiO4</td>
                  <td align="left">Fe2SiO4</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_5]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>5</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_6]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>6</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_6]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>6</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">MnSi1/2O2</td>
                  <td align="left">MnSi1/2O2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_6]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>6</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_7]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>7</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_7]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>7</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Mg2SiO4</td>
                  <td align="left">Mg2SiO4</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_7]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>7</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_8]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>8</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_8]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>8</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">NiSi1/2O2</td>
                  <td align="left">NiSi1/2O2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_8]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>8</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_9]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>9</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_9]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>9</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">CoSi1/2O2</td>
                  <td align="left">CoSi1/2O2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_9]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>9</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{10}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>10</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{10}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>10</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">CaSiO3</td>
                  <td align="left">CaSiO3</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{10}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>10</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{11}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>11</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{11}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>11</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Na2SiO3</td>
                  <td align="left">Na2SiO3</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{11}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>11</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{12}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>12</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{12}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>12</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">KAlSiO4</td>
                  <td align="left">KAlSiO4</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{12}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>12</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{13}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>13</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{13}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>13</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Ca3(PO4)2</td>
                  <td align="left">Ca3(PO4)2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{13}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>13</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{14}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>14</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{14}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>14</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">H2O</td>
                  <td align="left">H2O</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{14}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>14</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{15}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>15</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{15}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>15</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">CO2</td>
                  <td align="left">CO2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{15}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>15</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{16}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>16</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{16}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>16</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">ZrSiO4</td>
                  <td align="left">ZrSiO4</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{16}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>16</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{17}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>17</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{17}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>17</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left"/>
                  <td align="left">CaCO3</td>
                  <td align="left">CO2 + CaSiO3 = CaCO3 + SiO2</td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[s_1]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>s</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{18}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>18</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left"/>
                  <td align="left">Na4ZrSi2O8</td>
                  <td align="left">ZrSiO4 + 2Na2SiO3 = Na4ZrSi2O8 + SiO2</td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[s_2]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>s</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{19}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>19</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left"/>
                  <td align="left">K4ZrSi2O8</td>
                  <td align="left">ZrSiO4 + 4KAlSiO4 = K4ZrSi2O8 + 2Al2O3 +
          3SiO2</td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[s_3]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>s</mml:mi>
                            <mml:mn>3</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{20}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>20</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
        </sec>
        <sec id="cell-1-nb-4" specific-use="notebook-code">
          <code language="python">import pandas as pd
import numpy as np
import sympy as sym
sym.init_printing()
from thermoengine import core, coder
from thermoengine.model import Database
db = Database()
import warnings
warnings.filterwarnings("ignore", category=DeprecationWarning)
warnings.filterwarnings("ignore", category=FutureWarning)</code>
        </sec>
        <sec id="cell-2-nb-4" specific-use="notebook-content">
          <list list-type="bullet">
            <list-item>
              <p>Number of components = 17</p>
            </list-item>
            <list-item>
              <p>Number of species = 20</p>
            </list-item>
            <list-item>
              <p>Number of “ordering parameters” (i.e., dependent species) =
      3</p>
            </list-item>
          </list>
        </sec>
        <sec id="cell-3-nb-4" specific-use="notebook-code">
          <code language="python">nc = 17
nw = 20
ns = 3</code>
        </sec>
        <sec id="cell-4-nb-4" specific-use="notebook-content">
          <sec id="create-solution-model-nb-4">
            <title>Create solution model</title>
          </sec>
          <sec id="cell-5-nb-4" specific-use="notebook-code">
            <code language="python">model = coder.ComplexSolnModel(nc=nc, ns=ns, nw=nw)</code>
          </sec>
          <sec id="cell-6-nb-4" specific-use="notebook-content">
            <list list-type="bullet">
              <list-item>
                <p><italic>n</italic> is a vector of moles of solution
        components</p>
              </list-item>
              <list-item>
                <p><italic>nT</italic> is a sum of all <italic>n</italic></p>
              </list-item>
              <list-item>
                <p><italic>s</italic> is a vector of <italic>moles</italic> of
        dependemt species</p>
              </list-item>
            </list>
          </sec>
          <sec id="cell-7-nb-4" specific-use="notebook-code">
            <code language="python">n = model.n
nT = model.nT
s = model.s</code>
          </sec>
          <sec id="cell-8-nb-4" specific-use="notebook-content">
            <p>Set up ancillary compositional variables - <italic>X</italic> is
    a vector of <italic>moles</italic> of all species (components +
    dependent species in solution</p>
            <p>Note that the zeroth index of <italic>X</italic> is ignored</p>
          </sec>
          <sec id="cell-9-nb-4" specific-use="notebook-code">
            <code language="python">X = [sym.S.Zero]
for i in range(1,nw+1):
    X.append(sym.symbols('X_'+str(i)))</code>
          </sec>
          <sec id="cell-10-nb-4" specific-use="notebook-content">
            <p>Moles of elements are accumulated in the dictionary
    <italic>elm</italic>. See table above.</p>
          </sec>
          <sec id="cell-11-nb-4" specific-use="notebook-code">
            <code language="python">elm = {}</code>
          </sec>
          <sec id="cell-12-nb-4" specific-use="notebook-code">
            <code language="python">O_n = 2*n[0]+2*n[1]+3*n[2]+3*n[3]+4*n[4]+4*n[5]+2*n[6]+4*n[7]+2*n[8]+2*n[9]+3*n[10]+3*n[11]+4*n[12]+8*n[13]+n[14]+2*n[15]+4*n[16]
O_X = 2*X[1]+2*X[2]+3*X[3]+3*X[4]+4*X[5]+4*X[6]+2*X[7]+4*X[8]+2*X[9]+2*X[10]+3*X[11]+3*X[12]+4*X[13]+8*X[14]+X[15] \
    + 2*X[16]+4*X[17]+3*X[18]+8*X[19]+8*X[20]
eqn_O = O_n - O_X
elm[' O'] = O_n</code>
          </sec>
          <sec id="cell-13-nb-4" specific-use="notebook-code">
            <code language="python">Si_n = n[0]+n[5]+n[6]/2+n[7]+n[8]/2+n[9]/2+n[10]+n[11]+n[12]+n[16]
Si_X = X[1]+X[6]+X[7]/2+X[8]+X[9]/2+X[10]/2+X[11]+X[12]+X[13]+X[17]+2*X[19]+2*X[20]
eqn_Si = Si_n - Si_X
elm['Si'] = Si_n</code>
          </sec>
          <sec id="cell-14-nb-4" specific-use="notebook-code">
            <code language="python">Ti_n = n[1]
Ti_X = X[2]
eqn_Ti = Ti_n - Ti_X
elm['Ti'] = Ti_n</code>
          </sec>
          <sec id="cell-15-nb-4" specific-use="notebook-code">
            <code language="python">Al_n = 2*n[2] + n[12]
Al_X = 2*X[3] + X[13]
eqn_Al = Al_n - Al_X
elm['Al'] = Al_n</code>
          </sec>
          <sec id="cell-16-nb-4" specific-use="notebook-code">
            <code language="python">Fe_n = 2*n[3] + 2*n[5]
Fe_X = 2*X[4] + 2*X[6]
eqn_Fe = Fe_n - Fe_X
elm['Fe'] = Fe_n</code>
          </sec>
          <sec id="cell-17-nb-4" specific-use="notebook-code">
            <code language="python">Cr_n = 2*n[4]
Cr_X = 2*X[5]
eqn_Cr = Cr_n - Cr_X
elm['Cr'] = Cr_n</code>
          </sec>
          <sec id="cell-18-nb-4" specific-use="notebook-code">
            <code language="python">Mn_n = n[6]
Mn_X = X[7]
eqn_Mn = Mn_n - Mn_X
elm['Mn'] = Mn_n</code>
          </sec>
          <sec id="cell-19-nb-4" specific-use="notebook-code">
            <code language="python">Mg_n = 2*n[7]
Mg_X = 2*X[8]
eqn_Mg = Mg_n - Mg_X
elm['Mg'] = Mg_n</code>
          </sec>
          <sec id="cell-20-nb-4" specific-use="notebook-code">
            <code language="python">Ni_n = n[8]
Ni_X = X[9]
eqn_Ni = Ni_n - Ni_X
elm['Ni'] = Ni_n</code>
          </sec>
          <sec id="cell-21-nb-4" specific-use="notebook-code">
            <code language="python">Co_n = n[9]
Co_X = X[10]
eqn_Co = Co_n - Co_X
elm['Co'] = Co_n</code>
          </sec>
          <sec id="cell-22-nb-4" specific-use="notebook-code">
            <code language="python">Ca_n = n[10] + 3*n[13]
Ca_X = X[11] + 3*X[14] + X[18]
eqn_Ca = Ca_n - Ca_X
elm['Ca'] = Ca_n</code>
          </sec>
          <sec id="cell-23-nb-4" specific-use="notebook-code">
            <code language="python">Na_n = 2*n[11]
Na_X = 2*X[12] + 4*X[19]
eqn_Na = Na_n - Na_X
elm['Na'] = Na_n</code>
          </sec>
          <sec id="cell-24-nb-4" specific-use="notebook-code">
            <code language="python">K_n = n[12]
K_X = X[13] + 4*X[20]
eqn_K = K_n - K_X
elm[' K'] = K_n</code>
          </sec>
          <sec id="cell-25-nb-4" specific-use="notebook-code">
            <code language="python">P_n = 2*n[13]
P_X = 2*X[14]
eqn_P = P_n - P_X
elm[' P'] = P_n</code>
          </sec>
          <sec id="cell-26-nb-4" specific-use="notebook-code">
            <code language="python">H_n = 2*n[14]
H_X = 2*X[15]
eqn_H = H_n - H_X
elm[' H'] = H_n</code>
          </sec>
          <sec id="cell-27-nb-4" specific-use="notebook-code">
            <code language="python">C_n = n[15]
C_X = X[16] + X[18]
eqn_C = C_n - C_X
elm[' C'] = C_n</code>
          </sec>
          <sec id="cell-28-nb-4" specific-use="notebook-code">
            <code language="python">Zr_n = n[16]
Zr_X = X[17] + X[19] + X[20] 
eqn_Zr = Zr_n - Zr_X
elm['Zr'] = Zr_n</code>
          </sec>
          <sec id="cell-29-nb-4" specific-use="notebook-content">
            <p>Solve this system for species mole numbers</p>
          </sec>
          <sec id="cell-30-nb-4" specific-use="notebook-code">
            <code language="python">system = [eqn_O, eqn_Si, eqn_Ti, eqn_Al, eqn_Fe, eqn_Cr, eqn_Mn, eqn_Mg, eqn_Ni, eqn_Co, eqn_Ca, eqn_Na, eqn_K, eqn_P, eqn_H, eqn_C, eqn_Zr,
         s[0]-X[18], s[1]-X[19], s[2]-X[20]]
X_soln = list(sym.linsolve(system, X[1:nw+1]).args[0])</code>
          </sec>
          <sec id="cell-31-nb-4" specific-use="notebook-content">
            <p>Compute the total number of moles of all species,
    <italic>XT</italic>. Note rhat this quantity is not necessarily
    equal to <italic>nT</italic>.</p>
          </sec>
          <sec id="cell-32-nb-4" specific-use="notebook-code">
            <code language="python">XT = sym.S.Zero
for i,x in enumerate(X_soln):
    print ('X[',i+1,'] = ', end='') 
    sym.pprint (x)
    XT += x
XT</code>
          </sec>
          <sec id="cell-33-nb-4" specific-use="notebook-content">
            <p>Retrieve model symbols for the temperature, pressure, and
    standard state chemical potentials - <inline-formula><alternatives><tex-math><![CDATA[T]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula>
    is temperature in <inline-formula><alternatives><tex-math><![CDATA[K]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>K</mml:mi></mml:math></alternatives></inline-formula>
    - <inline-formula><alternatives><tex-math><![CDATA[P]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>P</mml:mi></mml:math></alternatives></inline-formula>
    is pressure in <inline-formula><alternatives><tex-math><![CDATA[bars]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
    - <inline-formula><alternatives><tex-math><![CDATA[\mu^o]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msup><mml:mi>μ</mml:mi><mml:mi>o</mml:mi></mml:msup></mml:math></alternatives></inline-formula>
    in Joules</p>
          </sec>
          <sec id="cell-34-nb-4" specific-use="notebook-code">
            <code language="python">T = model.get_symbol_for_t()
P = model.get_symbol_for_p()
mu = model.mu</code>
          </sec>
          <sec id="cell-35-nb-4" specific-use="notebook-content">
            <p>Initialize lists to store model parameter names, units and
    symbols</p>
          </sec>
          <sec id="cell-36-nb-4" specific-use="notebook-code">
            <code language="python">params = []
units = []
symparams = []</code>
          </sec>
          <sec id="cell-37-nb-4" specific-use="notebook-content">
            <p>
              <bold>Known values of parameters that are not allowed to change
    (rhyolite-MELTS, 1.1, old water saturation model, new carbon dioxide
    model)</bold>
            </p>
          </sec>
          <sec id="cell-38-nb-4" specific-use="notebook-code">
            <code language="python">include_excess_parameters = False
if not include_excess_parameters:
    param_subst_l = []
known_w_values = [
                        26266.7, #   0 W(TiO2      ,SiO2      ) 0
                       -39120.0, #   1 W(Al2O3     ,SiO2      )
                         8110.3, #   2 W(Fe2O3     ,SiO2      )
                        27886.3, #   3 W(MgCr2O4   ,SiO2      )
                        23660.9, #   4 W(Fe2SiO4   ,SiO2      )
                        18393.9, #   5 W(MnSi0.5O2 ,SiO2      )
                         3421.0, #   6 W(Mg2SiO4   ,SiO2      )
                        25197.4, #   7 W(NiSi0.5O2 ,SiO2      )
                        14802.8, #   8 W(CoSi0.5O2 ,SiO2      )
                         -863.7, #   9 W(CaSiO3    ,SiO2      )
                       -99039.0, #  10 W(Na2SiO3   ,SiO2      ) 10
                       -33921.7, #  11 W(KAlSiO4   ,SiO2      )
                        61891.6, #  12 W(Ca3(PO4)2 ,SiO2      )
                        30967.3, #  13 W(H2O       ,SiO2      )
                            0.0, #  14 W(CO2       ,SiO2      )
     6.3281206517489e+01*1000.0, #  15 W(CaCO3     ,SiO2      )
                       -29449.8, #  16 W(Al2O3     ,TiO2      )
                       -84756.9, #  17 W(Fe2O3     ,TiO2      )
                       -72303.4, #  18 W(MgCr2O4   ,TiO2      )
                         5209.1, #  19 W(Fe2SiO4   ,TiO2      )
                       -16123.5, #  20 W(MnSi0.5O2 ,TiO2      ) 20
                        -4178.3, #  21 W(Mg2SiO4   ,TiO2      )
                         3614.8, #  22 W(NiSi0.5O2 ,TiO2      )
                        -1640.0, #  23 W(CoSi0.5O2 ,TiO2      )
                       -35372.5, #  24 W(CaSiO3    ,TiO2      )
                       -15415.6, #  25 W(Na2SiO3   ,TiO2      )
                       -48094.6, #  26 W(KAlSiO4   ,TiO2      )
                        25938.8, #  27 W(Ca3(PO4)2 ,TiO2      )
                        81879.1, #  28 W(H2O       ,TiO2      )
    -1.9265668647972e+01*1000.0, #  29 W(CO2       ,TiO2      )
    -7.9202707514741e+01*1000.0, #  30 W(CaCO3     ,TiO2      ) 30
                       -17089.4, #  31 W(Fe2O3     ,Al2O3     )
                       -31770.3, #  32 W(MgCr2O4   ,Al2O3     )
                       -30509.0, #  33 W(Fe2SiO4   ,Al2O3     )
                       -53874.9, #  34 W(MnSi0.5O2 ,Al2O3     )
                       -32880.3, #  35 W(Mg2SiO4   ,Al2O3     )
                         2985.2, #  36 W(NiSi0.5O2 ,Al2O3     )
                        -2677.4, #  37 W(CoSi0.5O2 ,Al2O3     )
                       -57917.9, #  38 7(CaSiO3    ,Al2O3     )
                      -130785.0, #  39 W(Na2SiO3   ,Al2O3     )
                       -25859.2, #  40 W(KAlSiO4   ,Al2O3     ) 40
                        52220.8, #  41 W(Ca3(PO4)2 ,Al2O3     )
                       -16098.1, #  42 W(H2O       ,Al2O3     )
                            0.0, #  43 W(CO2       ,Al2O3     )
     4.6716121152125e+01*1000.0, #  44 W(CaCO3     ,Al2O3     )
                        21605.9, #  45 W(MgCr2O4   ,Fe2O3     )
                      -179064.9, #  46 W(Fe2SiO4   ,Fe2O3     )
                         3907.9, #  47 W(MnSi0.5O2 ,Fe2O3     )
                       -71518.6, #  48 W(Mg2SiO4   ,Fe2O3     )
                          408.7, #  49 W(NiSi0.5O2 ,Fe2O3     )
                         -223.7, #  50 W(CoSi0.5O2 ,Fe2O3     ) 50
                        12076.6, #  51 W(CaSiO3    ,Fe2O3     )
                      -149662.2, #  52 W(Na2SiO3   ,Fe2O3     )
                        57555.9, #  53 W(KAlSiO4   ,Fe2O3     )
                        -4213.9, #  54 W(Ca3(PO4)2 ,Fe2O3     )
                        31405.5, #  55 W(H2O       ,Fe2O3     )
    -3.1868817914962e+00*1000.0, #  56 W(CO2       ,Fe2O3     )
     6.5508729974818e+01*1000.0, #  57 W(CaCO3     ,Fe2O3     )
                       -82971.8, #  58 W(Fe2SiO4   ,MgCr2O4   )
                          182.4, #  59 W(MnSi0.5O2 ,MgCr2O4   )
                        46049.2, #  60 W(Mg2SiO4   ,MgCr2O4   ) 60
                         -266.0, #  61 W(NiSi0.5O2 ,MgCr2O4   )
                         -384.0, #  62 W(CoSi0.5O2 ,MgCr2O4   )
                        30704.7, #  63 W(CaSiO3    ,MgCr2O4   )
                       113646.0, #  64 W(Na2SiO3   ,MgCr2O4   )
                        75709.1, #  65 W(KAlSiO4   ,MgCr2O4   )
                         5341.8, #  66 W(Ca3(PO4)2 ,MgCr2O4   )
                            0.0, #  67 W(H2O       ,MgCr2O4   )
                            0.0, #  68 W(CO2       ,MgCr2O4   )
                            0.0, #  69 W(CaCO3     ,MgCr2O4   )
                        -6823.9, #  70 W(MnSi0.5O2 ,Fe2SiO4   ) 70
                       -37256.7, #  71 W(Mg2SiO4   ,Fe2SiO4   )
                       -17019.8, #  72 W(NiSi0.5O2 ,Fe2SiO4   )
                       -11746.3, #  73 W(CoSi0.5O2 ,Fe2SiO4   )
                       -12970.8, #  74 W(CaSiO3    ,Fe2SiO4   )
                       -90533.8, #  75 W(Na2SiO3   ,Fe2SiO4   )
                        23649.4, #  76 W(KAlSiO4   ,Fe2SiO4   )
                        87410.3, #  77 W(Ca3(PO4)2 ,Fe2SiO4   )
                        28873.6, #  78 W(H2O       ,Fe2SiO4   )
    -3.2464545980393e+01*1000.0, #  79 W(CO2       ,Fe2SiO4   )
    -7.2996815311226e+01*1000.0, #  80 W(CaCO3     ,Fe2SiO4   ) 80
                       -13040.1, #  81 W(Mg2SiO4   ,MnSi0.5O2 )
                          785.8, #  82 W(NiSi0.5O2 ,MnSi0.5O2 )
                          -50.6, #  83 W(CoSi0.5O2 ,MnSi0.5O2 )
                         2934.6, #  84 W(CaSiO3    ,MnSi0.5O2 )
                       -15780.8, #  85 W(Na2SiO3   ,MnSi0.5O2 )
                        23727.4, #  86 W(KAlSiO4   ,MnSi0.5O2 )
                            0.0, #  87 W(Ca3(PO4)2 ,MnSi0.5O2 )
                            0.0, #  88 W(H2O       ,MnSi0.5O2 )
                            0.0, #  89 W(CO2       ,MnSi0.5O2 )
                            0.0, #  90 W(CaCO3     ,MnSi0.5O2 ) 90
                       -21175.5, #  91 W(NiSi0.5O2 ,Mg2SiO4   )
                       -14994.9, #  92 W(CoSi0.5O2 ,Mg2SiO4   )
                       -31731.9, #  93 W(CaSiO3    ,Mg2SiO4   )
                       -41876.9, #  94 W(Na2SiO3   ,Mg2SiO4   )
                        22323.1, #  95 W(KAlSiO4   ,Mg2SiO4   )
                       -23208.8, #  96 W(Ca3(PO4)2 ,Mg2SiO4   )
                        35633.7, #  97 W(H2O       ,Mg2SiO4   )
    -4.0853595138597e+01*1000.0, #  98 W(CO2       ,Mg2SiO4   )
    -2.4872562549739e+01*1000.0, #  99 W(CaCO3     ,Mg2SiO4   )
                          258.9, # 100 W(CoSi0.5O2 ,NiSi0.5O2 ) 100
                         7027.5, # 101 W(CaSiO3    ,NiSi0.5O2 )
                        -3647.8, # 102 W(Na2SiO3   ,NiSi0.5O2 )
                         4261.4, # 103 W(KAlSiO4   ,NiSi0.5O2 )
                            0.0, # 104 W(Ca3(PO4)2 ,NiSi0.5O2 )
                            0.0, # 105 W(H2O       ,NiSi0.5O2 )
                            0.0, # 106 W(CO2       ,NiSi0.5O2 )
                            0.0, # 107 W(CaCO3     ,NiSi0.5O2 )
                       -26685.7, # 108 W(CaSiO3    ,CoSi0.5O2 )
                          531.2, # 109 W(Na2SiO3   ,CoSi0.5O2 )
                          265.7, # 110 W(KAlSiO4   ,CoSi0.5O2 ) 110
                            0.0, # 111 W(Ca3(PO4)2 ,CoSi0.5O2 )
                            0.0, # 112 W(H2O       ,CoSi0.5O2 )
                            0.0, # 113 W(CO2       ,CoSi0.5O2 )
                            0.0, # 114 W(CaCO3     ,CoSi0.5O2 )
                       -13247.1, # 115 W(Na2SiO3   ,CaSiO3    )
                        17111.1, # 116 W(KAlSiO4   ,CaSiO3    )
                        37070.3, # 117 W(Ca3(PO4)2 ,CaSiO3    )
                        20374.6, # 118 W(H2O       ,CaSiO3    )
     3.0012481472120e+01*1000.0, # 119 W(CO2       ,CaSiO3    )
     3.7534127781795e+01*1000.0, # 120 W(CaCO3     ,CaSiO3    ) 120
                         6522.8, # 121 W(KAlSiO4   ,Na2SiO3   )
                        15571.9, # 122 W(Ca3(PO4)2 ,Na2SiO3   )
                       -96937.6, # 123 W(H2O       ,Na2SiO3   )
                            0.0, # 124 W(CO2       ,Na2SiO3   )
    -3.1101129932991e+02*1000.0, # 126 W(CaCO3     ,Na2SiO3   )
                        17100.6, # 127 W(Ca3(PO4)2 ,KAlSiO4   )
                        10374.2, # 128 W(H2O       ,KAlSiO4   )
                            0.0, # 129 W(CO2       ,KAlSiO4   )
    -2.7864967599360e+01*1000.0, # 130 W(CaCO3     ,KAlSiO4   )
                        43451.3, # 131 W(H2O       ,Ca3(PO4)2 ) 130
    -3.4728165916175e+00*1000.0, # 132 W(CO2       ,Ca3(PO4)2 )
     2.0119124588637e+00*1000.0, # 133 W(CaCO3     ,Ca3(PO4)2 )
     2.3255499914663e+01*1000.0, # 134 W(CO2       ,H2O       )
     7.8729683594722e+00*1000.0, # 135 W(CaCO3     ,H2O       )
                            0.0, # 180 W(CaCO3     ,CO2       )
]</code>
          </sec>
          <sec id="cell-39-nb-4" specific-use="notebook-content">
  </sec>
          <sec id="define-extensive-standard-state-contribution-to-solution-properties-nb-4">
            <title>Define extensive standard state contribution to solution
    properties</title>
          </sec>
          <sec id="cell-40-nb-4" specific-use="notebook-code">
            <code language="python">G_ss = sym.S.Zero
for i,x in enumerate(X_soln):
    if i &lt; nc:
        G_ss += x*mu[i]
    else:
        h = sym.symbols('hd_'+str(i+1))
        params.append('hd_'+str(i+1))
        units.append('J')
        symparams.append(h)
        ss = sym.symbols('sd_'+str(i+1))
        symparams.append(ss)
        params.append('sd_'+str(i+1))
        units.append('J/K')
        v = sym.symbols('vd_'+str(i+1))
        params.append('vd_'+str(i+1))
        units.append('J/bar')
        symparams.append(v)
        G_ss += x*(h-T*ss+(P-sym.S.One)*v)
h = sym.symbols('hZrSiO4')
params.append('hZrSiO4')
units.append('J')
symparams.append(h)
ss = sym.symbols('sZrSiO4')
symparams.append(ss)
params.append('sZrSiO4')
units.append('J/K')
v = sym.symbols('vZrSiO4')
params.append('vZrSiO4')
units.append('J/bar')
symparams.append(v)
G_ss += X_soln[16]*(h-T*ss+(P-sym.S.One)*v)
G_ss</code>
          </sec>
          <sec id="cell-41-nb-4" specific-use="notebook-content">
  </sec>
          <sec id="define-extensive-configurational-gibbs-free-energy-nb-4">
            <title>Define extensive configurational Gibbs free energy</title>
            <p><italic>R</italic> is the gas constant.
    Note that species mole fractions are computed using
    <italic>XT</italic> rather than <italic>nT</italic></p>
          </sec>
          <sec id="cell-42-nb-4" specific-use="notebook-code">
            <code language="python">eps = np.finfo(float).eps</code>
          </sec>
          <sec id="cell-43-nb-4" specific-use="notebook-code">
            <code language="python">R = sym.symbols('R')
S_config = sym.S.Zero
for x in X_soln:
    S_config += x*sym.log(x/XT+eps)
S_config += X_soln[14]*sym.log(X_soln[14]/XT) + (XT-X_soln[14])*sym.log(sym.S.One-X_soln[14]/XT) # extra entropy from hydroxyl term
S_config *= -R
G_config = -T*S_config</code>
          </sec>
          <sec id="cell-44-nb-4" specific-use="notebook-content">
  </sec>
          <sec id="non-configurational-extensive-molar-gibbs-free-energy-nb-4">
            <title>Non-configurational extensive molar Gibbs free energy</title>
            <p>These are the regular solution terms. Zirconium species are
    assumed to not contribute to the excess Gibbs free energy.
    The flag, <italic>include_excess_parameters</italic> is used to
    perform direct substitution of excess solution parameters, removing
    them from the list of “calibration” parameters in order to save code
    generation and compilation time.</p>
          </sec>
          <sec id="cell-45-nb-4" specific-use="notebook-code">
            <code language="python">G_ex = sym.S.Zero
for i,x in enumerate(X_soln):
    istr = '{0:02d}'.format(i+1)
    for j,y in enumerate(X_soln):
        jstr = '{0:02d}'.format(j+1)
        if j &gt; i and i&lt;nc-1 and j&lt;nc-1: #skip the last component, ZrSiO4
            w = sym.symbols('Wc'+istr+'c'+jstr)
            if include_excess_parameters:
                params.append('Wc'+istr+'c'+jstr)
                units.append('J')
                symparams.append(w)
            else:
                param_subst_l.append(w)
            G_ex += x*y*w
    if i&lt;nc-1:
        w = sym.symbols('Wc'+istr+'s1')
        if include_excess_parameters:
            params.append('Wc'+istr+'s1')
            units.append('J')
            symparams.append(w)
        else:
            param_subst_l.append(w)
        G_ex += x*s[0]*w
G_ex /= XT</code>
          </sec>
          <sec id="cell-46-nb-4" specific-use="notebook-code">
            <code language="python">print(params)
print(units)
print(symparams)</code>
          </sec>
          <sec id="cell-47-nb-4" specific-use="notebook-content">
  </sec>
          <sec id="define-the-extensive-gibbs-free-energy-of-solution-nb-4">
            <title>Define the extensive Gibbs free energy of solution</title>
          </sec>
          <sec id="cell-48-nb-4" specific-use="notebook-code">
            <code language="python">G = G_ss + G_config + G_ex</code>
          </sec>
          <sec id="cell-49-nb-4" specific-use="notebook-code">
            <code language="python">ll = list(zip(param_subst_l,known_w_values))</code>
          </sec>
          <sec id="cell-50-nb-4" specific-use="notebook-code">
            <code language="python">if not include_excess_parameters:
    G = G.subs(list(zip(param_subst_l,known_w_values)))</code>
          </sec>
          <sec id="cell-51-nb-4" specific-use="notebook-content">
  </sec>
          <sec id="find-the-condition-of-homogeneous-equilibrium-fracpartial-hat-gpartial-s_i-0-nb-4">
            <title>Find the condition of homogeneous equilibrium:
    <inline-formula><alternatives><tex-math><![CDATA[\frac{{\partial \hat G}}{{\partial {s_i}}} = 0]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mover><mml:mi>G</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></title>
          </sec>
          <sec id="cell-52-nb-4" specific-use="notebook-code">
            <code language="python">dgds = []
for x in s:
    dgds.append(G.diff(x))</code>
          </sec>
          <sec id="cell-53-nb-4" specific-use="notebook-content">
  </sec>
          <sec id="identify-bounds-on-the-ordering-parameter-nb-4">
            <title>Identify bounds on the ordering parameter</title>
            <p>Construct a set of inequality constraints on the lower bound of
    species mole fractions. If all the mole fractions are guaranteed to
    be positive, then the sum of all those moles, <italic>XT</italic>,
    is positive. Note that the upper bound on <italic>Xi</italic> is
    guaranteed to be feasible, because in use that quantity is always
    smaller than <italic>XT</italic>.</p>
          </sec>
          <sec id="cell-54-nb-4" specific-use="notebook-code">
            <code language="python">ineq_l = [
    0 &lt;= X_soln[ 0], 
    0 &lt;= X_soln[ 1], 
    0 &lt;= X_soln[ 2], 
    0 &lt;= X_soln[ 3], 
    0 &lt;= X_soln[ 4], 
    0 &lt;= X_soln[ 5], 
    0 &lt;= X_soln[ 6], 
    0 &lt;= X_soln[ 7], 
    0 &lt;= X_soln[ 8], 
    0 &lt;= X_soln[ 9], 
    0 &lt;= X_soln[10], 
    0 &lt;= X_soln[11], 
    0 &lt;= X_soln[12], 
    0 &lt;= X_soln[13], 
    0 &lt;= X_soln[14], 
    0 &lt;= X_soln[15], 
    0 &lt;= X_soln[16], 
    0 &lt;= X_soln[17], 
    0 &lt;= X_soln[18], 
    0 &lt;= X_soln[19]
]
insym_l = [x for x in n]
out = sym.reduce_inequalities(inequalities=ineq_l, symbols=insym_l)
out</code>
          </sec>
          <sec id="cell-55-nb-4" specific-use="notebook-content">
  </sec>
          <sec id="identity-initial-guess-values-of-the-order-parameters-nb-4">
            <title>Identity initial guess values of the order parameters</title>
          </sec>
          <sec id="cell-56-nb-4" specific-use="notebook-code">
            <code language="python">initial_guess_l = []
initial_guess_l.append( sym.Min(n[10]/6,n[15]/2) )
initial_guess_l.append( sym.Min(n[11]/2,n[16]/4) )
initial_guess_l.append( sym.Min(n[12]/4,n[16]/4) )</code>
          </sec>
          <sec id="cell-57-nb-4" specific-use="notebook-code">
            <code language="python">initial_guess_l</code>
          </sec>
          <sec id="cell-58-nb-4" specific-use="notebook-content">
  </sec>
          <sec id="identify-null-values-of-ordering-parameters-nb-4">
            <title>Identify null values of ordering parameters</title>
          </sec>
          <sec id="cell-59-nb-4" specific-use="notebook-code">
            <code language="python">nullValues = [sym.S.Zero, sym.S.Zero, sym.S.Zero]</code>
          </sec>
          <sec id="cell-60-nb-4" specific-use="notebook-content">
  </sec>
          <sec id="add-the-gibbs-free-energy-of-solution-to-the-model-nb-4">
            <title>Add the Gibbs free energy of solution to the model</title>
          </sec>
          <sec id="cell-61-nb-4" specific-use="notebook-code">
            <code language="python">model.add_expression_to_model(G, list(zip(params, units, symparams)), ordering_functions=(dgds,s,initial_guess_l,out,nullValues))</code>
          </sec>
          <sec id="cell-62-nb-4" specific-use="notebook-content">
  </sec>
          <sec id="name-the-module-that-will-hold-the-liquid-model-nb-4">
            <title>Name the module that will hold the liquid model</title>
          </sec>
          <sec id="cell-63-nb-4" specific-use="notebook-code">
            <code language="python">model.module = "rMELTS_ZR"</code>
          </sec>
          <sec id="cell-64-nb-4" specific-use="notebook-content">
  </sec>
          <sec id="composition-conversion-and-bound-constraints-nb-4">
            <title>Composition conversion and bound constraints</title>
            <p>Develop expressions that convert solution composition expressed
    as moles of elements into moles of components</p>
          </sec>
          <sec id="cell-65-nb-4" specific-use="notebook-code">
            <code language="python">ineq_l = []
insym_l = []
for key,value in elm.items():
    y = sym.symbols(key)
    ineq_l.append(value - y)
    insym_l.append(y)
sol = sym.solve(ineq_l, tuple(n))
for i,x in enumerate(n):
    print ('n['+str(i+1)+'] = ', end='')
    print(sol[x])</code>
          </sec>
          <sec id="cell-66-nb-4" specific-use="notebook-content">
            <p>Construct a formula string for the model</p>
          </sec>
          <sec id="cell-67-nb-4" specific-use="notebook-code">
            <code language="python">repl_s = {}
for key in elm.keys():
    if key[0:1] != ' ':
        repl_s[key] = '[' + key + ']'
for key in elm.keys():
    if key[0:1] == ' ':
        repl_s[key[1:]] = '[' + key[1] + ']'
formula_string = ''
for x,y in repl_s.items():
    formula_string += x + y
formula_string</code>
          </sec>
          <sec id="cell-68-nb-4" specific-use="notebook-content">
            <p>Compute a list of conversion strings to cast element abundances
    to component mole numbers</p>
          </sec>
          <sec id="cell-69-nb-4" specific-use="notebook-code">
            <code language="python">def process_str(z):
    while True:
        l1 = z.find('[[')
        if l1 == -1:
            return z
        else:
            l2 = l1+3
            z = z[:l2] + z[l2+1:]
            z = z[:l1] + z[l1+1:]</code>
          </sec>
          <sec id="cell-70-nb-4" specific-use="notebook-code">
            <code language="python">conversion_string = []
for i,zz in enumerate(sol):
    z = str(sol[zz]).replace(' ', '')
    for x,y in repl_s.items():
        z = z.replace(x,y)
    z = process_str(z)
    conversion_string.append('['+str(i)+']='+z)
conversion_string</code>
          </sec>
          <sec id="cell-71-nb-4" specific-use="notebook-content">
            <p>Compute a test string to insure a feasible solution; these
    constraints insure that the moles of each element is greater than
    zero</p>
          </sec>
          <sec id="cell-72-nb-4" specific-use="notebook-code">
            <code language="python">test_string = []
for x,y in elm.items():
    z = str(y).replace('/2 +',']/2+')
    z = z.replace(' +', '] +')
    z = z.replace('n', '[')
    z = z.replace(' ', '')
    z += '] &gt;= 0.0'
    z = z.replace('/2]',']/2')
    for i in range(1,nc+1):
        z = z.replace('['+str(i)+']', '['+str(i-1)+']')
    test_string.append(z)</code>
          </sec>
          <sec id="cell-73-nb-4" specific-use="notebook-content">
  </sec>
          <sec id="add-these-bound-constraints-to-the-model-nb-4">
            <title>Add these bound constraints to the model</title>
          </sec>
          <sec id="cell-74-nb-4" specific-use="notebook-code">
            <code language="python">model.formula_string = formula_string
model.conversion_string = conversion_string
model.test_string = test_string</code>
          </sec>
          <sec id="cell-75-nb-4" specific-use="notebook-content">
  </sec>
          <sec id="assign-parameter-values-nb-4">
            <title>Assign parameter values</title>
          </sec>
          <sec id="cell-76-nb-4" specific-use="notebook-code">
            <code language="python">depen_species_values = [
    0.0, 0.0, 0.0, # H, S, V, CaCO3
    0.0, 0.0, 0.0, # H, S, V, Na4ZrSi2O8
    0.0, 0.0, 0.0, # H, S, V, K4ZrSi2O8
    0.0, 0.0, 0.0  # H. S. V, ZrSiO4
]</code>
          </sec>
          <sec id="cell-77-nb-4" specific-use="notebook-content">
            <p>Parameter values are consistent with rhyolite-MELTS version
    1.1</p>
          </sec>
          <sec id="cell-78-nb-4" specific-use="notebook-code">
            <code language="python">if include_excess_parameters:
    w_values = [
                        26266.7, #   0 W(TiO2      ,SiO2      ) 0
                       -39120.0, #   1 W(Al2O3     ,SiO2      )
                         8110.3, #   2 W(Fe2O3     ,SiO2      )
                        27886.3, #   3 W(MgCr2O4   ,SiO2      )
                        23660.9, #   4 W(Fe2SiO4   ,SiO2      )
                        18393.9, #   5 W(MnSi0.5O2 ,SiO2      )
                         3421.0, #   6 W(Mg2SiO4   ,SiO2      )
                        25197.4, #   7 W(NiSi0.5O2 ,SiO2      )
                        14802.8, #   8 W(CoSi0.5O2 ,SiO2      )
                         -863.7, #   9 W(CaSiO3    ,SiO2      )
                       -99039.0, #  10 W(Na2SiO3   ,SiO2      ) 10
                       -33921.7, #  11 W(KAlSiO4   ,SiO2      )
                        61891.6, #  12 W(Ca3(PO4)2 ,SiO2      )
                        30967.3, #  13 W(H2O       ,SiO2      )
                            0.0, #  14 W(CO2       ,SiO2      )
     6.3281206517489e+01*1000.0, #  15 W(CaCO3     ,SiO2      )
                       -29449.8, #  16 W(Al2O3     ,TiO2      )
                       -84756.9, #  17 W(Fe2O3     ,TiO2      )
                       -72303.4, #  18 W(MgCr2O4   ,TiO2      )
                         5209.1, #  19 W(Fe2SiO4   ,TiO2      )
                       -16123.5, #  20 W(MnSi0.5O2 ,TiO2      ) 20
                        -4178.3, #  21 W(Mg2SiO4   ,TiO2      )
                         3614.8, #  22 W(NiSi0.5O2 ,TiO2      )
                        -1640.0, #  23 W(CoSi0.5O2 ,TiO2      )
                       -35372.5, #  24 W(CaSiO3    ,TiO2      )
                       -15415.6, #  25 W(Na2SiO3   ,TiO2      )
                       -48094.6, #  26 W(KAlSiO4   ,TiO2      )
                        25938.8, #  27 W(Ca3(PO4)2 ,TiO2      )
                        81879.1, #  28 W(H2O       ,TiO2      )
    -1.9265668647972e+01*1000.0, #  29 W(CO2       ,TiO2      )
    -7.9202707514741e+01*1000.0, #  30 W(CaCO3     ,TiO2      ) 30
                       -17089.4, #  31 W(Fe2O3     ,Al2O3     )
                       -31770.3, #  32 W(MgCr2O4   ,Al2O3     )
                       -30509.0, #  33 W(Fe2SiO4   ,Al2O3     )
                       -53874.9, #  34 W(MnSi0.5O2 ,Al2O3     )
                       -32880.3, #  35 W(Mg2SiO4   ,Al2O3     )
                         2985.2, #  36 W(NiSi0.5O2 ,Al2O3     )
                        -2677.4, #  37 W(CoSi0.5O2 ,Al2O3     )
                       -57917.9, #  38 7(CaSiO3    ,Al2O3     )
                      -130785.0, #  39 W(Na2SiO3   ,Al2O3     )
                       -25859.2, #  40 W(KAlSiO4   ,Al2O3     ) 40
                        52220.8, #  41 W(Ca3(PO4)2 ,Al2O3     )
                       -16098.1, #  42 W(H2O       ,Al2O3     )
                            0.0, #  43 W(CO2       ,Al2O3     )
     4.6716121152125e+01*1000.0, #  44 W(CaCO3     ,Al2O3     )
                        21605.9, #  45 W(MgCr2O4   ,Fe2O3     )
                      -179064.9, #  46 W(Fe2SiO4   ,Fe2O3     )
                         3907.9, #  47 W(MnSi0.5O2 ,Fe2O3     )
                       -71518.6, #  48 W(Mg2SiO4   ,Fe2O3     )
                          408.7, #  49 W(NiSi0.5O2 ,Fe2O3     )
                         -223.7, #  50 W(CoSi0.5O2 ,Fe2O3     ) 50
                        12076.6, #  51 W(CaSiO3    ,Fe2O3     )
                      -149662.2, #  52 W(Na2SiO3   ,Fe2O3     )
                        57555.9, #  53 W(KAlSiO4   ,Fe2O3     )
                        -4213.9, #  54 W(Ca3(PO4)2 ,Fe2O3     )
                        31405.5, #  55 W(H2O       ,Fe2O3     )
    -3.1868817914962e+00*1000.0, #  56 W(CO2       ,Fe2O3     )
     6.5508729974818e+01*1000.0, #  57 W(CaCO3     ,Fe2O3     )
                       -82971.8, #  58 W(Fe2SiO4   ,MgCr2O4   )
                          182.4, #  59 W(MnSi0.5O2 ,MgCr2O4   )
                        46049.2, #  60 W(Mg2SiO4   ,MgCr2O4   ) 60
                         -266.0, #  61 W(NiSi0.5O2 ,MgCr2O4   )
                         -384.0, #  62 W(CoSi0.5O2 ,MgCr2O4   )
                        30704.7, #  63 W(CaSiO3    ,MgCr2O4   )
                       113646.0, #  64 W(Na2SiO3   ,MgCr2O4   )
                        75709.1, #  65 W(KAlSiO4   ,MgCr2O4   )
                         5341.8, #  66 W(Ca3(PO4)2 ,MgCr2O4   )
                            0.0, #  67 W(H2O       ,MgCr2O4   )
                            0.0, #  68 W(CO2       ,MgCr2O4   )
                            0.0, #  69 W(CaCO3     ,MgCr2O4   )
                        -6823.9, #  70 W(MnSi0.5O2 ,Fe2SiO4   ) 70
                       -37256.7, #  71 W(Mg2SiO4   ,Fe2SiO4   )
                       -17019.8, #  72 W(NiSi0.5O2 ,Fe2SiO4   )
                       -11746.3, #  73 W(CoSi0.5O2 ,Fe2SiO4   )
                       -12970.8, #  74 W(CaSiO3    ,Fe2SiO4   )
                       -90533.8, #  75 W(Na2SiO3   ,Fe2SiO4   )
                        23649.4, #  76 W(KAlSiO4   ,Fe2SiO4   )
                        87410.3, #  77 W(Ca3(PO4)2 ,Fe2SiO4   )
                        28873.6, #  78 W(H2O       ,Fe2SiO4   )
    -3.2464545980393e+01*1000.0, #  79 W(CO2       ,Fe2SiO4   )
    -7.2996815311226e+01*1000.0, #  80 W(CaCO3     ,Fe2SiO4   ) 80
                       -13040.1, #  81 W(Mg2SiO4   ,MnSi0.5O2 )
                          785.8, #  82 W(NiSi0.5O2 ,MnSi0.5O2 )
                          -50.6, #  83 W(CoSi0.5O2 ,MnSi0.5O2 )
                         2934.6, #  84 W(CaSiO3    ,MnSi0.5O2 )
                       -15780.8, #  85 W(Na2SiO3   ,MnSi0.5O2 )
                        23727.4, #  86 W(KAlSiO4   ,MnSi0.5O2 )
                            0.0, #  87 W(Ca3(PO4)2 ,MnSi0.5O2 )
                            0.0, #  88 W(H2O       ,MnSi0.5O2 )
                            0.0, #  89 W(CO2       ,MnSi0.5O2 )
                            0.0, #  90 W(CaCO3     ,MnSi0.5O2 ) 90
                       -21175.5, #  91 W(NiSi0.5O2 ,Mg2SiO4   )
                       -14994.9, #  92 W(CoSi0.5O2 ,Mg2SiO4   )
                       -31731.9, #  93 W(CaSiO3    ,Mg2SiO4   )
                       -41876.9, #  94 W(Na2SiO3   ,Mg2SiO4   )
                        22323.1, #  95 W(KAlSiO4   ,Mg2SiO4   )
                       -23208.8, #  96 W(Ca3(PO4)2 ,Mg2SiO4   )
                        35633.7, #  97 W(H2O       ,Mg2SiO4   )
    -4.0853595138597e+01*1000.0, #  98 W(CO2       ,Mg2SiO4   )
    -2.4872562549739e+01*1000.0, #  99 W(CaCO3     ,Mg2SiO4   )
                          258.9, # 100 W(CoSi0.5O2 ,NiSi0.5O2 ) 100
                         7027.5, # 101 W(CaSiO3    ,NiSi0.5O2 )
                        -3647.8, # 102 W(Na2SiO3   ,NiSi0.5O2 )
                         4261.4, # 103 W(KAlSiO4   ,NiSi0.5O2 )
                            0.0, # 104 W(Ca3(PO4)2 ,NiSi0.5O2 )
                            0.0, # 105 W(H2O       ,NiSi0.5O2 )
                            0.0, # 106 W(CO2       ,NiSi0.5O2 )
                            0.0, # 107 W(CaCO3     ,NiSi0.5O2 )
                       -26685.7, # 108 W(CaSiO3    ,CoSi0.5O2 )
                          531.2, # 109 W(Na2SiO3   ,CoSi0.5O2 )
                          265.7, # 110 W(KAlSiO4   ,CoSi0.5O2 ) 110
                            0.0, # 111 W(Ca3(PO4)2 ,CoSi0.5O2 )
                            0.0, # 112 W(H2O       ,CoSi0.5O2 )
                            0.0, # 113 W(CO2       ,CoSi0.5O2 )
                            0.0, # 114 W(CaCO3     ,CoSi0.5O2 )
                       -13247.1, # 115 W(Na2SiO3   ,CaSiO3    )
                        17111.1, # 116 W(KAlSiO4   ,CaSiO3    )
                        37070.3, # 117 W(Ca3(PO4)2 ,CaSiO3    )
                        20374.6, # 118 W(H2O       ,CaSiO3    )
     3.0012481472120e+01*1000.0, # 119 W(CO2       ,CaSiO3    )
     3.7534127781795e+01*1000.0, # 120 W(CaCO3     ,CaSiO3    ) 120
                         6522.8, # 121 W(KAlSiO4   ,Na2SiO3   )
                        15571.9, # 122 W(Ca3(PO4)2 ,Na2SiO3   )
                       -96937.6, # 123 W(H2O       ,Na2SiO3   )
                            0.0, # 124 W(CO2       ,Na2SiO3   )
    -3.1101129932991e+02*1000.0, # 126 W(CaCO3     ,Na2SiO3   )
                        17100.6, # 127 W(Ca3(PO4)2 ,KAlSiO4   )
                        10374.2, # 128 W(H2O       ,KAlSiO4   )
                            0.0, # 129 W(CO2       ,KAlSiO4   )
    -2.7864967599360e+01*1000.0, # 130 W(CaCO3     ,KAlSiO4   )
                        43451.3, # 131 W(H2O       ,Ca3(PO4)2 ) 130
    -3.4728165916175e+00*1000.0, # 132 W(CO2       ,Ca3(PO4)2 )
     2.0119124588637e+00*1000.0, # 133 W(CaCO3     ,Ca3(PO4)2 )
     2.3255499914663e+01*1000.0, # 134 W(CO2       ,H2O       )
     7.8729683594722e+00*1000.0, # 135 W(CaCO3     ,H2O       )
                            0.0, # 180 W(CaCO3     ,CO2       )
    ]
else:
    w_values = []</code>
          </sec>
          <sec id="cell-79-nb-4" specific-use="notebook-code">
            <code language="python">paramValues = dict(zip(params, depen_species_values+w_values))</code>
          </sec>
          <sec id="cell-80-nb-4" specific-use="notebook-code">
            <code language="python">paramValues['T_r'] = 298.15
paramValues['P_r'] =   1.0</code>
          </sec>
          <sec id="cell-81-nb-4" specific-use="notebook-content">
  </sec>
          <sec id="generate-code-load-and-compile-the-module-nb-4">
            <title>Generate code, load and compile the module</title>
          </sec>
          <sec id="cell-82-nb-4" specific-use="notebook-code">
            <code language="python">model_working_dir = "working"
!mkdir -p {model_working_dir}
%cd {model_working_dir}
model_type = "calib"</code>
          </sec>
          <sec id="cell-83-nb-4" specific-use="notebook-code">
            <code language="python">model.verbose = True
model.de_minimis = True
model.create_code_module(phase="Liquid", 
                         params=paramValues, 
                         endmembers=[
                             'SiO2_rMELTS_ZR',
                             'TiO2_rMELTS_ZR',
                             'Al2O3_rMELTS_ZR',
                             'Fe2O3_rMELTS_ZR',
                             'MgCr2O4_rMELTS_ZR',
                             'Fe2SiO4_rMELTS_ZR',
                             'MnSi1d2O2_rMELTS_ZR',
                             'Mg2SiO4_rMELTS_ZR',
                             'NiSi1d2O2_rMELTS_ZR',
                             'CoSi1d2O2_rMELTS_ZR',
                             'CaSiO3_rMELTS_ZR',
                             'Na2SiO3_rMELTS_ZR',
                             'KAlSiO4_rMELTS_ZR',
                             'Ca3P2O8_rMELTS_ZR',
                             'H2O_rMELTS_ZR',
                             'CO2_rMELTS_ZR',
                             'ZrSiO4_rMELTS_ZR'
                         ], 
                         prefix="cy", 
                         module_type=model_type, 
                         silent=False, 
                         add_code_to_access_order_paramater=True,
                         minimal_deriv_set=True)</code>
          </sec>
          <sec id="cell-84-nb-4" specific-use="notebook-code">
            <code language="python">import rMELTS_ZR
%cd ..</code>
          </sec>
          <sec id="cell-85-nb-4" specific-use="notebook-content">
  </sec>
          <sec id="test-identifier-routines-nb-4">
            <title>Test identifier routines</title>
          </sec>
          <sec id="cell-86-nb-4" specific-use="notebook-code">
            <code language="python">print(rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_identifier())
print(rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_name())</code>
          </sec>
        </sec>
      </sec>
    </body>
    <back>
</back>
  </sub-article>
  <sub-article article-type="notebook" id="nb-15-nb-5">
    <front-stub>
      <title-group>
        <article-title>1-Theory: Adding Zr to the MELTS liquid
model</article-title>
      </title-group>
    </front-stub>
    <body>
      <sec id="cell-0-nb-5" specific-use="notebook-content">
        <sec id="theory-adding-zr-to-the-melts-liquid-model-nb-5">
          <title>1-Theory: Adding Zr to the MELTS liquid model</title>
        </sec>
        <sec id="cell-1-nb-5" specific-use="notebook-code">
          <code language="python">%%html
&lt;style&gt;
  table {margin-left: 0 !important;}
&lt;/style&gt;</code>
        </sec>
        <sec id="cell-2-nb-5" specific-use="notebook-content">
          <sec id="regular-solution-model-in-c-components-nb-5">
            <title>Regular solution model in
    <italic>c</italic>-components</title>
            <p><bold>Ghiorso MS, Carmichael ISE, Rivers ML, Sack RO (1983) The
    Gibbs free energy of mixing of natural silicate liquids; an expanded
    regular solution approximation for the calculation of magmatic
    intensive variables. Contributions to Mineralogy and Petrology 84,
    107-145</bold>
    and
    <bold>Ghiorso MS, Sack RO (1995) Chemical Mass Transfer in Magmatic
    Processes IV. A revised and internally consistent thermodynamic
    model for the interpolation and extrapolation of liquid-solid
    equilibria in magmatic systems at elevated temperatures and
    pressures. Contrib Mineral Petrology 119, 197-212</bold>
    and
    <bold>Gualda, G.A.R., Ghiorso, M.S., Lemons, R.V., Carley, T.L.
    (2012) Rhyolite-MELTS: A modified calibration of MELTS optimized for
    silica-rich, fluid-bearing magmatic systems. Journal of Petrology,
    53, 875-890</bold></p>
            <table-wrap>
              <table>
                <colgroup>
                  <col width="38%"/>
                  <col width="28%"/>
                  <col width="34%"/>
                </colgroup>
                <thead>
                  <tr>
                    <th align="left">Components:</th>
                    <th align="left">Species:</th>
                    <th align="left">Component:</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="left">SiO2</td>
                    <td align="left">SiO2</td>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_1]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                  </tr>
                  <tr>
                    <td align="left">TiO2</td>
                    <td align="left">TiO2</td>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_2]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                  </tr>
                  <tr>
                    <td align="left">Al2O3</td>
                    <td align="left">Al2O3</td>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_3]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>3</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                  </tr>
                  <tr>
                    <td align="left">Fe2O3</td>
                    <td align="left">Fe2O3</td>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_4]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>4</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                  </tr>
                  <tr>
                    <td align="left">MgCr2O4</td>
                    <td align="left">MgCr2O4</td>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_5]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>5</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                  </tr>
                  <tr>
                    <td align="left">Fe2SiO4</td>
                    <td align="left">Fe2SiO4</td>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_6]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>6</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                  </tr>
                  <tr>
                    <td align="left">MnSi1/2O2</td>
                    <td align="left">MnSi1/2O2</td>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_7]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>7</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                  </tr>
                  <tr>
                    <td align="left">Mg2SiO4</td>
                    <td align="left">Mg2SiO4</td>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_8]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>8</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                  </tr>
                  <tr>
                    <td align="left">NiSi1/2O2</td>
                    <td align="left">NiSi1/2O2</td>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_9]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>9</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                  </tr>
                  <tr>
                    <td align="left">CoSi1/2O2</td>
                    <td align="left">CoSi1/2O2</td>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_{10}]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>10</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                  </tr>
                  <tr>
                    <td align="left">CaSiO3</td>
                    <td align="left">CaSiO3</td>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_{11}]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>11</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                  </tr>
                  <tr>
                    <td align="left">Na2SiO3</td>
                    <td align="left">Na2SiO3</td>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_{12}]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>12</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                  </tr>
                  <tr>
                    <td align="left">KAlSiO4</td>
                    <td align="left">KAlSiO4</td>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_{13}]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>13</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                  </tr>
                  <tr>
                    <td align="left">Ca3(PO4)2</td>
                    <td align="left">Ca3(PO4)2</td>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_{14}]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>14</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                  </tr>
                  <tr>
                    <td align="left">H2O</td>
                    <td align="left">H2O</td>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_{15}]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>15</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                  </tr>
                </tbody>
              </table>
            </table-wrap>
            <p>The Gibbs free energy of a <italic>c</italic>-component
    multicomponent regular solution is given by
    (<inline-formula><alternatives><tex-math><![CDATA[n_T = \sum_{i=1}^c n_i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>c</mml:mi></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>):</p>
            <p>
              <inline-formula>
                <alternatives>
                  <tex-math><![CDATA[G = \sum_{i=1}^c n_i \mu_i^o + R T \sum_{i=1}^c n_i \log \left( \frac{n_i}{n_T} \right) + \sum_{i=1}^c \sum_{j=i+1}^c W_{i,j} \frac{n_i n_j}{n_T}]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                    <mml:mrow>
                      <mml:mi>G</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>c</mml:mi>
                      </mml:msubsup>
                      <mml:msub>
                        <mml:mi>n</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:msubsup>
                        <mml:mi>μ</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:mi>o</mml:mi>
                      </mml:msubsup>
                      <mml:mo>+</mml:mo>
                      <mml:mi>R</mml:mi>
                      <mml:mi>T</mml:mi>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>c</mml:mi>
                      </mml:msubsup>
                      <mml:msub>
                        <mml:mi>n</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:mo>log</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mfrac>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msub>
                        </mml:mfrac>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mo>+</mml:mo>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>c</mml:mi>
                      </mml:msubsup>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mi>i</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>c</mml:mi>
                      </mml:msubsup>
                      <mml:msub>
                        <mml:mi>W</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mi>j</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:msub>
                          <mml:mi>n</mml:mi>
                          <mml:mi>T</mml:mi>
                        </mml:msub>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </inline-formula>
            </p>
            <p>and the chemical potential (the derivative of the above
    expressio) is:</p>
            <p>
              <inline-formula>
                <alternatives>
                  <tex-math><![CDATA[\mu_k = \mu_k^o + R T \log \left( \frac{n_k}{n_T} \right) + \sum_{i=1}^c W_{i,k} \frac{n_i}{n_T} - \sum_{i=1}^c \sum_{j=i+1}^c W_{i,j} \frac{n_i n_j}{n_T^2}]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>μ</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:msubsup>
                        <mml:mi>μ</mml:mi>
                        <mml:mi>k</mml:mi>
                        <mml:mi>o</mml:mi>
                      </mml:msubsup>
                      <mml:mo>+</mml:mo>
                      <mml:mi>R</mml:mi>
                      <mml:mi>T</mml:mi>
                      <mml:mo>log</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mfrac>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msub>
                        </mml:mfrac>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mo>+</mml:mo>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>c</mml:mi>
                      </mml:msubsup>
                      <mml:msub>
                        <mml:mi>W</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mfrac>
                        <mml:msub>
                          <mml:mi>n</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:msub>
                          <mml:mi>n</mml:mi>
                          <mml:mi>T</mml:mi>
                        </mml:msub>
                      </mml:mfrac>
                      <mml:mo>−</mml:mo>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>c</mml:mi>
                      </mml:msubsup>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mi>i</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>c</mml:mi>
                      </mml:msubsup>
                      <mml:msub>
                        <mml:mi>W</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mi>j</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:msubsup>
                          <mml:mi>n</mml:mi>
                          <mml:mi>T</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msubsup>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </inline-formula>
            </p>
          </sec>
          <sec id="cell-3-nb-5" specific-use="notebook-content">
            <sec id="add-water-to-this-formulation-nb-5">
              <title>Add water to this formulation</title>
              <p>The MELTS liquid model makes the assumption that H2O enters the
      melt completely dissociating to an OH species. That means that for
      every water molecule, two hydroxyl molecules are produced. The
      configurational entropy must account for this extra species, so we
      must modify the expression for the Gibbs Free Energy to acount for
      this.</p>
              <p>If <inline-formula><alternatives><tex-math><![CDATA[n_w]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
      is the number of moles of H2O in the liquid
      (<inline-formula><alternatives><tex-math><![CDATA[n_w]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
      is one of <italic>c</italic>-components):</p>
              <p>
                <inline-formula>
                  <alternatives>
                    <tex-math><![CDATA[G = \sum_{i=1}^c n_i \mu_i^o + R T \sum_{i=1}^c n_i \log \left( \frac{n_i}{n_T} \right) + n_w R T \log \left( \frac{n_w}{n_T} \right) + \left( n_T - n_w \right) R T \log \left( \frac{n_T - n_w}{n_T} \right) + \sum_{i=1}^c \sum_{j=i+1}^c W_{i,j} \frac{n_i n_j}{n_T}]]></tex-math>
                    <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:msubsup>
                          <mml:mo>∑</mml:mo>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mi>c</mml:mi>
                        </mml:msubsup>
                        <mml:msub>
                          <mml:mi>n</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:msubsup>
                          <mml:mi>μ</mml:mi>
                          <mml:mi>i</mml:mi>
                          <mml:mi>o</mml:mi>
                        </mml:msubsup>
                        <mml:mo>+</mml:mo>
                        <mml:mi>R</mml:mi>
                        <mml:mi>T</mml:mi>
                        <mml:msubsup>
                          <mml:mo>∑</mml:mo>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mi>c</mml:mi>
                        </mml:msubsup>
                        <mml:msub>
                          <mml:mi>n</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:mo>log</mml:mo>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">(</mml:mo>
                          <mml:mfrac>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:msub>
                          </mml:mfrac>
                          <mml:mo stretchy="true" form="postfix">)</mml:mo>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:msub>
                          <mml:mi>n</mml:mi>
                          <mml:mi>w</mml:mi>
                        </mml:msub>
                        <mml:mi>R</mml:mi>
                        <mml:mi>T</mml:mi>
                        <mml:mo>log</mml:mo>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">(</mml:mo>
                          <mml:mfrac>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mi>w</mml:mi>
                            </mml:msub>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:msub>
                          </mml:mfrac>
                          <mml:mo stretchy="true" form="postfix">)</mml:mo>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">(</mml:mo>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msub>
                          <mml:mo>−</mml:mo>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mi>w</mml:mi>
                          </mml:msub>
                          <mml:mo stretchy="true" form="postfix">)</mml:mo>
                        </mml:mrow>
                        <mml:mi>R</mml:mi>
                        <mml:mi>T</mml:mi>
                        <mml:mo>log</mml:mo>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">(</mml:mo>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>n</mml:mi>
                                <mml:mi>T</mml:mi>
                              </mml:msub>
                              <mml:mo>−</mml:mo>
                              <mml:msub>
                                <mml:mi>n</mml:mi>
                                <mml:mi>w</mml:mi>
                              </mml:msub>
                            </mml:mrow>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:msub>
                          </mml:mfrac>
                          <mml:mo stretchy="true" form="postfix">)</mml:mo>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:msubsup>
                          <mml:mo>∑</mml:mo>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mi>c</mml:mi>
                        </mml:msubsup>
                        <mml:msubsup>
                          <mml:mo>∑</mml:mo>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mi>i</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mi>c</mml:mi>
                        </mml:msubsup>
                        <mml:msub>
                          <mml:mi>W</mml:mi>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mi>j</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msub>
                        </mml:mfrac>
                      </mml:mrow>
                    </mml:math>
                  </alternatives>
                </inline-formula>
              </p>
              <p>and the chemical potential (the derivative of the above
      expressio) is:</p>
              <p>
                <inline-formula>
                  <alternatives>
                    <tex-math><![CDATA[\mu_k = \mu_k^o + R T \log \left( \frac{n_k \left( n_T - n_w \right)}{n_T^2} \right) + \sum_{i=1}^c W_{i,k} \frac{n_i}{n_T} - \sum_{i=1}^c \sum_{j=i+1}^c W_{i,j} \frac{n_i n_j}{n_T^2}]]></tex-math>
                    <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>μ</mml:mi>
                          <mml:mi>k</mml:mi>
                        </mml:msub>
                        <mml:mo>=</mml:mo>
                        <mml:msubsup>
                          <mml:mi>μ</mml:mi>
                          <mml:mi>k</mml:mi>
                          <mml:mi>o</mml:mi>
                        </mml:msubsup>
                        <mml:mo>+</mml:mo>
                        <mml:mi>R</mml:mi>
                        <mml:mi>T</mml:mi>
                        <mml:mo>log</mml:mo>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">(</mml:mo>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>n</mml:mi>
                                <mml:mi>k</mml:mi>
                              </mml:msub>
                              <mml:mrow>
                                <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                <mml:msub>
                                  <mml:mi>n</mml:mi>
                                  <mml:mi>T</mml:mi>
                                </mml:msub>
                                <mml:mo>−</mml:mo>
                                <mml:msub>
                                  <mml:mi>n</mml:mi>
                                  <mml:mi>w</mml:mi>
                                </mml:msub>
                                <mml:mo stretchy="true" form="postfix">)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:msubsup>
                              <mml:mi>n</mml:mi>
                              <mml:mi>T</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msubsup>
                          </mml:mfrac>
                          <mml:mo stretchy="true" form="postfix">)</mml:mo>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:msubsup>
                          <mml:mo>∑</mml:mo>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mi>c</mml:mi>
                        </mml:msubsup>
                        <mml:msub>
                          <mml:mi>W</mml:mi>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>k</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mfrac>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msub>
                        </mml:mfrac>
                        <mml:mo>−</mml:mo>
                        <mml:msubsup>
                          <mml:mo>∑</mml:mo>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mi>c</mml:mi>
                        </mml:msubsup>
                        <mml:msubsup>
                          <mml:mo>∑</mml:mo>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mi>i</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mi>c</mml:mi>
                        </mml:msubsup>
                        <mml:msub>
                          <mml:mi>W</mml:mi>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mi>j</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:msubsup>
                            <mml:mi>n</mml:mi>
                            <mml:mi>T</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msubsup>
                        </mml:mfrac>
                      </mml:mrow>
                    </mml:math>
                  </alternatives>
                </inline-formula>
              </p>
              <p>
                <inline-formula>
                  <alternatives>
                    <tex-math><![CDATA[\mu_w = \mu_w^o + R T \log \left( \frac{n_w}{n_T} \right)^2 + \sum_{i=1}^c W_{i,w} \frac{n_i}{n_T} - \sum_{i=1}^c \sum_{j=i+1}^c W_{i,j} \frac{n_i n_j}{n_T^2}]]></tex-math>
                    <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>μ</mml:mi>
                          <mml:mi>w</mml:mi>
                        </mml:msub>
                        <mml:mo>=</mml:mo>
                        <mml:msubsup>
                          <mml:mi>μ</mml:mi>
                          <mml:mi>w</mml:mi>
                          <mml:mi>o</mml:mi>
                        </mml:msubsup>
                        <mml:mo>+</mml:mo>
                        <mml:mi>R</mml:mi>
                        <mml:mi>T</mml:mi>
                        <mml:mo>log</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo stretchy="true" form="prefix">(</mml:mo>
                            <mml:mfrac>
                              <mml:msub>
                                <mml:mi>n</mml:mi>
                                <mml:mi>w</mml:mi>
                              </mml:msub>
                              <mml:msub>
                                <mml:mi>n</mml:mi>
                                <mml:mi>T</mml:mi>
                              </mml:msub>
                            </mml:mfrac>
                            <mml:mo stretchy="true" form="postfix">)</mml:mo>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                        <mml:mo>+</mml:mo>
                        <mml:msubsup>
                          <mml:mo>∑</mml:mo>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mi>c</mml:mi>
                        </mml:msubsup>
                        <mml:msub>
                          <mml:mi>W</mml:mi>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>w</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mfrac>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msub>
                        </mml:mfrac>
                        <mml:mo>−</mml:mo>
                        <mml:msubsup>
                          <mml:mo>∑</mml:mo>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mi>c</mml:mi>
                        </mml:msubsup>
                        <mml:msubsup>
                          <mml:mo>∑</mml:mo>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mi>i</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mi>c</mml:mi>
                        </mml:msubsup>
                        <mml:msub>
                          <mml:mi>W</mml:mi>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mi>j</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:msubsup>
                            <mml:mi>n</mml:mi>
                            <mml:mi>T</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msubsup>
                        </mml:mfrac>
                      </mml:mrow>
                    </mml:math>
                  </alternatives>
                </inline-formula>
              </p>
            </sec>
            <sec id="cell-4-nb-5" specific-use="notebook-content">
    </sec>
          </sec>
          <sec id="now-add-co2-to-the-model-associated-solution-nb-5">
            <title>Now add CO2 to the model (associated solution)</title>
            <p>
              <bold>Ghiorso, M.S., Gualda, G.A.R. (2015) An H2O-CO2 mixed fluid
    saturation model compatible with rhyolite-MELTS. Contributions to
    Mineralogy and Petrology, doi:10.1007/s00410-015-1141-8</bold>
            </p>
            <p>To do this we need to make an associated solution, using both CO2
    as a new component and CaCO3 as a new dependent species.</p>
            <table-wrap>
              <table>
                <colgroup>
                  <col width="24%"/>
                  <col width="17%"/>
                  <col width="20%"/>
                  <col width="22%"/>
                  <col width="17%"/>
                </colgroup>
                <thead>
                  <tr>
                    <th align="left">Components:</th>
                    <th align="left">Species:</th>
                    <th align="left">Reaction:</th>
                    <th align="left">Component:</th>
                    <th align="left">Species:</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="left">SiO2</td>
                    <td align="left">SiO2</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_1]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_1]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_1]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            + <inline-formula><alternatives><tex-math><![CDATA[y_{17}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>17</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">TiO2</td>
                    <td align="left">TiO2</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_2]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">Al2O3</td>
                    <td align="left">Al2O3</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_3]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>3</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_3]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_3]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">Fe2O3</td>
                    <td align="left">Fe2O3</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_4]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>4</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_4]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_4]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">MgCr2O4</td>
                    <td align="left">MgCr2O4</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_5]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>5</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_5]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_5]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">Fe2SiO4</td>
                    <td align="left">Fe2SiO4</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_6]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>6</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_6]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>6</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_6]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>6</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">MnSi1/2O2</td>
                    <td align="left">MnSi1/2O2</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_7]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>7</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_7]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>7</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_7]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>7</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">Mg2SiO4</td>
                    <td align="left">Mg2SiO4</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_8]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>8</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_8]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_8]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">NiSi1/2O2</td>
                    <td align="left">NiSi1/2O2</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_9]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>9</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_9]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>9</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_9]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>9</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">CoSi1/2O2</td>
                    <td align="left">CoSi1/2O2</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_{10}]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>10</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_{10}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_{10}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">CaSiO3</td>
                    <td align="left">CaSiO3</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_{11}]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>11</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_{11}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_{11}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            - <inline-formula><alternatives><tex-math><![CDATA[y_{17}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>17</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">Na2SiO3</td>
                    <td align="left">Na2SiO3</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_{12}]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>12</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_{12}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_{12}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">KAlSiO4</td>
                    <td align="left">KAlSiO4</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_{13}]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>13</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_{13}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>13</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_{13}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>13</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">Ca3(PO4)2</td>
                    <td align="left">Ca3(PO4)2</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_{14}]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>14</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_{14}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>14</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_{14}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>14</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">H2O</td>
                    <td align="left">H2O</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_{15}]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>15</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_{15}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>15</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_{15}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>15</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">CO2</td>
                    <td align="left">CO2</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_{16}]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>16</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_{16}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>16</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_{16}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>16</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            - <inline-formula><alternatives><tex-math><![CDATA[y_{17}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>17</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left"/>
                    <td align="left">CaCO3</td>
                    <td align="left">CO2 + CaSiO3 = CaCO3 + SiO2</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[y_{17}]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>y</mml:mi>
                              <mml:mn>17</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                  </tr>
                </tbody>
              </table>
            </table-wrap>
            <p>Note that <inline-formula><alternatives><tex-math><![CDATA[n_T = \sum_{i=1}^c n_i = y_T = \sum_{i=1}^s y_i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>c</mml:mi></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula></p>
            <p>
              <inline-formula>
                <alternatives>
                  <tex-math><![CDATA[G = \sum_{i=1}^{s} y_i \mu_i^o + R T \sum_{i=1}^{s} y_i \log \left( \frac{y_i}{y_T} \right) + y_w R T \log \left( \frac{y_w}{y_T} \right) + \left( y_T - y_w \right) R T \log \left( \frac{y_T - y_w}{y_T} \right) + \sum_{i=1}^{s} \sum_{j=i+1}^{s} W_{i,j} \frac{y_i y_j}{y_T}]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                    <mml:mrow>
                      <mml:mi>G</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:msubsup>
                      <mml:msub>
                        <mml:mi>y</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:msubsup>
                        <mml:mi>μ</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:mi>o</mml:mi>
                      </mml:msubsup>
                      <mml:mo>+</mml:mo>
                      <mml:mi>R</mml:mi>
                      <mml:mi>T</mml:mi>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:msubsup>
                      <mml:msub>
                        <mml:mi>y</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:mo>log</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mfrac>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msub>
                        </mml:mfrac>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mo>+</mml:mo>
                      <mml:msub>
                        <mml:mi>y</mml:mi>
                        <mml:mi>w</mml:mi>
                      </mml:msub>
                      <mml:mi>R</mml:mi>
                      <mml:mi>T</mml:mi>
                      <mml:mo>log</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mfrac>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>w</mml:mi>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msub>
                        </mml:mfrac>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mo>+</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mi>T</mml:mi>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mi>w</mml:mi>
                        </mml:msub>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mi>R</mml:mi>
                      <mml:mi>T</mml:mi>
                      <mml:mo>log</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>y</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mi>y</mml:mi>
                              <mml:mi>w</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msub>
                        </mml:mfrac>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mo>+</mml:mo>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:msubsup>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mi>i</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:msubsup>
                      <mml:msub>
                        <mml:mi>W</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>j</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mi>T</mml:mi>
                        </mml:msub>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </inline-formula>
            </p>
            <p>and the chemical potential (the derivative of the above
    expressio) is:</p>
            <p>
              <inline-formula>
                <alternatives>
                  <tex-math><![CDATA[\mu_k = \mu_k^o + R T \log \left( \frac{y_k \left( y_T - y_w \right)}{y_T^2} \right) + \sum_{i=1}^s W_{i,k} \frac{y_i}{y_T} - \sum_{i=1}^s \sum_{j=i+1}^s W_{i,j} \frac{y_i y_j}{y_T^2}]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>μ</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:msubsup>
                        <mml:mi>μ</mml:mi>
                        <mml:mi>k</mml:mi>
                        <mml:mi>o</mml:mi>
                      </mml:msubsup>
                      <mml:mo>+</mml:mo>
                      <mml:mi>R</mml:mi>
                      <mml:mi>T</mml:mi>
                      <mml:mo>log</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>y</mml:mi>
                              <mml:mi>k</mml:mi>
                            </mml:msub>
                            <mml:mrow>
                              <mml:mo stretchy="true" form="prefix">(</mml:mo>
                              <mml:msub>
                                <mml:mi>y</mml:mi>
                                <mml:mi>T</mml:mi>
                              </mml:msub>
                              <mml:mo>−</mml:mo>
                              <mml:msub>
                                <mml:mi>y</mml:mi>
                                <mml:mi>w</mml:mi>
                              </mml:msub>
                              <mml:mo stretchy="true" form="postfix">)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:msubsup>
                            <mml:mi>y</mml:mi>
                            <mml:mi>T</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msubsup>
                        </mml:mfrac>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mo>+</mml:mo>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:msubsup>
                      <mml:msub>
                        <mml:mi>W</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mfrac>
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mi>T</mml:mi>
                        </mml:msub>
                      </mml:mfrac>
                      <mml:mo>−</mml:mo>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:msubsup>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mi>i</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:msubsup>
                      <mml:msub>
                        <mml:mi>W</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>j</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:msubsup>
                          <mml:mi>y</mml:mi>
                          <mml:mi>T</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msubsup>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </inline-formula>
            </p>
            <p>
              <inline-formula>
                <alternatives>
                  <tex-math><![CDATA[\mu_w = \mu_w^o + R T \log \left( \frac{y_w}{y_T} \right)^2 + \sum_{i=1}^s W_{i,w} \frac{y_i}{y_T} - \sum_{i=1}^s \sum_{j=i+1}^s W_{i,j} \frac{y_i y_j}{y_T^2}]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>μ</mml:mi>
                        <mml:mi>w</mml:mi>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:msubsup>
                        <mml:mi>μ</mml:mi>
                        <mml:mi>w</mml:mi>
                        <mml:mi>o</mml:mi>
                      </mml:msubsup>
                      <mml:mo>+</mml:mo>
                      <mml:mi>R</mml:mi>
                      <mml:mi>T</mml:mi>
                      <mml:mo>log</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">(</mml:mo>
                          <mml:mfrac>
                            <mml:msub>
                              <mml:mi>y</mml:mi>
                              <mml:mi>w</mml:mi>
                            </mml:msub>
                            <mml:msub>
                              <mml:mi>y</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:msub>
                          </mml:mfrac>
                          <mml:mo stretchy="true" form="postfix">)</mml:mo>
                        </mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:msup>
                      <mml:mo>+</mml:mo>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:msubsup>
                      <mml:msub>
                        <mml:mi>W</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>w</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mfrac>
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mi>T</mml:mi>
                        </mml:msub>
                      </mml:mfrac>
                      <mml:mo>−</mml:mo>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:msubsup>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mi>i</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:msubsup>
                      <mml:msub>
                        <mml:mi>W</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>j</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:msubsup>
                          <mml:mi>y</mml:mi>
                          <mml:mi>T</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msubsup>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </inline-formula>
            </p>
            <p>
              <inline-formula>
                <alternatives>
                  <tex-math><![CDATA[\mu_{CO_2} = \mu_{CO_2}^o + R T \log \left( \frac{y_{CO_2} \left( y_T - y_w \right)}{y_T^2} \right) + \sum_{i=1}^s W_{i,{CO_2}} \frac{y_i}{y_T} - \sum_{i=1}^s \sum_{j=i+1}^s W_{i,j} \frac{y_i y_j}{y_T^2}]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>μ</mml:mi>
                        <mml:mrow>
                          <mml:mi>C</mml:mi>
                          <mml:msub>
                            <mml:mi>O</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:msubsup>
                        <mml:mi>μ</mml:mi>
                        <mml:mrow>
                          <mml:mi>C</mml:mi>
                          <mml:msub>
                            <mml:mi>O</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mi>o</mml:mi>
                      </mml:msubsup>
                      <mml:mo>+</mml:mo>
                      <mml:mi>R</mml:mi>
                      <mml:mi>T</mml:mi>
                      <mml:mo>log</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>y</mml:mi>
                              <mml:mrow>
                                <mml:mi>C</mml:mi>
                                <mml:msub>
                                  <mml:mi>O</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mrow>
                              <mml:mo stretchy="true" form="prefix">(</mml:mo>
                              <mml:msub>
                                <mml:mi>y</mml:mi>
                                <mml:mi>T</mml:mi>
                              </mml:msub>
                              <mml:mo>−</mml:mo>
                              <mml:msub>
                                <mml:mi>y</mml:mi>
                                <mml:mi>w</mml:mi>
                              </mml:msub>
                              <mml:mo stretchy="true" form="postfix">)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:msubsup>
                            <mml:mi>y</mml:mi>
                            <mml:mi>T</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msubsup>
                        </mml:mfrac>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mo>+</mml:mo>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:msubsup>
                      <mml:msub>
                        <mml:mi>W</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mrow>
                            <mml:mi>C</mml:mi>
                            <mml:msub>
                              <mml:mi>O</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mfrac>
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mi>T</mml:mi>
                        </mml:msub>
                      </mml:mfrac>
                      <mml:mo>−</mml:mo>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:msubsup>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mi>i</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:msubsup>
                      <mml:msub>
                        <mml:mi>W</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>j</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:msubsup>
                          <mml:mi>y</mml:mi>
                          <mml:mi>T</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msubsup>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </inline-formula>
            </p>
            <p>The species mole numbers, <inline-formula><alternatives><tex-math><![CDATA[y_i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>,
    must be computed from the component moles,
    <inline-formula><alternatives><tex-math><![CDATA[n_i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>,
    in conjunction with a condition for homogeneous equilibrium between
    CO2 and CaCO3.</p>
          </sec>
          <sec id="cell-5-nb-5" specific-use="notebook-content">
  </sec>
          <sec id="addition-of-zr-to-the-model-nb-5">
            <title>Addition of Zr to the model</title>
            <p>We posit an associated solution formulation with two
    alaki-zirconate species (after <bold>Watson EB, 1979, Zircon
    Saturation in Felsic Liquids: Experimental Results and Applications
    to Trace Element Geochemistry. Contributions to Mineralogy and
    Petrology, 70, 407-419</bold>):</p>
            <list list-type="bullet">
              <list-item>
                <p>Na4ZrSi2O8
        </p>
              </list-item>
              <list-item>
                <p>K4ZrSi2O8</p>
              </list-item>
            </list>
            <table-wrap>
              <table>
                <colgroup>
                  <col width="23%"/>
                  <col width="17%"/>
                  <col width="19%"/>
                  <col width="21%"/>
                  <col width="21%"/>
                </colgroup>
                <thead>
                  <tr>
                    <th align="left">Components:</th>
                    <th align="left">Species:</th>
                    <th align="left">Reaction:</th>
                    <th align="left">Component:</th>
                    <th align="left">Species X:</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="left">SiO2</td>
                    <td align="left">SiO2</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_1]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_1]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_1]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            + <inline-formula><alternatives><tex-math><![CDATA[y_{18}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>18</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            + <inline-formula><alternatives><tex-math><![CDATA[y_{19}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>19</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            + 3 <inline-formula><alternatives><tex-math><![CDATA[y_{20}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>20</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">TiO2</td>
                    <td align="left">TiO2</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_2]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">Al2O3</td>
                    <td align="left">Al2O3</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_3]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>3</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_3]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_3]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            + 2 <inline-formula><alternatives><tex-math><![CDATA[y_{20}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>20</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">Fe2O3</td>
                    <td align="left">Fe2O3</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_4]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>4</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_4]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_4]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">MgCr2O4</td>
                    <td align="left">MgCr2O4</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_5]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>5</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_5]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_5]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">Fe2SiO4</td>
                    <td align="left">Fe2SiO4</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_6]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>6</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_6]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>6</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_6]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>6</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">MnSi1/2O2</td>
                    <td align="left">MnSi1/2O2</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_7]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>7</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_7]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>7</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_7]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>7</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">Mg2SiO4</td>
                    <td align="left">Mg2SiO4</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_8]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>8</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_8]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_8]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">NiSi1/2O2</td>
                    <td align="left">NiSi1/2O2</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_9]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>9</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_9]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>9</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_9]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>9</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">CoSi1/2O2</td>
                    <td align="left">CoSi1/2O2</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_{10}]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>10</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_{10}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_{10}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">CaSiO3</td>
                    <td align="left">CaSiO3</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_{11}]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>11</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_{11}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_{11}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            - <inline-formula><alternatives><tex-math><![CDATA[y_{18}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>18</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">Na2SiO3</td>
                    <td align="left">Na2SiO3</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_{12}]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>12</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_{12}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_{12}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            - 2 <inline-formula><alternatives><tex-math><![CDATA[y_{19}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>19</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">KAlSiO4</td>
                    <td align="left">KAlSiO4</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_{13}]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>13</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_{13}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>13</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_{13}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>13</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            - 4 <inline-formula><alternatives><tex-math><![CDATA[y_{20}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>20</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">Ca3(PO4)2</td>
                    <td align="left">Ca3(PO4)2</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_{14}]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>14</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_{14}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>14</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_{14}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>14</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">H2O</td>
                    <td align="left">H2O</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_{15}]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>15</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_{15}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>15</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_{15}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>15</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">CO2</td>
                    <td align="left">CO2</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_{16}]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>16</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_{16}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>16</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_{16}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>16</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            - <inline-formula><alternatives><tex-math><![CDATA[y_{18}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>18</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left">ZrSiO4</td>
                    <td align="left">ZrSiO4</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[n_{17}]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>17</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                    <td align="left"><inline-formula><alternatives><tex-math><![CDATA[y_{17}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>17</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            = <inline-formula><alternatives><tex-math><![CDATA[n_{17}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>n</mml:mi><mml:mn>17</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            - <inline-formula><alternatives><tex-math><![CDATA[y_{19}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>19</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
            - <inline-formula><alternatives><tex-math><![CDATA[y_{20}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mn>20</mml:mn></mml:msub></mml:math></alternatives></inline-formula></td>
                  </tr>
                  <tr>
                    <td align="left"/>
                    <td align="left">CaCO3</td>
                    <td align="left">CO2 + CaSiO3 = CaCO3 + SiO2</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[y_{18}]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>y</mml:mi>
                              <mml:mn>18</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                  </tr>
                  <tr>
                    <td align="left"/>
                    <td align="left">Na4ZrSi2O8</td>
                    <td align="left">ZrSiO4 + 2Na2SiO3 = Na4ZrSi2O8 + SiO2</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[y_{19}]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>y</mml:mi>
                              <mml:mn>19</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                  </tr>
                  <tr>
                    <td align="left"/>
                    <td align="left">K4ZrSi2O8</td>
                    <td align="left">ZrSiO4 + 4KAlSiO4 = K4ZrSi2O8 + 2Al2O3 +
            3SiO2</td>
                    <td align="left"/>
                    <td align="left">
                      <inline-formula>
                        <alternatives>
                          <tex-math><![CDATA[y_{20}]]></tex-math>
                          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                            <mml:msub>
                              <mml:mi>y</mml:mi>
                              <mml:mn>20</mml:mn>
                            </mml:msub>
                          </mml:math>
                        </alternatives>
                      </inline-formula>
                    </td>
                  </tr>
                </tbody>
              </table>
            </table-wrap>
          </sec>
          <sec id="cell-6-nb-5" specific-use="notebook-content">
            <p>The Gibbs Free Energy is formulated as before by the
    expression</p>
            <p>
              <inline-formula>
                <alternatives>
                  <tex-math><![CDATA[G = \sum_{i=1}^{s} y_i \mu_i^o + R T \sum_{i=1}^{s} y_i \log \left( \frac{y_i}{y_T} \right) + y_w R T \log \left( \frac{y_w}{y_T} \right) + \left( y_T - y_w \right) R T \log \left( \frac{y_T - y_w}{y_T} \right) + \sum_{i=1}^{s} \sum_{j=i+1}^{s} W_{i,j} \frac{y_i y_j}{y_T}]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                    <mml:mrow>
                      <mml:mi>G</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:msubsup>
                      <mml:msub>
                        <mml:mi>y</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:msubsup>
                        <mml:mi>μ</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:mi>o</mml:mi>
                      </mml:msubsup>
                      <mml:mo>+</mml:mo>
                      <mml:mi>R</mml:mi>
                      <mml:mi>T</mml:mi>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:msubsup>
                      <mml:msub>
                        <mml:mi>y</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:mo>log</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mfrac>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msub>
                        </mml:mfrac>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mo>+</mml:mo>
                      <mml:msub>
                        <mml:mi>y</mml:mi>
                        <mml:mi>w</mml:mi>
                      </mml:msub>
                      <mml:mi>R</mml:mi>
                      <mml:mi>T</mml:mi>
                      <mml:mo>log</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mfrac>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>w</mml:mi>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msub>
                        </mml:mfrac>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mo>+</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mi>T</mml:mi>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mi>w</mml:mi>
                        </mml:msub>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mi>R</mml:mi>
                      <mml:mi>T</mml:mi>
                      <mml:mo>log</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>y</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mi>y</mml:mi>
                              <mml:mi>w</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msub>
                        </mml:mfrac>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mo>+</mml:mo>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:msubsup>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mi>i</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:msubsup>
                      <mml:msub>
                        <mml:mi>W</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>j</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mi>T</mml:mi>
                        </mml:msub>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </inline-formula>
            </p>
            <p>and the new chemical potential is given by</p>
            <p>
              <inline-formula>
                <alternatives>
                  <tex-math><![CDATA[\mu_{ZrSiO_4} = \mu_{ZrSiO_4}^o + R T \log \left( \frac{y_{ZrSiO_4} \left( y_T - y_w \right)}{y_T^2} \right) + \sum_{i=1}^s W_{i,{ZrSiO_4}} \frac{y_i}{y_T} - \sum_{i=1}^s \sum_{j=i+1}^s W_{i,j} \frac{y_i y_j}{y_T^2}]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>μ</mml:mi>
                        <mml:mrow>
                          <mml:mi>Z</mml:mi>
                          <mml:mi>r</mml:mi>
                          <mml:mi>S</mml:mi>
                          <mml:mi>i</mml:mi>
                          <mml:msub>
                            <mml:mi>O</mml:mi>
                            <mml:mn>4</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:msubsup>
                        <mml:mi>μ</mml:mi>
                        <mml:mrow>
                          <mml:mi>Z</mml:mi>
                          <mml:mi>r</mml:mi>
                          <mml:mi>S</mml:mi>
                          <mml:mi>i</mml:mi>
                          <mml:msub>
                            <mml:mi>O</mml:mi>
                            <mml:mn>4</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mi>o</mml:mi>
                      </mml:msubsup>
                      <mml:mo>+</mml:mo>
                      <mml:mi>R</mml:mi>
                      <mml:mi>T</mml:mi>
                      <mml:mo>log</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>y</mml:mi>
                              <mml:mrow>
                                <mml:mi>Z</mml:mi>
                                <mml:mi>r</mml:mi>
                                <mml:mi>S</mml:mi>
                                <mml:mi>i</mml:mi>
                                <mml:msub>
                                  <mml:mi>O</mml:mi>
                                  <mml:mn>4</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mrow>
                              <mml:mo stretchy="true" form="prefix">(</mml:mo>
                              <mml:msub>
                                <mml:mi>y</mml:mi>
                                <mml:mi>T</mml:mi>
                              </mml:msub>
                              <mml:mo>−</mml:mo>
                              <mml:msub>
                                <mml:mi>y</mml:mi>
                                <mml:mi>w</mml:mi>
                              </mml:msub>
                              <mml:mo stretchy="true" form="postfix">)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:msubsup>
                            <mml:mi>y</mml:mi>
                            <mml:mi>T</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msubsup>
                        </mml:mfrac>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mo>+</mml:mo>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:msubsup>
                      <mml:msub>
                        <mml:mi>W</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mrow>
                            <mml:mi>Z</mml:mi>
                            <mml:mi>r</mml:mi>
                            <mml:mi>S</mml:mi>
                            <mml:mi>i</mml:mi>
                            <mml:msub>
                              <mml:mi>O</mml:mi>
                              <mml:mn>4</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mfrac>
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mi>T</mml:mi>
                        </mml:msub>
                      </mml:mfrac>
                      <mml:mo>−</mml:mo>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:msubsup>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mi>i</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:msubsup>
                      <mml:msub>
                        <mml:mi>W</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>j</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:msubsup>
                          <mml:mi>y</mml:mi>
                          <mml:mi>T</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msubsup>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </inline-formula>
            </p>
          </sec>
          <sec id="cell-7-nb-5" specific-use="notebook-content">
  </sec>
          <sec id="zircon-saturation-and-model-simplication-nb-5">
            <title>Zircon saturation and model simplication</title>
            <p>The expression for the chemical potential of ZrSiO4 can be
    rearranged to</p>
            <p>
              <inline-formula>
                <alternatives>
                  <tex-math><![CDATA[\mu_{ZrSiO_4} = \mu_{ZrSiO_4}^o + R T \log \left[ \frac{\left(n_{ZrSiO_4} - y_{Na_4ZrSi_2O_8} - y_{K_4ZrSi_2O_8} \right) \left( y_T - y_w \right)}{y_T^2} \right] + \sum_{i=1}^s W_{i,{ZrSiO_4}} \frac{y_i}{y_T} - \sum_{i=1}^s \sum_{j=i+1}^s W_{i,j} \frac{y_i y_j}{y_T^2}]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>μ</mml:mi>
                        <mml:mrow>
                          <mml:mi>Z</mml:mi>
                          <mml:mi>r</mml:mi>
                          <mml:mi>S</mml:mi>
                          <mml:mi>i</mml:mi>
                          <mml:msub>
                            <mml:mi>O</mml:mi>
                            <mml:mn>4</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:msubsup>
                        <mml:mi>μ</mml:mi>
                        <mml:mrow>
                          <mml:mi>Z</mml:mi>
                          <mml:mi>r</mml:mi>
                          <mml:mi>S</mml:mi>
                          <mml:mi>i</mml:mi>
                          <mml:msub>
                            <mml:mi>O</mml:mi>
                            <mml:mn>4</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mi>o</mml:mi>
                      </mml:msubsup>
                      <mml:mo>+</mml:mo>
                      <mml:mi>R</mml:mi>
                      <mml:mi>T</mml:mi>
                      <mml:mo>log</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">[</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mo stretchy="true" form="prefix">(</mml:mo>
                              <mml:msub>
                                <mml:mi>n</mml:mi>
                                <mml:mrow>
                                  <mml:mi>Z</mml:mi>
                                  <mml:mi>r</mml:mi>
                                  <mml:mi>S</mml:mi>
                                  <mml:mi>i</mml:mi>
                                  <mml:msub>
                                    <mml:mi>O</mml:mi>
                                    <mml:mn>4</mml:mn>
                                  </mml:msub>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>−</mml:mo>
                              <mml:msub>
                                <mml:mi>y</mml:mi>
                                <mml:mrow>
                                  <mml:mi>N</mml:mi>
                                  <mml:msub>
                                    <mml:mi>a</mml:mi>
                                    <mml:mn>4</mml:mn>
                                  </mml:msub>
                                  <mml:mi>Z</mml:mi>
                                  <mml:mi>r</mml:mi>
                                  <mml:mi>S</mml:mi>
                                  <mml:msub>
                                    <mml:mi>i</mml:mi>
                                    <mml:mn>2</mml:mn>
                                  </mml:msub>
                                  <mml:msub>
                                    <mml:mi>O</mml:mi>
                                    <mml:mn>8</mml:mn>
                                  </mml:msub>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>−</mml:mo>
                              <mml:msub>
                                <mml:mi>y</mml:mi>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mi>K</mml:mi>
                                    <mml:mn>4</mml:mn>
                                  </mml:msub>
                                  <mml:mi>Z</mml:mi>
                                  <mml:mi>r</mml:mi>
                                  <mml:mi>S</mml:mi>
                                  <mml:msub>
                                    <mml:mi>i</mml:mi>
                                    <mml:mn>2</mml:mn>
                                  </mml:msub>
                                  <mml:msub>
                                    <mml:mi>O</mml:mi>
                                    <mml:mn>8</mml:mn>
                                  </mml:msub>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo stretchy="true" form="postfix">)</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo stretchy="true" form="prefix">(</mml:mo>
                              <mml:msub>
                                <mml:mi>y</mml:mi>
                                <mml:mi>T</mml:mi>
                              </mml:msub>
                              <mml:mo>−</mml:mo>
                              <mml:msub>
                                <mml:mi>y</mml:mi>
                                <mml:mi>w</mml:mi>
                              </mml:msub>
                              <mml:mo stretchy="true" form="postfix">)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:msubsup>
                            <mml:mi>y</mml:mi>
                            <mml:mi>T</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msubsup>
                        </mml:mfrac>
                        <mml:mo stretchy="true" form="postfix">]</mml:mo>
                      </mml:mrow>
                      <mml:mo>+</mml:mo>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:msubsup>
                      <mml:msub>
                        <mml:mi>W</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mrow>
                            <mml:mi>Z</mml:mi>
                            <mml:mi>r</mml:mi>
                            <mml:mi>S</mml:mi>
                            <mml:mi>i</mml:mi>
                            <mml:msub>
                              <mml:mi>O</mml:mi>
                              <mml:mn>4</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mfrac>
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mi>T</mml:mi>
                        </mml:msub>
                      </mml:mfrac>
                      <mml:mo>−</mml:mo>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:msubsup>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mi>i</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:msubsup>
                      <mml:msub>
                        <mml:mi>W</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>j</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:msubsup>
                          <mml:mi>y</mml:mi>
                          <mml:mi>T</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msubsup>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </inline-formula>
            </p>
            <p>This expression shows that stablizing the alkali-zirconate
    species decreases the effective concentration of ZrSiO4 and makes
    the logaithm term in the chemical potential more negative. Given
    that zircon saturation requires:</p>
            <p>
              <inline-formula>
                <alternatives>
                  <tex-math><![CDATA[\mu_{ZrSiO_4}^{o,zircon} = \mu_{ZrSiO_4}^{liquid}]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>μ</mml:mi>
                        <mml:mrow>
                          <mml:mi>Z</mml:mi>
                          <mml:mi>r</mml:mi>
                          <mml:mi>S</mml:mi>
                          <mml:mi>i</mml:mi>
                          <mml:msub>
                            <mml:mi>O</mml:mi>
                            <mml:mn>4</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>o</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>z</mml:mi>
                          <mml:mi>i</mml:mi>
                          <mml:mi>r</mml:mi>
                          <mml:mi>c</mml:mi>
                          <mml:mi>o</mml:mi>
                          <mml:mi>n</mml:mi>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mo>=</mml:mo>
                      <mml:msubsup>
                        <mml:mi>μ</mml:mi>
                        <mml:mrow>
                          <mml:mi>Z</mml:mi>
                          <mml:mi>r</mml:mi>
                          <mml:mi>S</mml:mi>
                          <mml:mi>i</mml:mi>
                          <mml:msub>
                            <mml:mi>O</mml:mi>
                            <mml:mn>4</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>l</mml:mi>
                          <mml:mi>i</mml:mi>
                          <mml:mi>q</mml:mi>
                          <mml:mi>u</mml:mi>
                          <mml:mi>i</mml:mi>
                          <mml:mi>d</mml:mi>
                        </mml:mrow>
                      </mml:msubsup>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </inline-formula>
            </p>
            <p>the effect of alakli concentration on the ZrSiO4 liquid chemical
    potential is dominated by the logarithmic term <italic>if Zr is at
    low-concentration in the liquid</italic>.</p>
            <p>Note also that because the alkali-zirconate species
    concentrations are determined by these two homogeneous equilibrium
    reactions:</p>
            <list list-type="bullet">
              <list-item>
                <p>ZrSiO4 + 2Na2SiO3 = Na4ZrSi2O8 + SiO2</p>
              </list-item>
              <list-item>
                <p>ZrSiO4 + 4KAlSiO4 = K4ZrSi2O8 + 2Al2O3 + 3SiO2</p>
              </list-item>
            </list>
            <p>when the activity of silica in the melt is low, as is the case
    for alkali-rhyolites, trachytes, phonolites, etc., both reactions
    will be driven to the right, which will increase concentrations of
    the alkali-zirconate species, and <italic>lower</italic> the
    effective concentration of ZrSiO4. The effect of this will be to
    make <inline-formula><alternatives><tex-math><![CDATA[\mu_{ZrSiO_4}^{liquid}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>q</mml:mi><mml:mi>u</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>
    more negative. Consequently, alali-rich melts will require more Zr
    to saturate with zircon!</p>
            <sec id="now-we-make-some-assumptions-about-which-parameters-in-the-model-are-likely-to-be-important.-nb-5">
              <title>Now, we make some assumptions about which parameters in the
      model are likely to be important.</title>
              <list list-type="bullet">
                <list-item>
                  <p>We will assume that all standard state and regular solution
          interaction parameters calibrated previously are applicable to
          this model.</p>
                </list-item>
                <list-item>
                  <p>There are 19 species interaction parameters like
          <inline-formula><alternatives><tex-math><![CDATA[W_{ZrSiO_4, i}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
          another 19 like <inline-formula><alternatives><tex-math><![CDATA[W_{Na_4ZrSi_2O_8, i}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
          and another 19 like <inline-formula><alternatives><tex-math><![CDATA[W_{K_4ZrSi_2O_8, i}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>.
          It is unlikely that we will have enough calibration data of
          sufficient compositional variability to constrain all but a
          few of them. We will assume that the speciation mole fractions
          in the logarithmic term will be sufficient for calibrating our
          experimental dataset and set all 57 W-terms to zero.</p>
                </list-item>
                <list-item>
                  <p>We will assume that <inline-formula><alternatives><tex-math><![CDATA[\mu_{ZrSiO_4}^{o} = H_{ZrSiO_4} - T S_{ZrSiO_4} + \left( P - 1 \right) V_{ZrSiO_4}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow><mml:mi>o</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>P</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
          where <inline-formula><alternatives><tex-math><![CDATA[H_{ZrSiO_4}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
          <inline-formula><alternatives><tex-math><![CDATA[S_{ZrSiO_4}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
          and <inline-formula><alternatives><tex-math><![CDATA[V_{ZrSiO_4}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
          are model parameters.</p>
                </list-item>
                <list-item>
                  <p>We will assume that <inline-formula><alternatives><tex-math><![CDATA[\mu_{Na_4ZrSi_2O_8}^{o} = H_{Na_4ZrSi_2O_8} - T S_{Na_4ZrSi_2O_8} + \left( P - 1 \right) V_{Na_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow><mml:mi>o</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>P</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
          where <inline-formula><alternatives><tex-math><![CDATA[H_{Na_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
          <inline-formula><alternatives><tex-math><![CDATA[S_{Na_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
          and <inline-formula><alternatives><tex-math><![CDATA[V_{Na_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
          are model parameters.</p>
                </list-item>
                <list-item>
                  <p>We will assume that <inline-formula><alternatives><tex-math><![CDATA[\mu_{K_4ZrSi_2O_8}^{o} = H_{K_4ZrSi_2O_8} - T S_{K_4ZrSi_2O_8} + \left( P - 1 \right) V_{K_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow><mml:mi>o</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>P</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
          where <inline-formula><alternatives><tex-math><![CDATA[H_{K_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
          <inline-formula><alternatives><tex-math><![CDATA[S_{K_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
          and <inline-formula><alternatives><tex-math><![CDATA[V_{K_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
          are model parameters.</p>
                </list-item>
              </list>
              <p>With these assumptions we have a model that requires values of
      the following nine parameters to be estimated and refined: -
      <inline-formula><alternatives><tex-math><![CDATA[H_{ZrSiO_4}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
      <inline-formula><alternatives><tex-math><![CDATA[S_{ZrSiO_4}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
      and <inline-formula><alternatives><tex-math><![CDATA[V_{ZrSiO_4}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
      - <inline-formula><alternatives><tex-math><![CDATA[H_{Na_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
      <inline-formula><alternatives><tex-math><![CDATA[S_{Na_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
      and <inline-formula><alternatives><tex-math><![CDATA[V_{Na_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
      - <inline-formula><alternatives><tex-math><![CDATA[H_{K_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
      <inline-formula><alternatives><tex-math><![CDATA[S_{K_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
      and <inline-formula><alternatives><tex-math><![CDATA[V_{K_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula></p>
              <p><inline-formula><alternatives><tex-math><![CDATA[H_{ZrSiO_4}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
      <inline-formula><alternatives><tex-math><![CDATA[S_{ZrSiO_4}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
      and <inline-formula><alternatives><tex-math><![CDATA[V_{ZrSiO_4}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
      will be estimated from the properties of zircon and a guess as to
      the entropy of fusion of zircon.</p>
              <p><inline-formula><alternatives><tex-math><![CDATA[H_{Na_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
      <inline-formula><alternatives><tex-math><![CDATA[S_{Na_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
      and <inline-formula><alternatives><tex-math><![CDATA[V_{Na_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
      will be estimated by assumming that the <italic>standard state
      Gibbs Free Energy</italic> change of the reaction ZrSiO4 +
      2Na2SiO3 = Na4ZrSi2O8 + SiO2 is zero at some average experimental
      temperature.</p>
              <p><inline-formula><alternatives><tex-math><![CDATA[H_{K_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
      <inline-formula><alternatives><tex-math><![CDATA[S_{K_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
      and <inline-formula><alternatives><tex-math><![CDATA[V_{K_4ZrSi_2O_8}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>Z</mml:mi><mml:mi>r</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
      will be estimated by assumming that the <italic>standard state
      Gibbs Free Energy</italic> change of the reaction ZrSiO4 +
      4KAlSiO4 = K4ZrSi2O8 + 2Al2O3 + 3SiO2 is zero at some average
      experimental temperature.</p>
            </sec>
            <sec id="cell-8-nb-5" specific-use="notebook-content">
              <p>
                <bold>Now let’s build code for the model and calibrate the
      parameters from experimental data</bold>
              </p>
            </sec>
          </sec>
        </sec>
      </sec>
    </body>
    <back>
</back>
  </sub-article>
  <sub-article article-type="notebook" id="nb-18-nb-6">
    <front-stub>
      <title-group>
        <article-title>6-Calibration: MELTS liquid model with
ZrSiO4</article-title>
      </title-group>
    </front-stub>
    <body>
      <sec id="cell-0-nb-6" specific-use="notebook-content">
        <sec id="calibration-melts-liquid-model-with-zrsio4-nb-6">
          <title>6-Calibration: MELTS liquid model with ZrSiO4</title>
          <p>
            <bold>Parameter and calibration exploration notebook.</bold>
            <bold>Run Endmembers-MELTS, Liquid-MELTS-codegen,
  Liquid-MELTS-API-tests and Liquid=MELTS-calib-1 notebooks
  first!</bold>
          </p>
          <p>Proposed associated solution model:</p>
          <table-wrap>
            <table>
              <colgroup>
                <col width="19%"/>
                <col width="14%"/>
                <col width="16%"/>
                <col width="16%"/>
                <col width="18%"/>
                <col width="18%"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="left">Components:</th>
                  <th align="left">Species:</th>
                  <th align="left">Reaction:</th>
                  <th align="left">Variable:</th>
                  <th align="left">Component:</th>
                  <th align="left">Species X:</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left">SiO2</td>
                  <td align="left">SiO2</td>
                  <td align="left"/>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_1]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_1]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">TiO2</td>
                  <td align="left">TiO2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_1]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_2]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_2]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Al2O3</td>
                  <td align="left">Al2O3</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_2]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_3]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>3</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_3]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>3</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Fe2O3</td>
                  <td align="left">Fe2O3</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_3]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>3</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_4]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>4</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_4]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>4</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">MgCr2O4</td>
                  <td align="left">MgCr2O4</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_4]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>4</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_5]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>5</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_5]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>5</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Fe2SiO4</td>
                  <td align="left">Fe2SiO4</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_5]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>5</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_6]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>6</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_6]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>6</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">MnSi1/2O2</td>
                  <td align="left">MnSi1/2O2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_6]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>6</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_7]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>7</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_7]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>7</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Mg2SiO4</td>
                  <td align="left">Mg2SiO4</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_7]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>7</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_8]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>8</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_8]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>8</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">NiSi1/2O2</td>
                  <td align="left">NiSi1/2O2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_8]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>8</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_9]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>9</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_9]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>9</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">CoSi1/2O2</td>
                  <td align="left">CoSi1/2O2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_9]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>9</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{10}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>10</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{10}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>10</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">CaSiO3</td>
                  <td align="left">CaSiO3</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{10}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>10</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{11}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>11</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{11}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>11</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Na2SiO3</td>
                  <td align="left">Na2SiO3</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{11}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>11</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{12}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>12</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{12}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>12</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">KAlSiO4</td>
                  <td align="left">KAlSiO4</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{12}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>12</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{13}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>13</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{13}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>13</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Ca3(PO4)2</td>
                  <td align="left">Ca3(PO4)2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{13}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>13</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{14}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>14</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{14}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>14</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">H2O</td>
                  <td align="left">H2O</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{14}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>14</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{15}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>15</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{15}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>15</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">CO2</td>
                  <td align="left">CO2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{15}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>15</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{16}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>16</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{16}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>16</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">ZrSiO4</td>
                  <td align="left">ZrSiO4</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{16}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>16</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{17}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>17</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{17}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>17</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left"/>
                  <td align="left">CaCO3</td>
                  <td align="left">CO2 + CaSiO3 = CaCO3 + SiO2</td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[s_1]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>s</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{18}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>18</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left"/>
                  <td align="left">Na4ZrSi2O8</td>
                  <td align="left">ZrSiO4 + 2Na2SiO3 = Na4ZrSi2O8 + SiO2</td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[s_2]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>s</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{19}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>19</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left"/>
                  <td align="left">K4ZrSi2O8</td>
                  <td align="left">ZrSiO4 + 4KAlSiO4 = K4ZrSi2O8 + 2Al2O3 +
          3SiO2</td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[s_3]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>s</mml:mi>
                            <mml:mn>3</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{20}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>20</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
        </sec>
        <sec id="cell-1-nb-6" specific-use="notebook-code">
          <code language="python">import pandas as pd
import numpy as np
from thermoengine import core, coder, phases
import sympy as sym
import math
sym.init_printing()
from thermoengine.model import Database
db = Database()
import matplotlib.pyplot as plt
import scipy as sci
%matplotlib inline
import warnings
warnings.filterwarnings("ignore", category=DeprecationWarning)
warnings.filterwarnings("ignore", category=FutureWarning)</code>
        </sec>
        <sec id="cell-2-nb-6" specific-use="notebook-content">
          <list list-type="bullet">
            <list-item>
              <p>Number of components = 17</p>
            </list-item>
            <list-item>
              <p>Number of species = 20</p>
            </list-item>
            <list-item>
              <p>Number of “ordering parameters” (i.e., dependent species) =
      3</p>
            </list-item>
          </list>
        </sec>
        <sec id="cell-3-nb-6" specific-use="notebook-code">
          <code language="python">nc = 17
nw = 20
ns = 3</code>
        </sec>
        <sec id="cell-4-nb-6" specific-use="notebook-content">
          <p>Import previously generated and compiled model</p>
        </sec>
        <sec id="cell-5-nb-6" specific-use="notebook-code">
          <code language="python">model_working_dir = "working"
%cd {model_working_dir}
from pyximport import install
install()
import rMELTS_ZR
%cd ..</code>
        </sec>
        <sec id="cell-6-nb-6" specific-use="notebook-content">
          <p>Test identifier routines</p>
        </sec>
        <sec id="cell-7-nb-6" specific-use="notebook-code">
          <code language="python">print(rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_identifier())
print(rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_name())</code>
        </sec>
        <sec id="cell-8-nb-6" specific-use="notebook-content">
          <sec id="read-in-parameter-estimates-from-first-calibration-notebook-nb-6">
            <title>Read in parameter estimates from first calibration
    notebook</title>
          </sec>
          <sec id="cell-9-nb-6" specific-use="notebook-code">
            <code language="python">import pickle
with open('params.pickle', 'rb') as f:
    params_stored = pickle.load(f)
for i,x in enumerate(params_stored):
    rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(i, x) </code>
          </sec>
          <sec id="cell-10-nb-6" specific-use="notebook-content">
  </sec>
          <sec id="create-models-for-zirconium-bearing-minerals-nb-6">
            <title>Create models for zirconium-bearing minerals</title>
          </sec>
          <sec id="cell-11-nb-6" specific-use="notebook-code">
            <code language="python">model = coder.StdStateModel()
model.set_module_name('zirconium_minerals')
model_type = "calib"
T = model.get_symbol_for_t()
P = model.get_symbol_for_p()
Tr = model.get_symbol_for_tr()
Pr = model.get_symbol_for_pr()</code>
          </sec>
          <sec id="cell-12-nb-6" specific-use="notebook-content">
            <sec id="formulation-robie-ra-hemingway-bs-1995-nb-6">
              <title>Formulation, Robie RA, Hemingway BS, 1995</title>
              <p>Thermodynamic Properties of Minerals and Related Substances at
      298.15 K and 1 Bar (105 Pascals) Pressure and at Higher
      Temperatures. U.S. Geological Survey, Bulletin 2131, 461pp</p>
              <list list-type="bullet">
                <list-item>
                  <p><inline-formula><alternatives><tex-math><![CDATA[\Delta H_f]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
          S, V, Cp</p>
                </list-item>
                <list-item>
                  <p>
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[Cp = A_1 + A_2 T + \frac{A_3}{T^2} + \frac{A_4}{\sqrt{T}} + A_5 T^2]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:mrow>
                            <mml:mi>C</mml:mi>
                            <mml:mi>p</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:msub>
                              <mml:mi>A</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                            <mml:mo>+</mml:mo>
                            <mml:msub>
                              <mml:mi>A</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                            <mml:mi>T</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mfrac>
                              <mml:msub>
                                <mml:mi>A</mml:mi>
                                <mml:mn>3</mml:mn>
                              </mml:msub>
                              <mml:msup>
                                <mml:mi>T</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msup>
                            </mml:mfrac>
                            <mml:mo>+</mml:mo>
                            <mml:mfrac>
                              <mml:msub>
                                <mml:mi>A</mml:mi>
                                <mml:mn>4</mml:mn>
                              </mml:msub>
                              <mml:msqrt>
                                <mml:mi>T</mml:mi>
                              </mml:msqrt>
                            </mml:mfrac>
                            <mml:mo>+</mml:mo>
                            <mml:msub>
                              <mml:mi>A</mml:mi>
                              <mml:mn>5</mml:mn>
                            </mml:msub>
                            <mml:msup>
                              <mml:mi>T</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msup>
                          </mml:mrow>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </p>
                </list-item>
              </list>
            </sec>
            <sec id="cell-13-nb-6" specific-use="notebook-code">
              <code language="python">h0,s0,a1,a2,a3,a4,a5,v = sym.symbols('h0 s0 a1 a2 a3 a4 a5 v')
params = [
    ('h0','J',h0), 
    ('s0','J/K', s0), 
    ('a1', 'J/K', a1), 
    ('a2', 'J/K^2', a2), 
    ('a3', 'J-K', a3), 
    ('a4', 'J/K^1/2', a4), 
    ('a5', 'J/K^3', a5),
    ('v', 'J/bar', v)
]
Cp = a1 + a2*T + a3/T**2 + a4/sym.sqrt(T) + a5*T**2
G = h0 + sym.integrate(Cp,(T,Tr,T)) - T*(s0 + sym.integrate(Cp/T,(T,Tr,T))) + sym.integrate(v,(P,Pr,P))
model.add_expression_to_model(G, params)</code>
            </sec>
            <sec id="cell-14-nb-6" specific-use="notebook-code">
              <code language="python">model_working_dir = "working"
!mkdir -p {model_working_dir}
%cd {model_working_dir}</code>
            </sec>
            <sec id="cell-15-nb-6" specific-use="notebook-code">
              <code language="python">param_dict = {
    'Phase': 'zircon',
    'Formula': 'Zr(1)Si(1)O(4)',
    'h0':  -2034200.0,
    's0':        84.0,
    'v':          3.926,
    'a1':         2.370e2,
    'a2':        -1.788e-2,
    'a3':        -1.496e5,
    'a4':        -2.268e3,
    'a5':         0.0,
    'T_r':      298.15,
    'P_r':        1.0,
    'trl':     1673.15
}
result = model.create_code_module(phase=param_dict['Phase'], formula=param_dict['Formula'], params=param_dict, module_type=model_type)
%cp zirconium_minerals.pyx endmembers.pyx
endmember_file_list = ['zircon_zirconium_minerals_calib.c']
endmember_name_list = ['zircon']</code>
            </sec>
            <sec id="cell-16-nb-6" specific-use="notebook-code">
              <code language="python">param_dict = {
    'Phase': 'baddeleyite',
    'Formula': 'Zr(1)O(2)',
    'h0':  -1100600.0,
    's0':        50.4,
    'a1':         1.073e2,
    'a2':        -5.011e-3,
    'a3':        -2.203e5,
    'a4':        -8.141e2,
    'a5':         0.0,
    'v':          2.115,
    'T_r':      298.15,
    'P_r':        1.0,
    'trl':     1673.15
}
result = model.create_code_module(phase=param_dict['Phase'], formula=param_dict['Formula'], params=param_dict, module_type=model_type)
%cat zirconium_minerals.pyx &gt;&gt; endmembers.pyx
endmember_file_list.append('baddeleyite_zirconium_minerals_calib.c')
endmember_name_list.append('baddeleyite')</code>
            </sec>
            <sec id="cell-17-nb-6" specific-use="notebook-code">
              <code language="python">with open('zirconium_minerals.pyxbld', 'r') as f:
    fold = f.read()
    f.close()
old_file_list = "'" + endmember_file_list[-1] + "'"
new_file_list = ''
sep = ''
for x in endmember_file_list:
    new_file_list += sep + "'" + x + "'"
    sep = ", "
fnew = fold.replace(old_file_list, new_file_list)
with open('zirconium_minerals.pyxbld', 'w') as f:
    f.write(fnew)
    f.close
%cp endmembers.pyx zirconium_minerals.pyx</code>
            </sec>
            <sec id="cell-18-nb-6" specific-use="notebook-code">
              <code language="python">import zirconium_minerals
%cd ..</code>
            </sec>
            <sec id="cell-19-nb-6" specific-use="notebook-content">
    </sec>
          </sec>
          <sec id="read-common-scripts-nb-6">
            <title>Read common scripts</title>
            <p>Execute scripts in the Jupyter notebook namespace so that methods
    have access to notebook variables.</p>
          </sec>
          <sec id="cell-20-nb-6" specific-use="notebook-code">
            <code language="python">%run -i support_scripts.py</code>
          </sec>
          <sec id="cell-21-nb-6" specific-use="notebook-content">
  </sec>
          <sec id="function-to-calculate-affinities-for-these-reactions-nb-6">
            <title>Function to calculate affinities for these reactions:</title>
            <p>ZrSiO4 = ZrSiO4 (zircon)
    ZrSiO4 = ZrO2 (baddeleyite) + SiO2</p>
          </sec>
          <sec id="cell-22-nb-6" specific-use="notebook-code">
            <code language="python">def zirconium_min_affinities(t, p, mu, print_results=True):
    global zirconium_minerals
    G0zirc = zirconium_minerals.cy_zircon_zirconium_minerals_calib_g(t,p)
    G0badd = zirconium_minerals.cy_baddeleyite_zirconium_minerals_calib_g(t,p)
    affinities = []
    affinities.append(mu[16] - G0zirc)
    affinities.append(mu[16] - G0badd - mu[0])
    if print_results:
        print ('Affinity {0:&lt;12.12s} {1:12.3f}'.format('zircon', affinities[0]))
        print ('Affinity {0:&lt;12.12s} {1:12.3f}'.format('baddeleyite', affinities[1]))
    return tuple(affinities)</code>
          </sec>
          <sec id="cell-23-nb-6" specific-use="notebook-content">
  </sec>
          <sec id="guess-some-parameter-values-from-a-first-pass-through-the-primary-calibration-data-nb-6">
            <title>Guess some parameter values (from a first pass through the
    primary calibration data)</title>
            <list list-type="bullet">
              <list-item>
                <p>Exchange entropies and volumes are maintained at zero</p>
              </list-item>
              <list-item>
                <p>Free parameters are enthalpies of ZrSiO4, Na4ZrSi2O8 and
        K4ZrSi2O8, and the entropy and volume of ZrSiO4</p>
              </list-item>
            </list>
            <p>These estimates are arrived at by guess work minimization of
    residuals. They are not final values.</p>
          </sec>
          <sec id="cell-24-nb-6" specific-use="notebook-code">
            <code language="python">ref_param_values = rMELTS_ZR.cy_Liquid_rMELTS_ZR_get_param_values()
ref_param_values</code>
          </sec>
          <sec id="cell-25-nb-6" specific-use="notebook-code">
            <code language="python">adj_H_ZrSiO4 = 100000.0 + 22020.0    + 107500.0    - 32110.0
adj_S_ZrSiO4 =               40.0242 +     83.7465 -    27.8937
adj_V_ZrSiO4 =                0.5448 -      0.2236 -     0.110
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(5,  ref_param_values[ 5] + adj_H_ZrSiO4 - 225000.0) # Na4ZrSi2O8
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(6,  ref_param_values[ 6] + adj_S_ZrSiO4)
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(7,  ref_param_values[ 7] + adj_V_ZrSiO4)
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(8,  ref_param_values[ 8] + adj_H_ZrSiO4 -  75000.0) # K4ZrSi2O8
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(9,  ref_param_values[ 9] + adj_S_ZrSiO4)
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(10, ref_param_values[10] + adj_V_ZrSiO4)
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(11, ref_param_values[11] + adj_H_ZrSiO4)            # ZrSiO4
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(12, ref_param_values[12] + adj_S_ZrSiO4)
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(13, ref_param_values[13] + adj_V_ZrSiO4)</code>
          </sec>
          <sec id="cell-26-nb-6" specific-use="notebook-code">
            <code language="python">param_values = rMELTS_ZR.cy_Liquid_rMELTS_ZR_get_param_values()
param_values</code>
          </sec>
          <sec id="cell-27-nb-6" specific-use="notebook-content">
  </sec>
          <sec id="evaluate-zircon-saturation-data-nb-6">
            <title>Evaluate zircon saturation data</title>
            <list list-type="bullet">
              <list-item>
                <p>two primary sources:</p>
                <list list-type="bullet">
                  <list-item>
                    <p>Watson EB and Harrison TM (1983) Zircon saturation
            revisited: temperature and composition effects in a variety
            of crustal magma types. Earth and Planetary Science Letters,
            64, 295-304</p>
                  </list-item>
                  <list-item>
                    <p>Boehnke P, Watson EB, Trail D, Harrison TM, Schmitt AK
            (2013) Zircon saturation re-visited. Chemical Geology, 351,
            324-334</p>
                  </list-item>
                </list>
              </list-item>
            </list>
          </sec>
          <sec id="cell-28-nb-6" specific-use="notebook-content">
            <p>Read data sources (Excel files) as Pandas dataframes</p>
          </sec>
          <sec id="cell-29-nb-6" specific-use="notebook-code">
            <code language="python">df1 = pd.read_csv('Watson_and_Harrison.csv')
df1.fillna(0)</code>
          </sec>
          <sec id="cell-30-nb-6" specific-use="notebook-code">
            <code language="python">for i,x in enumerate(df1.columns):
    print (i+1, x)</code>
          </sec>
          <sec id="cell-31-nb-6" specific-use="notebook-code">
            <code language="python">df2 = pd.read_csv('Boehnke_et_al.csv')
df2.fillna(0)</code>
          </sec>
          <sec id="cell-32-nb-6" specific-use="notebook-code">
            <code language="python">for i,x in enumerate(df2.columns):
    print (i+1, x)</code>
          </sec>
          <sec id="cell-33-nb-6" specific-use="notebook-content">
            <p>Process the two data sets and store residual information and
    other results in the following Python lists: - x_data[] - data index
    - y_data[] - residual - n_liq[] - liquid compositional vector -
    s_liq[] - liquid species concentration vector - t_data[] -
    temperature in Kelvins - p_data[] - pressure in bars - name[] -
    source string or experimental descriptor - s_data[] - source author
    id (1, 2) - y_est[] - extimated value of Zr liquid concentration in
    PPM (value that zeros residuals) - y_con[] - True or False regarding
    convergence of y_est - y_ref[] - measured value of Zr liquid
    concentration</p>
          </sec>
          <sec id="cell-34-nb-6" specific-use="notebook-code">
            <code language="python">name = []
x_data = []
y_data = []
n_liq = []
s_liq = []
t_data = []
p_data = []
s_data = []
y_est = []
y_con = []
y_ref = []
auth_dat = []
for df in [df1, df2]:
    df_iterator = df.itertuples()
    #
    for row_indx,data in enumerate(df_iterator):
        auth_id = data[3]
        t = data[25 if auth_id == 1 else 17] + 273.15
        p = data[26 if auth_id == 1 else 18]*10000.0
        if data[4] != 'Liquid':
            continue
        grm_oxides = {
            'SiO2':  data[5 if auth_id == 1 else 5], 
            'TiO2':  data[7 if auth_id == 1 else 6], 
            'Al2O3': data[9 if auth_id == 1 else 7], 
            'Fe2O3': 0.0,
            'Cr2O3': 0.0, 
            'FeO':   data[11 if auth_id == 1 else 8], 
            'MnO':    0.0,
            'MgO':   data[13 if auth_id == 1 else 9], 
            'NiO':    0.0, 
            'CoO':    0.0,
            'CaO':   data[15 if auth_id == 1 else 10], 
            'Na2O':  data[17 if auth_id == 1 else 11], 
            'K2O':   data[19 if auth_id == 1 else 12], 
            'P2O5':   0.0, 
            'H2O':   data[24 if auth_id == 1 else 15],
            'CO2':    0.01
        }
        tot_grm_oxides = 0.0
        for key in grm_oxides.keys():
            tot_grm_oxides += grm_oxides[key]
        mol_oxides = core.chem.format_mol_oxide_comp(grm_oxides, convert_grams_to_moles=True)
        #
        NNO = db.redox_buffer(t, p, buffer='NNO', method='LEPR')
        ox_moles = mol_oxides.reshape(1,nc-1)
        db.redox_state(t, p, 
                       oxide_comp={'Liq':ox_moles}, 
                       logfO2=np.array(NNO), 
                       phase_of_interest='Liq', method='Kress91')
        #print ('n Fe2O3   at NNO   moles = {0:10.8f}'.format(ox_moles[0,3]))
        #print ('n FeO     at NNO   moles = {0:10.8f}'.format(ox_moles[0,5]))
        mol_oxides[3] = ox_moles[0,3]
        mol_oxides[5] = ox_moles[0,5]
        #
        mol_elm = core.chem.mol_oxide_to_elem(mol_oxides)
        elm = np.zeros(107)
        for i,sym in enumerate(
            ['Si', 'Ti', 'Al', 'Fe', 'Cr', 'Mn', 'Mg', 'Ni', 'Co', 'Ca', 'Na', 'K', 'P', 'H', 'C', 'O']):
            index = core.chem.PERIODIC_ORDER.tolist().index(sym)
            elm[index] = mol_elm[i]
        #
        wtZrO2 = data[22 if auth_id == 1 else 13]
        if wtZrO2 &gt; 1.0:
            continue
        auth_dat.append(auth_id)
        y_ref.append(wtZrO2)
        elm_ref = np.copy(elm)
        elm[core.chem.PERIODIC_ORDER.tolist().index('Zr')] += wtZrO2/123.218
        elm[core.chem.PERIODIC_ORDER.tolist().index('O')]  += wtZrO2*2.0/123.218
        n = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_conv_elm_to_moles(elm)
        if not rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_test_moles(n):
            print ('Output of intrinsic composition calculation fails tests for permissible values.')
            continue
        s = rMELTS_ZR.cy_Liquid_rMELTS_ZR_order_params(t, p, n)
        mu = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_dgdn(t,p,n)
        y = zirconium_min_affinities(t, p, mu, print_results=False)[0]
        #
        # Estimate zirconium content by zeroing the residuals
        def residual(log_wtZrO2_est, doprint=False):
            global elm_ref, t, p
            wtZrO2_est = np.exp(log_wtZrO2_est)
            elm_est = np.copy(elm_ref)
            elm_est[core.chem.PERIODIC_ORDER.tolist().index('Zr')] += wtZrO2_est/123.218
            elm_est[core.chem.PERIODIC_ORDER.tolist().index('O')]  += wtZrO2_est*2.0/123.218
            n_est = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_conv_elm_to_moles(elm_est)
            mu_est= rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_dgdn(t,p,n_est)
            result = zirconium_min_affinities(t, p, mu_est, print_results=False)[0]
            if doprint:
                print (wtZrO2_est, result)
            return result
        #
        try:
            sol = sci.optimize.root_scalar(residual, 
                                           #x0=np.log(wtZrO2), 
                                           #x1=np.log(wtZrO2*10.), 
                                           rtol=1.e-5,
                                           bracket=[-5,2.3],
                                           method='brentq',
                                           maxiter=50)
            print (sol)
            y_est.append(np.exp(sol.root))
            y_con.append(sol.converged)
        except ValueError:
            print ('Solution not within brackets')
            y_est.append(0.0)
            y_con.append(False)
        #
        print (auth_id, data[2], y)
        s_data.append(auth_id)
        name.append(data[2])
        x_data.append(row_indx)
        y_data.append(y)
        n_liq.append(n)
        s_liq.append(s)
        t_data.append(t)
        p_data.append(p)</code>
          </sec>
          <sec id="cell-35-nb-6" specific-use="notebook-content">
            <p>Residual statistics and a linear regression that provides rough
    estimates of H, S and V forZrSiO4</p>
          </sec>
          <sec id="cell-36-nb-6" specific-use="notebook-code">
            <code language="python">print ('Average residual:', np.mean(np.array(y_data)))
print ('Std Dev residual:', np.std(np.array(y_data)))</code>
          </sec>
          <sec id="cell-37-nb-6" specific-use="notebook-code">
            <code language="python">import statsmodels.api as sm</code>
          </sec>
          <sec id="cell-38-nb-6" specific-use="notebook-code">
            <code language="python">X = sm.add_constant(np.column_stack((t_data, p_data)))
results = sm.OLS(np.array(y_data), X).fit()
results.summary()</code>
          </sec>
          <sec id="cell-39-nb-6" specific-use="notebook-content">
            <sec id="analysis-of-residuals-nb-6">
              <title>Analysis of residuals</title>
              <p>Back calculation of Zr concentrations made by zeroing
      residuals</p>
            </sec>
            <sec id="cell-40-nb-6" specific-use="notebook-code">
              <code language="python">plt.figure(figsize=(15,5))
plt.subplot(1,2,1)
plt.plot(np.array([x for i,x in enumerate(y_ref) if y_con[i]]), 
         np.array([x for i,x in enumerate(y_est) if y_con[i]]), 'r+')
plt.plot(np.array([x for i,x in enumerate(y_ref) if not y_con[i]]), 
         np.array([x for i,x in enumerate(y_est) if not y_con[i]]), 'b+')
plt.plot(np.array([0,1]), np.array([0,1]), 'g-')
plt.ylabel('wt ZrO2 est')
plt.xlabel('wt ZrO2 data')
plt.subplot(1,2,2)
plt.plot(np.array([91.224*1000000.0*x/100.0/123.218 for i,x in enumerate(y_ref) if y_con[i]]), 
         np.array([91.224*1000000.0*x/100.0/123.218 for i,x in enumerate(y_est) if y_con[i]]), 'r+')
plt.plot(np.array([0,7000]), np.array([0,7000]), 'g-')
plt.ylabel('ppm ZrO2 est')
plt.xlabel('ppm ZrO2 data')
#axes = plt.gca()
#axes.set_xlim(0,1)
plt.tight_layout()
plt.show</code>
            </sec>
            <sec id="cell-41-nb-6" specific-use="notebook-content">
              <p>Residuals from fitting the two data sets (red is Watson and
      Harrison, blue is Boehnke et al.)</p>
            </sec>
            <sec id="cell-42-nb-6" specific-use="notebook-code">
              <code language="python">plt.figure(figsize=(15,5))
plt.subplot(1,3,1)
plt.plot([min(x_data),max(x_data)], [0.0,0.0], 'g-')
plt.plot(np.array([x_data[i] for i,x in enumerate(s_data) if x == 1]),
         np.array([y_data[i] for i,x in enumerate(s_data) if x == 1]), 'r+')
plt.plot(np.array([x_data[i] for i,x in enumerate(s_data) if x == 2]),
         np.array([y_data[i] for i,x in enumerate(s_data) if x == 2]), 'b+')
plt.ylabel('residual')
plt.xlabel('index')
plt.subplot(1,3,2)
plt.plot([min(np.array(n_liq)[:,0]),max(np.array(n_liq)[:,0])], [0.0,0.0], 'g-')
plt.plot(np.array([np.array(n_liq)[i,0] for i,x in enumerate(s_data) if x == 1]),
         np.array([y_data[i] for i,x in enumerate(s_data) if x == 1]), 'r+')
plt.plot(np.array([np.array(n_liq)[i,0] for i,x in enumerate(s_data) if x == 2]),
         np.array([y_data[i] for i,x in enumerate(s_data) if x == 2]), 'b+')
plt.ylabel('residual')
plt.xlabel('X SiO2')
plt.subplot(1,3,3)
plt.plot([min(np.array(n_liq)[:,16]),max(np.array(n_liq)[:,16])], [0.0,0.0], 'g-')
plt.plot(np.array([np.array(n_liq)[i,16] for i,x in enumerate(s_data) if x == 1]),
         np.array([y_data[i] for i,x in enumerate(s_data) if x == 1]), 'r+')
plt.plot(np.array([np.array(n_liq)[i,16] for i,x in enumerate(s_data) if x == 2]),
         np.array([y_data[i] for i,x in enumerate(s_data) if x == 2]), 'b+')
plt.ylabel('residual')
plt.xlabel('X ZrSiO4')
plt.tight_layout()
plt.show()</code>
            </sec>
            <sec id="cell-43-nb-6" specific-use="notebook-content">
              <p>Examine residual (zircon affinity) dependence on alkali and
      water concentrations</p>
            </sec>
            <sec id="cell-44-nb-6" specific-use="notebook-code">
              <code language="python">plt.figure(figsize=(15,5))
plt.subplot(1,3,1)
plt.plot([min(np.array(n_liq)[:,11]),max(np.array(n_liq)[:,11])], [0.0,0.0], 'g-')
plt.plot(np.array([np.array(n_liq)[i,11] for i,x in enumerate(s_data) if x == 1]),
         np.array([y_data[i] for i,x in enumerate(s_data) if x == 1]), 'r+')
plt.plot(np.array([np.array(n_liq)[i,11] for i,x in enumerate(s_data) if x == 2]),
         np.array([y_data[i] for i,x in enumerate(s_data) if x == 2]), 'b+')
plt.ylabel('residual')
plt.xlabel('X Na2SiO3')
plt.subplot(1,3,2)
plt.plot([min(np.array(n_liq)[:,12]),max(np.array(n_liq)[:,12])], [0.0,0.0], 'g-')
plt.plot(np.array([np.array(n_liq)[i,12] for i,x in enumerate(s_data) if x == 1]),
         np.array([y_data[i] for i,x in enumerate(s_data) if x == 1]), 'r+')
plt.plot(np.array([np.array(n_liq)[i,12] for i,x in enumerate(s_data) if x == 2]),
         np.array([y_data[i] for i,x in enumerate(s_data) if x == 2]), 'b+')
plt.ylabel('residual')
plt.xlabel('X KAlSiO4')
plt.subplot(1,3,3)
plt.plot([min(np.array(n_liq)[:,14]),max(np.array(n_liq)[:,14])], [0.0,0.0], 'g-')
plt.plot(np.array([np.array(n_liq)[i,14] for i,x in enumerate(s_data) if x == 1]),
         np.array([y_data[i] for i,x in enumerate(s_data) if x == 1]), 'r+')
plt.plot(np.array([np.array(n_liq)[i,14] for i,x in enumerate(s_data) if x == 2]),
         np.array([y_data[i] for i,x in enumerate(s_data) if x == 2]), 'b+')
plt.ylabel('residual')
plt.xlabel('X H2O')
plt.tight_layout()
plt.show()</code>
            </sec>
            <sec id="cell-45-nb-6" specific-use="notebook-content">
              <p>Examine residual (zircon affinity) dependence on
      temperature</p>
            </sec>
            <sec id="cell-46-nb-6" specific-use="notebook-code">
              <code language="python">plt.plot([min(t_data),max(t_data)], [0.0,0.0], 'g-')
plt.plot(np.array([t_data[i] for i,x in enumerate(s_data) if x == 1]),
         np.array([y_data[i] for i,x in enumerate(s_data) if x == 1]), 'r+')
plt.plot(np.array([t_data[i] for i,x in enumerate(s_data) if x == 2]),
         np.array([y_data[i] for i,x in enumerate(s_data) if x == 2]), 'b+')
plt.ylabel('residual')
plt.xlabel('T K')
plt.show()</code>
            </sec>
            <sec id="cell-47-nb-6" specific-use="notebook-content">
              <p>Examine residual (zircon affinity) dependence on pressure</p>
            </sec>
            <sec id="cell-48-nb-6" specific-use="notebook-code">
              <code language="python">plt.plot([min(p_data),max(p_data)], [0.0,0.0], 'g-')
plt.plot(np.array([p_data[i] for i,x in enumerate(s_data) if x == 1]),
         np.array([y_data[i] for i,x in enumerate(s_data) if x == 1]), 'r+')
plt.plot(np.array([p_data[i] for i,x in enumerate(s_data) if x == 2]),
         np.array([y_data[i] for i,x in enumerate(s_data) if x == 2]), 'b+')

plt.ylabel('residual')
plt.xlabel('P (GPa)')
plt.show()</code>
            </sec>
            <sec id="cell-49-nb-6" specific-use="notebook-content">
              <p>Examine Zr-speciation of the liquid</p>
            </sec>
            <sec id="cell-50-nb-6" specific-use="notebook-code">
              <code language="python">plt.figure(figsize=(15,5))
plt.subplot(1,3,1)
plt.plot(np.array(x_data), np.array(n_liq)[:,16], 'r+')
plt.ylabel('n ZrSiO4')
plt.xlabel('index')
plt.subplot(1,3,2)
plt.plot(np.array(x_data), np.array(s_liq)[:,1], 'r+')
plt.ylabel('n Na4ZrSi2O8')
plt.xlabel('index')
plt.subplot(1,3,3)
plt.plot(np.array(x_data), np.array(s_liq)[:,2], 'r+')
plt.ylabel('n K4ZrSi2O8')
plt.xlabel('index')
plt.tight_layout()
plt.show()</code>
            </sec>
            <sec id="cell-51-nb-6" specific-use="notebook-code">
              <code language="python">plt.figure(figsize=(15,5))
plt.semilogy(np.array(x_data), np.array(n_liq)[:,16], 'r+', label='ZrSiO4')
plt.semilogy(np.array(x_data), np.array(s_liq)[:,1],  'g+', label='Na4ZrSi2O8')
plt.semilogy(np.array(x_data), np.array(s_liq)[:,2],  'b+', label='K4ZrSi2O8')
plt.ylabel('n Zr species')
plt.xlabel('index')
plt.legend()
plt.show()</code>
            </sec>
            <sec id="cell-52-nb-6" specific-use="notebook-code">
              <code language="python">plt.figure(figsize=(15,5))
plt.semilogy(np.array(n_liq)[:,11], np.array(n_liq)[:,16], 'r+', label='ZrSiO4')
plt.semilogy(np.array(n_liq)[:,11], np.array(s_liq)[:,1],  'g+', label='Na4ZrSi2O8')
plt.semilogy(np.array(n_liq)[:,11], np.array(s_liq)[:,2],  'b+', label='K4ZrSi2O8')
plt.ylabel('n Zr species')
plt.xlabel('n Na2SiO3')
plt.legend()
plt.show()</code>
            </sec>
            <sec id="cell-53-nb-6" specific-use="notebook-code">
              <code language="python">plt.figure(figsize=(15,5))
plt.semilogy(np.array(n_liq)[:,12], np.array(n_liq)[:,16], 'r+', label='ZrSiO4')
plt.semilogy(np.array(n_liq)[:,12], np.array(s_liq)[:,1],  'g+', label='Na4ZrSi2O8')
plt.semilogy(np.array(n_liq)[:,12], np.array(s_liq)[:,2],  'b+', label='K4ZrSi2O8')
plt.ylabel('n Zr species')
plt.xlabel('n KAlSiO4')
plt.legend()
plt.show()</code>
            </sec>
            <sec id="cell-54-nb-6" specific-use="notebook-content">
              <p>Remember these results before lists are over written with the
      peralkaline dataset</p>
            </sec>
            <sec id="cell-55-nb-6" specific-use="notebook-code">
              <code language="python">name_all   = [] + name
x_data_all = [] + x_data 
y_data_all = [] + y_data
n_liq_all  = [] + n_liq
s_liq_all  = [] + s_liq
t_data_all = [] + t_data
p_data_all = [] + p_data
s_data_all = [] + s_data
y_est_all  = [] + y_est
y_con_all  = [] + y_con
y_ref_all  = [] + y_ref</code>
            </sec>
            <sec id="cell-56-nb-6" specific-use="notebook-content">
    </sec>
          </sec>
          <sec id="evaluate-peralkaline-compositions-reported-in-watson-1979-nb-6">
            <title>Evaluate peralkaline compositions reported in Watson
    (1979)</title>
          </sec>
          <sec id="cell-57-nb-6" specific-use="notebook-code">
            <code language="python">df3 = pd.read_excel('Watson_1979.xlsx')
df3.fillna(0)</code>
          </sec>
          <sec id="cell-58-nb-6" specific-use="notebook-code">
            <code language="python">for i,x in enumerate(df3.columns):
    print (i+1, x)</code>
          </sec>
          <sec id="cell-59-nb-6" specific-use="notebook-content">
            <p>Re-estimate “optimal” parameters for this data set</p>
          </sec>
          <sec id="cell-60-nb-6" specific-use="notebook-code">
            <code language="python">print(ref_param_values)</code>
          </sec>
          <sec id="cell-61-nb-6" specific-use="notebook-code">
            <code language="python">adj_H_ZrSiO4 = 100000.0 + 22020.0    + 107500.0    - 32110.0
adj_S_ZrSiO4 =               40.0242 +     83.7465 -    27.8937
adj_V_ZrSiO4 =                0.5448 -      0.2236 -     0.110
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(5,  ref_param_values[ 5] + adj_H_ZrSiO4 - 225000.0 - 50000.0) # Na4ZrSi2O8
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(6,  ref_param_values[ 6] + adj_S_ZrSiO4)
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(7,  ref_param_values[ 7] + adj_V_ZrSiO4)
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(8,  ref_param_values[ 8] + adj_H_ZrSiO4 -  75000.0 - 50000.0)  # K4ZrSi2O8
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(9,  ref_param_values[ 9] + adj_S_ZrSiO4)
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(10, ref_param_values[10] + adj_V_ZrSiO4)
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(11, ref_param_values[11] + adj_H_ZrSiO4) # ZrSiO4
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(12, ref_param_values[12] + adj_S_ZrSiO4)
rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(13, ref_param_values[13] + adj_V_ZrSiO4)</code>
          </sec>
          <sec id="cell-62-nb-6" specific-use="notebook-code">
            <code language="python">param_values = rMELTS_ZR.cy_Liquid_rMELTS_ZR_get_param_values()
print (param_values)</code>
          </sec>
          <sec id="cell-63-nb-6" specific-use="notebook-content">
            <p>Analyze the data set</p>
          </sec>
          <sec id="cell-64-nb-6" specific-use="notebook-code">
            <code language="python">df_iterator = df3.itertuples()
name = []
x_data = []
y_data = []
n_liq = []
s_liq = []
t_data = []
p_data = []
s_data = []
y_est = []
y_con = []
y_ref = []
jacobian = []
for row_indx,data in enumerate(df_iterator):
    auth_id = data[1]
    t = data[4] + 273.15
    p = data[5]
    grm_oxides = {
        'SiO2':  data[6], 
        'TiO2':  0.0, 
        'Al2O3': data[7], 
        'Fe2O3': max(data[8], 0.01),
        'Cr2O3': 0.0, 
        'FeO':   0.0, 
        'MnO':   0.0,
        'MgO':   0.0, 
        'NiO':   0.0, 
        'CoO':   0.0,
        'CaO':   max(data[9], 0.01), 
        'Na2O':  data[10], 
        'K2O':   data[11], 
        'P2O5':  0.0, 
        'H2O':   6.5,
        'CO2':   0.01
    }
    auth_dat.append(3)
    tot_grm_oxides = 0.0
    for key in grm_oxides.keys():
        tot_grm_oxides += grm_oxides[key]
    mol_oxides = core.chem.format_mol_oxide_comp(grm_oxides, convert_grams_to_moles=True)
    #
    if data[8] &gt; 0.0:
        NNO = db.redox_buffer(t, p, buffer='NNO', method='LEPR')
        ox_moles = mol_oxides.reshape(1,nc-1)
        db.redox_state(t, p, 
                       oxide_comp={'Liq':ox_moles}, 
                       logfO2=np.array(NNO), 
                       phase_of_interest='Liq', method='Kress91')
        #print ('n Fe2O3   at NNO   moles = {0:10.8f}'.format(ox_moles[0,3]))
        #print ('n FeO     at NNO   moles = {0:10.8f}'.format(ox_moles[0,5]))
        mol_oxides[3] = ox_moles[0,3]
        mol_oxides[5] = ox_moles[0,5]
        #
    mol_elm = core.chem.mol_oxide_to_elem(mol_oxides)
    elm = np.zeros(107)
    for i,sym in enumerate(
        ['Si', 'Ti', 'Al', 'Fe', 'Cr', 'Mn', 'Mg', 'Ni', 'Co', 'Ca', 'Na', 'K', 'P', 'H', 'C', 'O']):
        index = core.chem.PERIODIC_ORDER.tolist().index(sym)
        elm[index] = mol_elm[i]
    #
    wtZrO2 = 100.0*123.218*data[2]/91.224/1000000.0
    y_ref.append(wtZrO2)
    elm_ref = np.copy(elm)
    elm[core.chem.PERIODIC_ORDER.tolist().index('Zr')] += wtZrO2/123.218
    elm[core.chem.PERIODIC_ORDER.tolist().index('O')]  += wtZrO2*2.0/123.218
    n = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_conv_elm_to_moles(elm)
    if not rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_test_moles(n):
        print ('Output of intrinsic composition calculation fails tests for permissible values.')
        continue
    s = rMELTS_ZR.cy_Liquid_rMELTS_ZR_order_params(t, p, n)
    mu = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_dgdn(t, p, n)
    y = zirconium_min_affinities(t, p, mu, print_results=False)[0]
    #
    # Estimate zirconium content by zeroing the residuals
    def residual(log_wtZrO2_est, doprint=False):
        global elm_ref, t, p
        wtZrO2_est = np.exp(log_wtZrO2_est)
        elm_est = np.copy(elm_ref)
        elm_est[core.chem.PERIODIC_ORDER.tolist().index('Zr')] += wtZrO2_est/123.218
        elm_est[core.chem.PERIODIC_ORDER.tolist().index('O')]  += wtZrO2_est*2.0/123.218
        n_est = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_conv_elm_to_moles(elm_est)
        mu_est= rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_dgdn(t,p,n_est)
        result = zirconium_min_affinities(t, p, mu_est, print_results=False)[0]
        if doprint:
            print (wtZrO2_est, result)
        return result
    #
    try:
        sol = sci.optimize.root_scalar(residual, 
                                       #x0=np.log(wtZrO2), 
                                       #x1=np.log(wtZrO2*10.), 
                                       rtol=1.e-5,
                                       bracket=[-5,2.3],
                                       method='brentq',
                                       maxiter=50)
        print (sol)
        y_est.append(np.exp(sol.root))
        y_con.append(sol.converged)
    except ValueError:
        print ('Solution not within brackets')
        y_est.append(0.0)
        y_con.append(False)
    #
    dparam = []
    for i in range(0,rMELTS_ZR.cy_Liquid_rMELTS_ZR_get_param_number()):
        D2gDnDparam = rMELTS_ZR.cy_Liquid_rMELTS_ZR_dparam_dgdn(t, p, n, i)
        dparam.append(D2gDnDparam[16])
    #
    print (auth_id, data[2], y)
    s_data.append(auth_id)
    name.append(data[12])
    x_data.append(row_indx)
    y_data.append(y)
    n_liq.append(n)
    s_liq.append(s)
    t_data.append(t)
    p_data.append(p)
    jacobian.append(dparam)</code>
          </sec>
          <sec id="cell-65-nb-6" specific-use="notebook-content">
            <p>Residual statistics</p>
          </sec>
          <sec id="cell-66-nb-6" specific-use="notebook-code">
            <code language="python">print ('Average residual:', np.mean(np.array(y_data)))
print ('Std Dev residual:', np.std(np.array(y_data)))</code>
          </sec>
          <sec id="cell-67-nb-6" specific-use="notebook-code">
            <code language="python">for i,y in enumerate(y_data):
    if y &gt; 40000.0 or y &lt; -20000.0:
        print ('{0:10.2f} {1:5s} {2:&lt;10s} {3:10.2f} {4:10.2f} {5:7.3f}'.format(y, str(s_data[i]), name[i], t_data[i], p_data[i], y_ref[i]))</code>
          </sec>
          <sec id="cell-68-nb-6" specific-use="notebook-code">
            <code language="python">results = sm.OLS(np.array(y_data), np.array(t_data)).fit()
results.summary()</code>
          </sec>
          <sec id="cell-69-nb-6" specific-use="notebook-content">
            <p>Select a subset of data points to identify in plots (these are
    “natural” compositions - with iron and calcium)</p>
          </sec>
          <sec id="cell-70-nb-6" specific-use="notebook-code">
            <code language="python">selection = [name.index('PPK(g)'), name.index('PK(g)'), name.index('KPK(g)'), name.index('K(g)')]</code>
          </sec>
          <sec id="cell-71-nb-6" specific-use="notebook-content">
            <p>Estimated Zr concentration plotted against measured
    concentration</p>
          </sec>
          <sec id="cell-72-nb-6" specific-use="notebook-code">
            <code language="python">plt.figure(figsize=(15,5))
plt.subplot(1,2,1)
plt.plot(np.array([x for i,x in enumerate(y_ref) if y_con[i]]), 
         np.array([x for i,x in enumerate(y_est) if y_con[i]]), 'r+')
plt.plot(np.array([x for i,x in enumerate(y_ref) if not y_con[i]]), 
         np.array([x for i,x in enumerate(y_est) if not y_con[i]]), 'b+')
plt.plot(np.array([y_ref[i] for i in selection]), 
         np.array([y_est[i] for i in selection]), 'ko')
plt.plot(np.array([0,max(y_ref)]), np.array([0,max(y_ref)]), 'g-')
plt.ylabel('wt ZrO2 est')
plt.xlabel('wt ZrO2 data')
plt.subplot(1,2,2)
plt.plot(np.array([91.224*1000000.0*x/100.0/123.218 for i,x in enumerate(y_ref) if y_con[i]]), 
         np.array([91.224*1000000.0*x/100.0/123.218 for i,x in enumerate(y_est) if y_con[i]]), 'r+')
plt.plot(np.array([0,91.224*1000000.0*max(y_ref)/100.0/123.218]), np.array([0,91.224*1000000.0*max(y_ref)/100.0/123.218]), 'g-')
plt.ylabel('ppm ZrO2 est')
plt.xlabel('ppm ZrO2 data')
#axes = plt.gca()
#axes.set_xlim(0,1)
plt.tight_layout()
plt.show</code>
          </sec>
          <sec id="cell-73-nb-6" specific-use="notebook-content">
            <p>Examine residuals (zircon affinity) for the Watson (1979) data
    set</p>
          </sec>
          <sec id="cell-74-nb-6" specific-use="notebook-code">
            <code language="python">plt.figure(figsize=(15,5))
plt.subplot(1,3,1)
plt.plot([min(x_data),max(x_data)], [0.0,0.0], 'g-')
plt.plot(np.array(x_data), np.array(y_data), 'r+')
plt.plot(np.array([x_data[i] for i in selection]), np.array([y_data[i] for i in selection]), 'ko')
plt.ylabel('residual')
plt.xlabel('index')
plt.subplot(1,3,2)
plt.plot([min(np.array(n_liq)[:,0]),max(np.array(n_liq)[:,0])], [0.0,0.0], 'g-')
plt.plot(np.array(np.array(n_liq)[:,0]), np.array(y_data), 'r+')
plt.plot(np.array(np.array([n_liq[i] for i in selection])[:,0]), np.array([y_data[i] for i in selection]), 'ko')
plt.ylabel('residual')
plt.xlabel('X SiO2')
plt.subplot(1,3,3)
plt.plot([min(np.array(n_liq)[:,16]),max(np.array(n_liq)[:,16])], [0.0,0.0], 'g-')
plt.plot(np.array(np.array(n_liq)[:,16]), np.array(y_data), 'r+')
plt.plot(np.array(np.array([n_liq[i] for i in selection])[:,16]), np.array([y_data[i] for i in selection]), 'ko')
plt.ylabel('residual')
plt.xlabel('X ZrSiO4')
plt.tight_layout()
plt.show()</code>
          </sec>
          <sec id="cell-75-nb-6" specific-use="notebook-content">
            <p>Examine residuals (zircon affinity) dependence on alkali
    content</p>
          </sec>
          <sec id="cell-76-nb-6" specific-use="notebook-code">
            <code language="python">plt.figure(figsize=(15,5))
plt.subplot(1,2,1)
plt.plot([min(np.array(n_liq)[:,11]),max(np.array(n_liq)[:,11])], [0.0,0.0], 'g-')
plt.plot(np.array(np.array(n_liq)[:,11]), np.array(y_data), 'r+')
plt.plot(np.array(np.array([n_liq[i] for i in selection])[:,11]), np.array([y_data[i] for i in selection]), 'ko')
plt.ylabel('residual')
plt.xlabel('X Na2SiO3')
plt.subplot(1,2,2)
plt.plot([min(np.array(n_liq)[:,12]),max(np.array(n_liq)[:,12])], [0.0,0.0], 'g-')
plt.plot(np.array(np.array(n_liq)[:,12]), np.array(y_data), 'r+')
plt.plot(np.array(np.array([n_liq[i] for i in selection])[:,12]), np.array([y_data[i] for i in selection]), 'ko')
plt.ylabel('residual')
plt.xlabel('X KAlSiO4')
plt.tight_layout()
plt.show()</code>
          </sec>
          <sec id="cell-77-nb-6" specific-use="notebook-content">
            <p>Examine residuals (zircon affinity) dependence on temperature</p>
          </sec>
          <sec id="cell-78-nb-6" specific-use="notebook-code">
            <code language="python">plt.figure(figsize=(15,5))
plt.plot([min(t_data)-273.15,max(t_data)-273.15], [0.0,0.0], 'g-')
plt.plot(np.array(t_data)-273.15, np.array(y_data), 'r+')
plt.plot(np.array([t_data[i] for i in selection])-273.15, np.array([y_data[i] for i in selection]), 'ko')
plt.ylabel('residual')
plt.xlabel('T °C')
plt.show()</code>
          </sec>
          <sec id="cell-79-nb-6" specific-use="notebook-content">
            <p>Examine Zr-speciation</p>
          </sec>
          <sec id="cell-80-nb-6" specific-use="notebook-code">
            <code language="python">plt.figure(figsize=(15,5))
plt.subplot(1,3,1)
plt.plot(np.array(x_data), np.array(n_liq)[:,16], 'r+')
plt.plot(np.array([x_data[i] for i in selection]), np.array([n_liq[i] for i in selection])[:,16], 'ko')
plt.ylabel('n ZrSiO4')
plt.xlabel('index')
plt.subplot(1,3,2)
plt.plot(np.array(x_data), np.array(s_liq)[:,1], 'r+')
plt.plot(np.array([x_data[i] for i in selection]), np.array([s_liq[i] for i in selection])[:,1], 'ko')
plt.ylabel('n Na4ZrSi2O8')
plt.xlabel('index')
plt.subplot(1,3,3)
plt.plot(np.array(x_data), np.array(s_liq)[:,2], 'r+')
plt.plot(np.array([x_data[i] for i in selection]), np.array([s_liq[i] for i in selection])[:,2], 'ko')
plt.ylabel('n K4ZrSi2O8')
plt.xlabel('index')
plt.tight_layout()
plt.show()</code>
          </sec>
          <sec id="cell-81-nb-6" specific-use="notebook-code">
            <code language="python">plt.figure(figsize=(15,5))
plt.subplot(1,2,1)
plt.semilogy(np.array(x_data), np.array(n_liq)[:,16], 'r+', label='ZrSiO4')
plt.semilogy(np.array(x_data), np.array(s_liq)[:,1],  'g+', label='Na4ZrSi2O8')
plt.semilogy(np.array(x_data), np.array(s_liq)[:,2],  'b+', label='K4ZrSi2O8')
plt.semilogy(np.array([x_data[i] for i in selection]), np.array([n_liq[i] for i in selection])[:,16], 'ro')
plt.semilogy(np.array([x_data[i] for i in selection]), np.array([s_liq[i] for i in selection])[:,1],  'go')
plt.semilogy(np.array([x_data[i] for i in selection]), np.array([s_liq[i] for i in selection])[:,2],  'bo')
plt.ylabel('n Zr species')
plt.xlabel('index')
plt.legend()
plt.subplot(1,2,2)
plt.semilogy(np.array(x_data), np.array(s_liq)[:,1],  'g+')
plt.semilogy(np.array([x_data[i] for i in selection]), np.array([s_liq[i] for i in selection])[:,1],  'go')
plt.ylabel('n Na4ZrSi2O8')
plt.xlabel('index')
plt.tight_layout()
plt.show()</code>
          </sec>
          <sec id="cell-82-nb-6" specific-use="notebook-code">
            <code language="python">plt.figure(figsize=(15,5))
plt.subplot(1,2,1)
plt.semilogy(np.array(n_liq)[:,11], np.array(n_liq)[:,16], 'r+', label='ZrSiO4')
plt.semilogy(np.array(n_liq)[:,11], np.array(s_liq)[:,1],  'g+', label='Na4ZrSi2O8')
plt.semilogy(np.array(n_liq)[:,11], np.array(s_liq)[:,2],  'b+', label='K4ZrSi2O8')
plt.semilogy(np.array([n_liq[i] for i in selection])[:,11], np.array([n_liq[i] for i in selection])[:,16], 'ro')
plt.semilogy(np.array([n_liq[i] for i in selection])[:,11], np.array([s_liq[i] for i in selection])[:,1],  'go')
plt.semilogy(np.array([n_liq[i] for i in selection])[:,11], np.array([s_liq[i] for i in selection])[:,2],  'bo')
plt.ylabel('n Zr species')
plt.xlabel('n Na2SiO3')
plt.legend()
plt.subplot(1,2,2)
plt.semilogy(np.array(n_liq)[:,11], np.array(s_liq)[:,1],  'g+')
plt.semilogy(np.array([n_liq[i] for i in selection])[:,11], np.array([s_liq[i] for i in selection])[:,1],  'go')
plt.ylabel('n Na4ZrSi2O8')
plt.xlabel('n Na2SiO3')
plt.tight_layout()
plt.show()</code>
          </sec>
          <sec id="cell-83-nb-6" specific-use="notebook-code">
            <code language="python">plt.figure(figsize=(15,5))
plt.subplot(1,2,1)
plt.semilogy(np.array(n_liq)[:,12], np.array(n_liq)[:,16], 'r+', label='ZrSiO4')
plt.semilogy(np.array(n_liq)[:,12], np.array(s_liq)[:,1],  'g+', label='Na4ZrSi2O8')
plt.semilogy(np.array(n_liq)[:,12], np.array(s_liq)[:,2],  'b+', label='K4ZrSi2O8')
plt.semilogy(np.array([n_liq[i] for i in selection])[:,12], np.array([n_liq[i] for i in selection])[:,16], 'ro')
plt.semilogy(np.array([n_liq[i] for i in selection])[:,12], np.array([s_liq[i] for i in selection])[:,1],  'go')
plt.semilogy(np.array([n_liq[i] for i in selection])[:,12], np.array([s_liq[i] for i in selection])[:,2],  'bo')
plt.ylabel('n Zr species')
plt.xlabel('n KAlSiO4')
plt.legend()
plt.subplot(1,2,2)
plt.semilogy(np.array(n_liq)[:,12], np.array(s_liq)[:,2],  'b+')
plt.semilogy(np.array([n_liq[i] for i in selection])[:,12], np.array([s_liq[i] for i in selection])[:,2],  'bo')
plt.ylabel('n K4ZrSi2O8')
plt.xlabel('n KAlSiO4')
plt.tight_layout()
plt.show()</code>
          </sec>
          <sec id="cell-84-nb-6" specific-use="notebook-content">
            <p>Select Watson (1979) data points for inclusion in final data
    fit</p>
          </sec>
          <sec id="cell-85-nb-6" specific-use="notebook-code">
            <code language="python">#selection = [name.index('PPK(g)'), name.index('PK(g)'), name.index('KPK(g)'), name.index('K(g)')]
selection = []</code>
          </sec>
          <sec id="cell-86-nb-6" specific-use="notebook-code">
            <code language="python">name_all   += [name[i] for i in selection]
x_data_all += [x_data[i] for i in selection]
y_data_all += [y_data[i] for i in selection]
n_liq_all  += [n_liq[i] for i in selection]
s_liq_all  += [s_liq[i] for i in selection]
t_data_all += [t_data[i] for i in selection]
p_data_all += [p_data[i] for i in selection]
s_data_all += [s_data[i] for i in selection]
y_est_all  += [y_est[i] for i in selection]
y_con_all  += [y_con[i] for i in selection]
y_ref_all  += [y_ref[i] for i in selection]</code>
          </sec>
          <sec id="cell-87-nb-6" specific-use="notebook-code">
            <code language="python">plt.figure(figsize=(15,5))
plt.plot(np.array([2*x[11]/x[12] for x in n_liq_all]), np.array([y[1]/y[2] for y in s_liq_all]), 'r+')
plt.plot(np.array([0,5]), np.array([0,5]), 'g-')
plt.ylabel('n Na4ZrSi2O8 / n K4ZrSi2O8')
plt.xlabel('n 2*Na2SiO3 / n KAlSiO4')
plt.show()</code>
          </sec>
          <sec id="cell-88-nb-6" specific-use="notebook-content">
  </sec>
          <sec id="optimize-parameters-from-experimental-data-sets-nb-6">
            <title>Optimize parameters from experimental data sets</title>
            <p>Note that this process resets the parameter array to the
    resulting optimization</p>
          </sec>
          <sec id="cell-89-nb-6" specific-use="notebook-code">
            <code language="python">def res_func(x, t_data, p_data, n_liq, 
             ref_param_values, rMELTS_ZR, adj_H_ZrSiO4, adj_S_ZrSiO4, adj_V_ZrSiO4, use_weighting, 
             use_priors, prior_weight, 
             zirconium_min_affinities):
    y = []
    priors = []
    rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(5,  ref_param_values[ 5] + adj_H_ZrSiO4 - 225000.0 + x[0]) # Na4ZrSi2O8
    rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(6,  ref_param_values[ 6] + adj_S_ZrSiO4            + x[3])
    rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(7,  ref_param_values[ 7] + adj_V_ZrSiO4            + x[4])
    rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(8,  ref_param_values[ 8] + adj_H_ZrSiO4 -  75000.0 + x[1]) # K4ZrSi2O8
    rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(9,  ref_param_values[ 9] + adj_S_ZrSiO4            + x[3])
    rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(10, ref_param_values[10] + adj_V_ZrSiO4            + x[4])
    rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(11, ref_param_values[11] + adj_H_ZrSiO4            + x[2]) # ZrSiO4
    rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(12, ref_param_values[12] + adj_S_ZrSiO4            + x[3])
    rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(13, ref_param_values[13] + adj_V_ZrSiO4            + x[4])
    for t, p, n in zip(t_data, p_data, n_liq):
        mu = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_dgdn(t, p, n)
        s = rMELTS_ZR.cy_Liquid_rMELTS_ZR_order_params(t, p, n)
        affinity = zirconium_min_affinities(t, p, mu, print_results=False)[0]
        weight = 1.0 
        if use_weighting:
            weight = ((2*n[11]/n[12])/(s[1]/s[2]) + (s[1]/s[2])/(2*n[11]/n[12]))/2  # += (2*n[11]/n[12] - s[1]/s[2])**2
        y.append(affinity*weight)
        if use_priors:
            priors.append(prior_weight*np.log((2*n[11]/n[12])/(s[1]/s[2])))
    return np.array(y+priors)</code>
          </sec>
          <sec id="cell-90-nb-6" specific-use="notebook-content">
            <p>Bayesian prior: <inline-formula><alternatives><tex-math><![CDATA[w_p \log \left( \frac{ \frac{2 n_{12}}{n_{13}} }{ \frac{y_{19}}{y_{20}} } \right)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mfrac><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>13</mml:mn></mml:msub></mml:mfrac><mml:mfrac><mml:msub><mml:mi>y</mml:mi><mml:mn>19</mml:mn></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mn>20</mml:mn></mml:msub></mml:mfrac></mml:mfrac><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    to impose Watson’s Na/K observation</p>
          </sec>
          <sec id="cell-91-nb-6" specific-use="notebook-code">
            <code language="python">use_weighting = False
use_priors = True
prior_weight = 2500.0
#
# perform fit
fit_res = sci.optimize.least_squares(res_func, 
                                     [0.0, 0.0, -50000.0, 0, 0],
                                     bounds=(np.array([ -np.inf, -np.inf, -np.inf, -np.inf, -np.inf]), 
                                             np.array([  np.inf,  np.inf,  np.inf,  np.inf,  np.inf])
                                            ),
                                     jac='3-point',
                                     method='trf',
                                     ftol=None, gtol=1.0e-8,
                                     args=(t_data_all, p_data_all, n_liq_all, ref_param_values, rMELTS_ZR, 
                                           adj_H_ZrSiO4, adj_S_ZrSiO4, adj_V_ZrSiO4, use_weighting, use_priors, 
                                           prior_weight, zirconium_min_affinities),
                                     verbose=2)
#
# recalculate residuals associated with the reaction affinity
y_data_rev = res_func(fit_res.x, t_data_all, p_data_all, n_liq_all, 
                      ref_param_values, rMELTS_ZR, adj_H_ZrSiO4, adj_S_ZrSiO4, adj_V_ZrSiO4, False, False, 
                      prior_weight, zirconium_min_affinities)
rms_residuals = np.sqrt(np.mean(y_data_rev**2))
#
# sigma is calculated from teh full Jacobian, including rows associated with priors
sigma = np.sqrt(np.diagonal(np.linalg.inv(2*np.matmul(fit_res.jac.T, fit_res.jac)))*rms_residuals**2)
print ('X:', fit_res.x)
print ('grad', fit_res.grad)
print ('Optimality:', fit_res.optimality)
print ('nfev:', fit_res.nfev)
print ('njev:', fit_res.njev)
print ('status:', fit_res.status)
print ('message:', fit_res.message)
print ('success:', fit_res.success)
print ('rms of affinity residuals', rms_residuals)
print ('H Na4ZrSi2O8 old: {0:12.2f} new: {1:12.2f} dif: {2:12.2f} param: {3:12.2f} sigma: {4:12.5g}'.format(
    ref_param_values[ 5] + adj_H_ZrSiO4 - 225000.0, 
    ref_param_values[ 5] + adj_H_ZrSiO4 - 225000.0 + fit_res.x[0],
    fit_res.x[0], - 225000.0 + fit_res.x[0], sigma[0]))
print ('H K4ZrSi2O8  old: {0:12.2f} new: {1:12.2f} dif: {2:12.2f} param: {3:12.2f} sigma: {4:12.5g}'.format(
    ref_param_values[ 8] + adj_H_ZrSiO4 -  75000.0, 
    ref_param_values[ 8] + adj_H_ZrSiO4 -  75000.0 + fit_res.x[1], 
    fit_res.x[1], -  75000.0 + fit_res.x[1], sigma[1]))
print ('H ZrSiO4     old: {0:12.2f} new: {1:12.2f} dif: {2:12.2f} param: {3:12.2f} sigma: {4:12.5g}'.format(
    ref_param_values[11] + adj_H_ZrSiO4,
    ref_param_values[11] + adj_H_ZrSiO4 + fit_res.x[2],
    fit_res.x[2], adj_H_ZrSiO4 + fit_res.x[2], sigma[2]))
print ('S ZrSiO4     old: {0:12.2f} new: {1:12.2f} dif: {2:12.2f} param: {3:12.2f} sigma: {4:12.5g}'.format(
    ref_param_values[12] + adj_S_ZrSiO4,
    ref_param_values[12] + adj_S_ZrSiO4 + fit_res.x[3],
    fit_res.x[3], adj_S_ZrSiO4 + fit_res.x[3], sigma[3]))
print ('V ZrSiO4     old: {0:12.2f} new: {1:12.2f} dif: {2:12.2f} param: {3:12.2f} sigma: {4:12.5g}'.format(
    ref_param_values[13] + adj_V_ZrSiO4,
    ref_param_values[13] + adj_V_ZrSiO4 + fit_res.x[4],
    fit_res.x[4], adj_V_ZrSiO4 + fit_res.x[4], sigma[4]))
print ('S Na4ZrSi2O8 old: {0:12.2f} new: {1:12.2f} dif: {2:12.2f} param: {3:12.2f} sigma: {4:12.5g}'.format(
    ref_param_values[ 6] + adj_S_ZrSiO4,
    ref_param_values[ 6] + adj_S_ZrSiO4 + fit_res.x[3],
    fit_res.x[3], 0.0, sigma[3]))
print ('V Na4ZrSi2O8 old: {0:12.2f} new: {1:12.2f} dif: {2:12.2f} param: {3:12.2f} sigma: {4:12.5g}'.format(
    ref_param_values[ 7] + adj_V_ZrSiO4,
    ref_param_values[ 7] + adj_V_ZrSiO4 + fit_res.x[4],
    fit_res.x[4], 0.0, sigma[4]))
print ('S K4ZrSi2O8  old: {0:12.2f} new: {1:12.2f} dif: {2:12.2f} param: {3:12.2f} sigma: {4:12.5g}'.format(
    ref_param_values[ 9] + adj_S_ZrSiO4,
    ref_param_values[ 9] + adj_S_ZrSiO4 + fit_res.x[3],
    fit_res.x[3], 0.0, sigma[3]))
print ('V K4ZrSi2O8  old: {0:12.2f} new: {1:12.2f} dif: {2:12.2f} param: {3:12.2f} sigma: {4:12.5g}'.format(
    ref_param_values[10] + adj_V_ZrSiO4,
    ref_param_values[10] + adj_V_ZrSiO4 + fit_res.x[4],
    fit_res.x[4], 0.0, sigma[4]))</code>
          </sec>
          <sec id="cell-92-nb-6" specific-use="notebook-content">
            <p>Construct a parameter correlation matrix from the Jacobian
    evaluated at the optimal solution</p>
          </sec>
          <sec id="cell-93-nb-6" specific-use="notebook-code">
            <code language="python">print ('Estimated parameter correlation matrix:')
cov_mat = np.linalg.inv(2*np.matmul(fit_res.jac.T, fit_res.jac))*rms_residuals**2
labl = ['', 'H Na4', 'H K4', 'H Zr', 'S Zr', 'V Zr']
for x in labl:
    print ('{0:&gt;12.12s}'.format(x), end=' ')
print ('')
for i,row in enumerate(cov_mat):
    print ('{0:&gt;12.12s}'.format(labl[i+1]), end=' ')
    for j,col in enumerate(row):
        print ('{0:12.6g}'.format(col/sigma[i]/sigma[j]), end=' ')
    print ('')</code>
          </sec>
          <sec id="cell-94-nb-6" specific-use="notebook-content">
            <p>Decompose the Jacobian (evaluated at the optimal solution) using
    singular value analysis</p>
          </sec>
          <sec id="cell-95-nb-6" specific-use="notebook-code">
            <code language="python">u,s,vT = np.linalg.svd(fit_res.jac)
for col in s:
    print ('{0:13.6g}'.format(col), end=' ')
print ('')
print ('')
for row in vT.T:
    for col in row:
        print ('{0:13.6g}'.format(col), end=' ')
    print ('')</code>
          </sec>
          <sec id="cell-96-nb-6" specific-use="notebook-content">
            <p>Residual statistics (compared to guessed parameter fit)</p>
          </sec>
          <sec id="cell-97-nb-6" specific-use="notebook-code">
            <code language="python">print ('Average residual before: {0:13.6g} fit: {1:13.6g} fit+prior: {2:13.6g}'.format(np.mean(np.array(y_data_all)), np.mean(y_data_rev), np.mean(fit_res.fun)))
print ('Std Dev residual before: {0:13.6g} fit: {1:13.6g} fit+prior: {2:13.6g}'.format(np.std(np.array(y_data_all)),  np.std(y_data_rev),  np.std(fit_res.fun)))</code>
          </sec>
          <sec id="cell-98-nb-6" specific-use="notebook-content">
            <p>Monte Carlo analysis of parameter variance</p>
          </sec>
          <sec id="cell-99-nb-6" specific-use="notebook-code">
            <code language="python">deviates = np.random.multivariate_normal(fit_res.x, cov_mat, size=100)
plt.figure(figsize=(20,5))
plt.subplot(1,5,1)
plt.hist(deviates[:,0], orientation='horizontal')
plt.title('H Na4ZrSi2O8')
plt.subplot(1,5,2)
plt.hist(deviates[:,1], orientation='horizontal')
plt.title('H K4ZrSi2O8')
plt.subplot(1,5,3)
plt.hist(deviates[:,2], orientation='horizontal')
plt.title('H ZrSiO4')
plt.subplot(1,5,4)
plt.hist(deviates[:,3], orientation='horizontal')
plt.title('S ZrSiO4')
plt.subplot(1,5,5)
plt.hist(deviates[:,4], orientation='horizontal')
plt.title('V ZrSiO4')
plt.tight_layout()
plt.show()</code>
          </sec>
          <sec id="cell-100-nb-6" specific-use="notebook-content">
            <p>Recompute speciation and plot Na/K ratio of Zr species against
    Na/K bulk composition ratio</p>
          </sec>
          <sec id="cell-101-nb-6" specific-use="notebook-code">
            <code language="python">s_revised = []
for t, p, n in zip(t_data_all, p_data_all, n_liq_all):
    s_revised.append(rMELTS_ZR.cy_Liquid_rMELTS_ZR_order_params(t, p, n))
s_revised = s_revised
fig = plt.figure(figsize=(15,10))
plt.loglog(np.array([2*x[11]/x[12] for x in n_liq_all]), np.array([y[1]/y[2] for y in s_revised]), 'r+')
plt.loglog(np.array([0,5]), np.array([0,5]), 'g-')
plt.ylabel('Na/K species ratio')
plt.xlabel('Na/K reported ratio')
plt.grid(True)
plt.xticks([0.5,0.6,0.7,0.8,0.9,1,2,3,4,5],
           ['','0.6','0.7','0.8','0.9','1','2','3','4','5'])
plt.yticks([0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1,2,3,4,5,6,7,8,9,10,20,30,40,50,60,70,80,90,100],
          ['0.1','','','','0.5','','','','','1','','','','5','','','','','10','','','','50','','','','','100'])
#plt.ylim(0,5)
plt.show()
fig.savefig("Figure_Na_K.pdf", bbox_inches='tight')</code>
          </sec>
          <sec id="cell-102-nb-6" specific-use="notebook-content">
            <p>Estimate zirconium content by zeroing the residuals</p>
          </sec>
          <sec id="cell-103-nb-6" specific-use="notebook-code">
            <code language="python">Zr_meas = []
Zr_pred = []
def residual(log_Zr_est, t, p, nLiq):
    Zr_est = np.exp(log_Zr_est)
    wtZrO2_est = 100.0*123.218*Zr_est/91.224/1000000.0
    elm_est = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_conv_moles_to_elm(nLiq)
    Zr_old = elm_est[core.chem.PERIODIC_ORDER.tolist().index('Zr')]
    elm_est[core.chem.PERIODIC_ORDER.tolist().index('Zr')] -= Zr_old
    elm_est[core.chem.PERIODIC_ORDER.tolist().index('O')]  -= 2.0*Zr_old
    elm_est[core.chem.PERIODIC_ORDER.tolist().index('Zr')] += wtZrO2_est/123.218
    elm_est[core.chem.PERIODIC_ORDER.tolist().index('O')]  += wtZrO2_est*2.0/123.218
    n_est = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_conv_elm_to_moles(elm_est)
    mu_est= rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_dgdn(t,p,n_est)
    result = zirconium_min_affinities(t, p, mu_est, print_results=False)[0]
    return result
#
for t_in, p_in, n_in, y_ref in zip(t_data_all, p_data_all, n_liq_all, y_ref_all):
    try:
        sol = sci.optimize.root_scalar(residual, 
                                       args=(t_in, p_in, n_in),
                                       rtol=1.e-5,
                                       bracket=[0,10],
                                       method='brentq',
                                       maxiter=50)
        print (sol)
        Zr_pred.append(np.exp(sol.root))
        Zr_meas.append(91.224*1000000.0*y_ref/123.218/100.0)
    except ValueError:
        print ('Solution not within brackets')</code>
          </sec>
          <sec id="cell-104-nb-6" specific-use="notebook-code">
            <code language="python">fig = plt.figure(figsize=(15,10))
#plt.subplot(1,2,1)
plt.loglog(np.array(Zr_meas), np.array(Zr_pred), 'r+')
plt.loglog(np.array([100,10000]), np.array([100, 10000]), 'g-')
plt.ylabel('Zr PPM predicted value')
plt.xlabel('Zr PPM reported value')
plt.grid(True)
plt.xticks([100,200,300,400,500,600,700,800,900,1000,2000,3000,4000,5000,6000,7000,8000,9000,10000],
           ['100','','','','500','','','','','1000','','','','5000','','','','','10000'])
plt.yticks([100,200,300,400,500,600,700,800,900,1000,2000,3000,4000,5000,6000,7000,8000,9000,10000],
           ['100','','','','500','','','','','1000','','','','5000','','','','','10000'])
#plt.tight_layout()
plt.show()
fig.savefig("Figure_Zr_Zr.pdf", bbox_inches='tight')</code>
          </sec>
          <sec id="cell-105-nb-6" specific-use="notebook-content">
            <p>If the priors constraints are imposed, compare affinity resiudlas
    and prior residuals</p>
          </sec>
          <sec id="cell-106-nb-6" specific-use="notebook-code">
            <code language="python">if use_priors:
    jac_rows = int(fit_res.fun.shape[0]/2)
    fig = plt.figure(figsize=(15,10))
    plt.subplot(2,2,1)
    plt.plot(np.array(n_liq_all)[:,11], fit_res.fun[:jac_rows], 'r+', label='affin')
    plt.plot(np.array(n_liq_all)[:,11], fit_res.fun[jac_rows:], 'b+', label='prior')
    plt.xlabel('n Na2SiO3')
    plt.ylabel('residual')
    plt.grid(True)
    plt.legend()
    plt.subplot(2,2,2)
    plt.plot(np.array(n_liq_all)[:,12], fit_res.fun[:jac_rows], 'r+', label='affin')
    plt.plot(np.array(n_liq_all)[:,12], fit_res.fun[jac_rows:], 'b+', label='prior')
    plt.xlabel('n KAlSiO4')
    plt.ylabel('residual')
    plt.grid(True)
    plt.legend()
    plt.subplot(2,2,3)
    plt.plot(np.array(t_data_all), fit_res.fun[:jac_rows], 'r+', label='affin')
    plt.plot(np.array(t_data_all), fit_res.fun[jac_rows:], 'b+', label='prior')
    plt.xlabel('T (K)')
    plt.ylabel('residual')
    plt.grid(True)
    plt.legend()
    plt.subplot(2,2,4)
    plt.plot(np.array(p_data_all), fit_res.fun[:jac_rows], 'r+', label='affin')
    plt.plot(np.array(p_data_all), fit_res.fun[jac_rows:], 'b+', label='prior')
    plt.xlabel('P (bars)')
    plt.ylabel('residual')
    plt.grid(True)
    plt.legend()
    plt.tight_layout()
    plt.show
    fig.savefig("Figure_Residuals.pdf", bbox_inches='tight')</code>
          </sec>
          <sec id="cell-107-nb-6" specific-use="notebook-content">
            <p>Compared guessed parameter residuals (x axis) against optimized
    parameter residuals (y axis)</p>
          </sec>
          <sec id="cell-108-nb-6" specific-use="notebook-code">
            <code language="python">plt.figure(figsize=(15,5))
#plt.subplot(1,2,1)
plt.plot(np.array([x for i,x in enumerate(y_data_all) if auth_dat[i] == 1]), 
         np.array([x for i,x in enumerate(y_data_rev) if auth_dat[i] == 1]), 'r+')
plt.plot(np.array([x for i,x in enumerate(y_data_all) if auth_dat[i] == 2]), 
         np.array([x for i,x in enumerate(y_data_rev) if auth_dat[i] == 2]), 'b+')
plt.plot(np.array([x for i,x in enumerate(y_data_all) if auth_dat[i] == 3]), 
         np.array([x for i,x in enumerate(y_data_rev) if auth_dat[i] == 3]), 'k+')
plt.plot(np.array([y_data_all[i] for i in selection]), 
         np.array([fit_res.fun[i] for i in selection]), 'ko')
plt.plot(np.array([-10000,10000]), np.array([-10000, 10000]), 'g-')
plt.ylabel('fit residual')
plt.xlabel('inp residual')
#plt.tight_layout()
plt.show()</code>
          </sec>
          <sec id="cell-109-nb-6" specific-use="notebook-content">
            <p>Compare temperature correlation to residuals (zircon affinities)
    calculated using parameter guesses and parameter fit</p>
          </sec>
          <sec id="cell-110-nb-6" specific-use="notebook-code">
            <code language="python">plt.figure(figsize=(15,5))
plt.subplot(1,2,1)
plt.plot(np.array([x for i,x in enumerate(t_data_all) if auth_dat[i] == 1]), 
         np.array([x for i,x in enumerate(y_data_all) if auth_dat[i] == 1]), 'r+')
plt.plot(np.array([x for i,x in enumerate(t_data_all) if auth_dat[i] == 2]), 
         np.array([x for i,x in enumerate(y_data_all) if auth_dat[i] == 2]), 'b+')
plt.plot(np.array([x for i,x in enumerate(t_data_all) if auth_dat[i] == 3]), 
         np.array([x for i,x in enumerate(y_data_all) if auth_dat[i] == 3]), 'k+')
plt.plot(np.array([t_data_all[i] for i in selection]), 
         np.array([y_data_all[i] for i in selection]), 'ko')
plt.plot(np.array([min(t_data_all), max(t_data_all)]), np.array([0, 0]), 'g-')
plt.ylabel('fit residual')
plt.xlabel('T (K)')
plt.subplot(1,2,2)
plt.plot(np.array([x for i,x in enumerate(t_data_all) if auth_dat[i] == 1]), 
         np.array([x for i,x in enumerate(y_data_rev) if auth_dat[i] == 1]), 'r+')
plt.plot(np.array([x for i,x in enumerate(t_data_all) if auth_dat[i] == 2]), 
         np.array([x for i,x in enumerate(y_data_rev) if auth_dat[i] == 2]), 'b+')
plt.plot(np.array([x for i,x in enumerate(t_data_all) if auth_dat[i] == 3]), 
         np.array([x for i,x in enumerate(y_data_rev) if auth_dat[i] == 3]), 'k+')
plt.plot(np.array([t_data_all[i] for i in selection]), 
         np.array([fit_res.fun[i] for i in selection]), 'ko')
plt.plot(np.array([min(t_data_all), max(t_data_all)]), np.array([0, 0]), 'g-')
plt.ylabel('fit residual')
plt.xlabel('T (K)')
plt.tight_layout()
plt.show()</code>
          </sec>
          <sec id="cell-111-nb-6" specific-use="notebook-content">
            <p>Compare pressure correlation to residuals (zircon affinities)
    calculated using parameter guesses and parameter fit</p>
          </sec>
          <sec id="cell-112-nb-6" specific-use="notebook-code">
            <code language="python">plt.figure(figsize=(15,5))
plt.subplot(1,2,1)
plt.plot(np.array([x for i,x in enumerate(p_data_all) if auth_dat[i] == 1]), 
         np.array([x for i,x in enumerate(y_data_all) if auth_dat[i] == 1]), 'r+')
plt.plot(np.array([x for i,x in enumerate(p_data_all) if auth_dat[i] == 2]), 
         np.array([x for i,x in enumerate(y_data_all) if auth_dat[i] == 2]), 'b+')
plt.plot(np.array([x for i,x in enumerate(p_data_all) if auth_dat[i] == 3]), 
         np.array([x for i,x in enumerate(y_data_all) if auth_dat[i] == 3]), 'k+')
plt.plot(np.array([min(p_data_all), max(p_data_all)]), np.array([0, 0]), 'g-')
plt.ylabel('fit residual')
plt.xlabel('P (bars)')
plt.subplot(1,2,2)
plt.plot(np.array([x for i,x in enumerate(p_data_all) if auth_dat[i] == 1]), 
         np.array([x for i,x in enumerate(y_data_rev) if auth_dat[i] == 1]), 'r+')
plt.plot(np.array([x for i,x in enumerate(p_data_all) if auth_dat[i] == 2]), 
         np.array([x for i,x in enumerate(y_data_rev) if auth_dat[i] == 2]), 'b+')
plt.plot(np.array([x for i,x in enumerate(p_data_all) if auth_dat[i] == 3]), 
         np.array([x for i,x in enumerate(y_data_rev) if auth_dat[i] == 3]), 'k+')
plt.plot(np.array([min(p_data_all), max(p_data_all)]), np.array([0, 0]), 'g-')
plt.ylabel('fit residual')
plt.xlabel('P (bars)')
plt.tight_layout()
plt.show()</code>
          </sec>
          <sec id="cell-113-nb-6" specific-use="notebook-content">
  </sec>
          <sec id="plot-zircon-saturation-surface-nb-6">
            <title>Plot zircon saturation surface</title>
          </sec>
          <sec id="cell-114-nb-6" specific-use="notebook-content">
            <p>
              <bold>Assemble a dictionary of interesting
    compositions</bold>
            </p>
            <list list-type="bullet">
              <list-item>
                <p>Bishop Tuff rhyolite composition is LBT from Gualda</p>
              </list-item>
              <list-item>
                <p>Pantellerite composition is from Carmichael ISA, Turner FJ,
        Verhoogen J (1974) Igneous Petrology, McGraw-Hill, New York,
        739pp; page 237, Table 5-1, column 1. Water content estimated at
        2.5 wt% from ion-probe data reported in Lowenstern JB, Mahood GA
        (1991) New data on magmatic H2O contents of pantellerites, with
        implications for petrogenesis and eruptive dynamics of
        Pantelleria. Bulletin of Volcanology, 54, 78-83</p>
              </list-item>
              <list-item>
                <p>Carmichael reports Zr concentration in the pantellerite is
        1800 PPM</p>
              </list-item>
              <list-item>
                <p>Trachyte, Phonolite in Carmichael, Turner and Verhoogen
        (1974), p36, Table 2-3</p>
              </list-item>
              <list-item>
                <p>Dacite, in Carmichael, Turner and Verhoogen (1974), page
        9</p>
              </list-item>
              <list-item>
                <p>Madupite is LH.16 in Carmichael ISE (1967) The Mineralogy and
        Petrology of the Volcanic Rocks from the Leucite Hills, Wyoming.
        Contributions to Mineralogy and Petrology, 15, 24-66. It
        contains appreciable wadeite, Zr2K4Si6O18. This rock has 0.27
        wt% ZrO2. The Wyomingite is LH.3 . The rock has no Zr analysis
        but other wyomingites have 0.28 wt% ZrO2. All the analyses are
        from Table 12 (page 50).</p>
              </list-item>
            </list>
          </sec>
          <sec id="cell-115-nb-6" specific-use="notebook-code">
            <code language="python">composition_d = {
    'rhyolite': { # Bishop Tuff
        'SiO2':  77.5, 
        'TiO2':   0.08, 
        'Al2O3': 12.5, 
        'Fe2O3':  0.207,
        'Cr2O3':  0.0, 
        'FeO':    0.473, 
        'MnO':    0.0,
        'MgO':    0.03, 
        'NiO':    0.0, 
        'CoO':    0.0,
        'CaO':    0.43, 
        'Na2O':   3.98, 
        'K2O':    4.88, 
        'P2O5':   0.0, 
        'H2O':    5.5,
        'CO2':    0.05
    },
    'Iceland-rhyolite': { # Carmichael, Turner and Verhoogen, p 237; 385 PPM Zr (p. 75)
        'SiO2':  74.96, 
        'TiO2':   0.23, 
        'Al2O3': 12.55, 
        'Fe2O3':  1.72,
        'Cr2O3':  0.0, 
        'FeO':    0.71, 
        'MnO':    0.04,
        'MgO':    0.02, 
        'NiO':    0.0, 
        'CoO':    0.0,
        'CaO':    0.90, 
        'Na2O':   4.41, 
        'K2O':    3.65, 
        'P2O5':   0.04, 
        'H2O':    5.5,
        'CO2':    0.05
    },
    'California-rhyolite': { # Carmichael, Turner and Verhoogen, p 237
        'SiO2':  75.04, 
        'TiO2':   0.07, 
        'Al2O3': 12.29, 
        'Fe2O3':  0.33,
        'Cr2O3':  0.0, 
        'FeO':    0.71, 
        'MnO':    0.05,
        'MgO':    0.04, 
        'NiO':    0.0, 
        'CoO':    0.0,
        'CaO':    0.58, 
        'Na2O':   4.03, 
        'K2O':    4.66, 
        'P2O5':   0.01, 
        'H2O':    5.5,
        'CO2':    0.05
    },
    'dacite': {
        'SiO2':  63.58, 
        'TiO2':   0.64, 
        'Al2O3': 16.67, 
        'Fe2O3':  2.24,
        'Cr2O3':  0.0, 
        'FeO':    3.00, 
        'MnO':    0.11,
        'MgO':    2.12, 
        'NiO':    0.0, 
        'CoO':    0.0,
        'CaO':    5.53, 
        'Na2O':   3.98, 
        'K2O':    1.40, 
        'P2O5':   0.0, 
        'H2O':    3.00,
        'CO2':    0.05
    },
    'pantellerite': { # Pantellerite, Carmichael Turner and Verhoogen, p 237
        'SiO2':  69.81, 
        'TiO2':   0.45, 
        'Al2O3':  8.59, 
        'Fe2O3':  2.28,
        'Cr2O3':  0.0, 
        'FeO':    5.76, 
        'MnO':    0.28,
        'MgO':    0.10, 
        'NiO':    0.0, 
        'CoO':    0.0,
        'CaO':    0.42, 
        'Na2O':   6.46, 
        'K2O':    4.49, 
        'P2O5':   0.0, 
        'H2O':    2.5,
        'CO2':    0.05
    },
    'comendite': { # Comendite, Carmichael Turner and Verhoogen, p 237
        'SiO2':  73.06, 
        'TiO2':   0.23, 
        'Al2O3':  9.76, 
        'Fe2O3':  2.74,
        'Cr2O3':  0.0, 
        'FeO':    2.70, 
        'MnO':    0.13,
        'MgO':    0.10, 
        'NiO':    0.0, 
        'CoO':    0.0,
        'CaO':    0.32, 
        'Na2O':   5.64, 
        'K2O':    4.34, 
        'P2O5':   0.02, 
        'H2O':    2.5,
        'CO2':    0.05
    },
    'trachyte': {
        'SiO2':  57.73, 
        'TiO2':   1.18, 
        'Al2O3': 17.05, 
        'Fe2O3':  2.55,
        'Cr2O3':  0.0, 
        'FeO':    4.35, 
        'MnO':    0.28,
        'MgO':    1.11, 
        'NiO':    0.0, 
        'CoO':    0.0,
        'CaO':    3.10, 
        'Na2O':   6.81, 
        'K2O':    4.27, 
        'P2O5':   0.34, 
        'H2O':    1.0,
        'CO2':    0.05
    },
    'phonolite': {
        'SiO2':  54.55, 
        'TiO2':   1.60, 
        'Al2O3': 19.00, 
        'Fe2O3':  1.75,
        'Cr2O3':  0.0, 
        'FeO':    3.78, 
        'MnO':    0.16,
        'MgO':    1.76, 
        'NiO':    0.0, 
        'CoO':    0.0,
        'CaO':    4.07, 
        'Na2O':   9.06, 
        'K2O':    3.64, 
        'P2O5':   0.20, 
        'H2O':    1.0,
        'CO2':    0.05
    },
    'madupite': { # Leucite Hills, Wyoming
        'SiO2':  43.56, 
        'TiO2':   2.31, 
        'Al2O3':  7.85, 
        'Fe2O3':  5.57,
        'Cr2O3':  0.04, 
        'FeO':    0.85, 
        'MnO':    0.15,
        'MgO':   11.03, 
        'NiO':    0.0, 
        'CoO':    0.0,
        'CaO':   11.89, 
        'Na2O':   0.74, 
        'K2O':    7.19, 
        'P2O5':   1.50, 
        'H2O':    1.0,
        'CO2':    0.05
    },
    'wyomingite': { # Leucite Hills, Wyoming
        'SiO2':  50.23, 
        'TiO2':   2.27, 
        'Al2O3': 11.22, 
        'Fe2O3':  3.34,
        'Cr2O3':  0.0, 
        'FeO':    1.84, 
        'MnO':    0.05,
        'MgO':    7.09, 
        'NiO':    0.0, 
        'CoO':    0.0,
        'CaO':    5.99, 
        'Na2O':   1.37, 
        'K2O':    9.81, 
        'P2O5':   1.89, 
        'H2O':    2.0,
        'CO2':    0.05
    }
}</code>
          </sec>
          <sec id="cell-116-nb-6" specific-use="notebook-content">
            <p>Define a function to generate a zircon or badeyelite saturation
    plot</p>
          </sec>
          <sec id="cell-117-nb-6" specific-use="notebook-code">
            <code language="python">def generate_saturation_plot(phase='zircon', 
                             use_composition='rhyolite',
                             p=2000.0,
                             tmin=700.0,
                             tmax=1000.0,
                             tinc=25,
                             ref_Zr_l=None, # list
                             Zr_PPM_root_min=10.0,
                             Zr_PPM_root_max=500000.0,
                             print_steps=True,
                             debug=False,
                             deviates=None,
                             deviate_plot_quantiles=False
                            ):
    global composition_d, core, plt, sci, np, rMELTS_ZR
    #
    grm_oxides = composition_d[use_composition]
    elm_sys = ['H','O','Na','Mg','Al','Si','P','K','Ca','Ti','Cr','Mn','Fe','Co','Ni']
    tot_grm_oxides = 0.0
    for key in grm_oxides.keys():
        tot_grm_oxides += grm_oxides[key]
    mol_oxides = core.chem.format_mol_oxide_comp(grm_oxides, convert_grams_to_moles=True)
    mol_elm = core.chem.mol_oxide_to_elem(mol_oxides)
    elm_ref = np.zeros(107)
    for i,sym in enumerate(
        ['Si', 'Ti', 'Al', 'Fe', 'Cr', 'Mn', 'Mg', 'Ni', 'Co', 'Ca', 'Na', 'K', 'P', 'H', 'C', 'O']):
        index = core.chem.PERIODIC_ORDER.tolist().index(sym)
        elm_ref[index] = mol_elm[i]
    #
    # Function used by minimizer
    def zero(x):
        global rMELTS_ZR
        elm = np.copy(elm_ref)
        Zr_ppm   = x
        wtZrO2 = 123.218*Zr_ppm/91.224/1000000.0
        wtZrO2 *= tot_grm_oxides + wtZrO2
        elm[core.chem.PERIODIC_ORDER.tolist().index('Zr')] += wtZrO2/123.218
        elm[core.chem.PERIODIC_ORDER.tolist().index('O')]  += wtZrO2*2.0/123.218
        n = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_conv_elm_to_moles(elm)
        if not rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_test_moles(n):
            print ('Output of intrinsic composition calculation fails tests for permissible values.')
        mu = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_dgdn(t,p,n)
        y = zirconium_min_affinities(t, p, mu, print_results=False)[0 if phase == 'zircon' else 1]
        if debug:
            print (t, Zr_ppm, y)
            print (n)
        return y
    #
    T_array = np.linspace(tmin, tmax, tinc, endpoint=True)
    if deviates is not None:
        remember_param_values = rMELTS_ZR.cy_Liquid_rMELTS_ZR_get_param_values()
        yPlot_all = []
        species_all = []
        for irow,row in enumerate(deviates): 
            if np.mod(irow,10) == 0:
                print ('Processing deviate:', irow)
            rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(5,  ref_param_values[ 5] + adj_H_ZrSiO4 - 225000.0 + row[0]) # Na4ZrSi2O8
            rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(6,  ref_param_values[ 6] + adj_S_ZrSiO4            + row[3])
            rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(7,  ref_param_values[ 7] + adj_V_ZrSiO4            + row[4])
            rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(8,  ref_param_values[ 8] + adj_H_ZrSiO4 -  75000.0 + row[1]) # K4ZrSi2O8
            rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(9,  ref_param_values[ 9] + adj_S_ZrSiO4            + row[3])
            rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(10, ref_param_values[10] + adj_V_ZrSiO4            + row[4])
            rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(11, ref_param_values[11] + adj_H_ZrSiO4            + row[2]) # ZrSiO4
            rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(12, ref_param_values[12] + adj_S_ZrSiO4            + row[3])
            rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(13, ref_param_values[13] + adj_V_ZrSiO4            + row[4])
            yPlot = []
            species = []
            for tc in T_array:
                t = tc + 273.15
                y = zero(100)
                sol = sci.optimize.root_scalar(zero, bracket=[Zr_PPM_root_min, Zr_PPM_root_max])
                yPlot.append(sol.root)
                elm = np.copy(elm_ref)
                wtZrO2 = 123.218*sol.root/91.224/1000000.0
                wtZrO2 *= tot_grm_oxides + wtZrO2
                elm[core.chem.PERIODIC_ORDER.tolist().index('Zr')] += wtZrO2/123.218
                elm[core.chem.PERIODIC_ORDER.tolist().index('O')]  += wtZrO2*2.0/123.218
                n = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_conv_elm_to_moles(elm)
                s = rMELTS_ZR.cy_Liquid_rMELTS_ZR_order_params(t, p, n)
                tot = n[16] + s[1] + s[2]
                species.append(np.array([100*n[16]/tot, 100*s[1]/tot, 100*s[2]/tot]))
            #
            yPlot_all.append(np.array(yPlot))
            species_all.append(np.array(species))
        yPlot = np.transpose(np.array(yPlot_all))
        species = np.array(species_all)
        rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_values(remember_param_values)
    else:
        yPlot = []
        species = []
        for tc in T_array:
            if print_steps:
                print ('{0:7.1f}'.format(tc), end=' ')
            t = tc + 273.15
            y = zero(100)
            sol = sci.optimize.root_scalar(zero, bracket=[Zr_PPM_root_min, Zr_PPM_root_max])
            yPlot.append(sol.root)
            #
            elm = np.copy(elm_ref)
            wtZrO2 = 123.218*sol.root/91.224/1000000.0
            wtZrO2 *= tot_grm_oxides + wtZrO2
            elm[core.chem.PERIODIC_ORDER.tolist().index('Zr')] += wtZrO2/123.218
            elm[core.chem.PERIODIC_ORDER.tolist().index('O')]  += wtZrO2*2.0/123.218
            n = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_conv_elm_to_moles(elm)
            s = rMELTS_ZR.cy_Liquid_rMELTS_ZR_order_params(t, p, n)
            tot = n[16] + s[1] + s[2]
            species.append(np.array([100*n[16]/tot, 100*s[1]/tot, 100*s[2]/tot]))
            if print_steps:
                print ('{0:10.1f} {1:1.1s} {2:2d} {3:6.2f} {4:6.2f} {5:6.2f}'.format(
                    sol.root, 'T' if sol.converged else 'F', sol.iterations, 100*n[16]/tot, 100*s[1]/tot, 100*s[2]/tot
                ))
        #
        yPlot = np.array(yPlot)
        species = np.array(species)
    #
    fig = plt.figure(figsize=(15,5))
    plt.subplot(1,2,1)
    plt.title(phase+' saturation for '+use_composition+' composition')
    if deviate_plot_quantiles and deviates is not None:
        plt.plot(T_array, np.quantile(yPlot,0.50,axis=1), 'r-',  label='mean')
        plt.plot(T_array, np.quantile(yPlot,0.05,axis=1), 'r--', label='5 %')
        plt.plot(T_array, np.quantile(yPlot,0.95,axis=1), 'r--', label='95 %')
        plt.legend()
    else:
        plt.plot(T_array, yPlot, 'r-')
    if ref_Zr_l is not None:
        for x in ref_Zr_l:
            plt.plot(np.array([tmin, tmax]), np.array([x,x]), 'g-')
    plt.ylabel('PPM Zr')
    plt.xlabel('T °C')
    #
    plt.subplot(1,2,2)
    plt.title('Zr speciation for '+use_composition+' composition')
    if deviates is not None:
        if deviate_plot_quantiles:
            plt.plot(T_array, np.quantile(species[:,:,0],0.50,axis=0), 'r-',  label='ZrSiO4 mean')
            plt.plot(T_array, np.quantile(species[:,:,0],0.05,axis=0), 'r--', label='ZrSiO4 5%')
            plt.plot(T_array, np.quantile(species[:,:,0],0.95,axis=0), 'r--', label='ZrSiO4 95%')
            plt.plot(T_array, np.quantile(species[:,:,1],0.50,axis=0), 'g-',  label='Na4ZrSi2O8 mean')
            plt.plot(T_array, np.quantile(species[:,:,1],0.05,axis=0), 'g--', label='Na4ZrSi2O8 5%')
            plt.plot(T_array, np.quantile(species[:,:,1],0.95,axis=0), 'g--', label='Na4ZrSi2O8 95%')
            plt.plot(T_array, np.quantile(species[:,:,2],0.50,axis=0), 'b-',  label='K4ZrSi2O8 mean')
            plt.plot(T_array, np.quantile(species[:,:,2],0.05,axis=0), 'b--', label='K4ZrSi2O8 5%')
            plt.plot(T_array, np.quantile(species[:,:,2],0.95,axis=0), 'b--', label='K4ZrSi2O8 95%')
        else:
            for i in range(0,deviates.shape[0]):
                if i == 0:
                    plt.plot(T_array, species[i,:,0], 'r-', label='ZrSiO4')
                    plt.plot(T_array, species[i,:,1], 'g-', label='Na4ZrSi2O8')
                    plt.plot(T_array, species[i,:,2], 'b-', label='K4ZrSi2O8')
                else:
                    plt.plot(T_array, species[i,:,0], 'r-')
                    plt.plot(T_array, species[i,:,1], 'g-')
                    plt.plot(T_array, species[i,:,2], 'b-')
    else:
        plt.plot(T_array, species[:,0], 'r-', label='ZrSiO4')
        plt.plot(T_array, species[:,1], 'g-', label='Na4ZrSi2O8')
        plt.plot(T_array, species[:,2], 'b-', label='K4ZrSi2O8')
    plt.ylabel('% Zr-species')
    plt.xlabel('T °C')
    plt.legend()
    plt.tight_layout()
    plt.show()
    fig.savefig(phase + "_sat_" + use_composition + ".pdf", bbox_inches='tight')
    return (T_array, yPlot, species)</code>
          </sec>
          <sec id="cell-118-nb-6" specific-use="notebook-content">
            <p>Make some plots of zircon saturation for various compositions</p>
          </sec>
          <sec id="cell-119-nb-6" specific-use="notebook-code">
            <code language="python">T_array, yPlot, species = generate_saturation_plot(use_composition='rhyolite', ref_Zr_l=[80, 100, 120], tmin=700, tmax=800, print_steps=False)</code>
          </sec>
          <sec id="cell-120-nb-6" specific-use="notebook-code">
            <code language="python">T_array, yPlot, species = generate_saturation_plot(use_composition='rhyolite', ref_Zr_l=[80, 100, 120], tmin=700, tmax=800, print_steps=False, 
                                                   deviates=deviates, deviate_plot_quantiles=True)</code>
          </sec>
          <sec id="cell-121-nb-6" specific-use="notebook-code">
            <code language="python">T_array, yPlot, species = generate_saturation_plot(use_composition='California-rhyolite', ref_Zr_l=[110], tmax=800, print_steps=False, 
                                                   deviates=deviates, deviate_plot_quantiles=True)</code>
          </sec>
          <sec id="cell-122-nb-6" specific-use="notebook-code">
            <code language="python">T_array, yPlot, species = generate_saturation_plot(use_composition='Iceland-rhyolite', ref_Zr_l=[385], print_steps=False, 
                                                   deviates=deviates, deviate_plot_quantiles=True)</code>
          </sec>
          <sec id="cell-123-nb-6" specific-use="notebook-code">
            <code language="python">T_array, yPlot, species = generate_saturation_plot(use_composition='dacite', tmin=700, ref_Zr_l=[150], Zr_PPM_root_min=1.0,
                                                   print_steps=False, debug=False, deviates=deviates, deviate_plot_quantiles=True)</code>
          </sec>
          <sec id="cell-124-nb-6" specific-use="notebook-code">
            <code language="python">T_array, yPlot, species = generate_saturation_plot(use_composition='pantellerite', ref_Zr_l=[1800], 
                                                   tmin=700, tmax=900, print_steps=False, 
                                                   deviates=deviates, deviate_plot_quantiles=True)</code>
          </sec>
          <sec id="cell-125-nb-6" specific-use="notebook-code">
            <code language="python">T_array, yPlot, species = generate_saturation_plot(use_composition='comendite', ref_Zr_l=[1250], print_steps=False,
                                                  deviates=deviates, deviate_plot_quantiles=True)</code>
          </sec>
          <sec id="cell-126-nb-6" specific-use="notebook-code">
            <code language="python">T_array, yPlot, species = generate_saturation_plot(use_composition='trachyte', ref_Zr_l=None, print_steps=False, 
                                                   deviates=deviates, deviate_plot_quantiles=True)</code>
          </sec>
          <sec id="cell-127-nb-6" specific-use="notebook-code">
            <code language="python">T_array, yPlot, species = generate_saturation_plot(use_composition='phonolite', ref_Zr_l=None, print_steps=False, 
                                                   deviates=deviates, deviate_plot_quantiles=True)</code>
          </sec>
          <sec id="cell-128-nb-6" specific-use="notebook-content">
            <p>This rock is saturated with a wadeite solid solution</p>
          </sec>
          <sec id="cell-129-nb-6" specific-use="notebook-code">
            <code language="python">T_array, yPlot, species = generate_saturation_plot(use_composition='madupite', tmin=700.0, tmax=1200.0, ref_Zr_l=[2073],
                                                   Zr_PPM_root_min=1.0, Zr_PPM_root_max=250000.0, print_steps=False, 
                                                   deviates=deviates, deviate_plot_quantiles=True)</code>
          </sec>
          <sec id="cell-130-nb-6" specific-use="notebook-content">
            <p>This rock is saturated with wadeite, Zr2K4Si6O18 in solid
    solution with its Ti-equivalent, Ti2K4Si6O18</p>
          </sec>
          <sec id="cell-131-nb-6" specific-use="notebook-code">
            <code language="python">T_array, yPlot, species = generate_saturation_plot(use_composition='wyomingite', tmin=700.0, tmax=1200.0, ref_Zr_l=[2073], 
                                                   Zr_PPM_root_min=10.0, Zr_PPM_root_max=500000.0, print_steps=False, debug=False,
                                                   deviates=deviates, deviate_plot_quantiles=True)</code>
          </sec>
          <sec id="cell-132-nb-6" specific-use="notebook-code">
            <code language="python">T_array, yPlot, species = generate_saturation_plot(phase='badelyite', use_composition='wyomingite', tmin=700.0, tmax=1200.0, ref_Zr_l=[2073], 
                                                   Zr_PPM_root_min=10.0, Zr_PPM_root_max=500000.0, print_steps=False, debug=False,
                                                  deviates=deviates, deviate_plot_quantiles=True)</code>
          </sec>
          <sec id="cell-133-nb-6" specific-use="notebook-content">
  </sec>
          <sec id="zircon-geothermometer-nb-6">
            <title>Zircon Geothermometer</title>
          </sec>
          <sec id="cell-134-nb-6" specific-use="notebook-code">
            <code language="python">def zircon_geothermometer(use_composition='rhyolite', # str references dictionary element in composition_d, else dictionary
                          ref_Zr_ppm=100, p=2000.0, tmin=500.0, tmax=1200.0, 
                          print_steps=True, debug=False):
    global composition_d, core, plt, sci, np, rMELTS_ZR
    #
    if isinstance(use_composition, str):
        grm_oxides = composition_d[use_composition]
    else:
        grm_oxides = use_composition
    elm_sys = ['H','O','Na','Mg','Al','Si','P','K','Ca','Ti','Cr','Mn','Fe','Co','Ni']
    tot_grm_oxides = 0.0
    for key in grm_oxides.keys():
        tot_grm_oxides += grm_oxides[key]
    mol_oxides = core.chem.format_mol_oxide_comp(grm_oxides, convert_grams_to_moles=True)
    mol_elm = core.chem.mol_oxide_to_elem(mol_oxides)
    elm_ref = np.zeros(107)
    for i,sym in enumerate(
        ['Si', 'Ti', 'Al', 'Fe', 'Cr', 'Mn', 'Mg', 'Ni', 'Co', 'Ca', 'Na', 'K', 'P', 'H', 'C', 'O']):
        index = core.chem.PERIODIC_ORDER.tolist().index(sym)
        elm_ref[index] = mol_elm[i]
    #
    elm = np.copy(elm_ref)
    Zr_ppm = ref_Zr_ppm
    wtZrO2 = 123.218*Zr_ppm/91.224/1000000.0
    wtZrO2 *= tot_grm_oxides + wtZrO2
    elm[core.chem.PERIODIC_ORDER.tolist().index('Zr')] += wtZrO2/123.218
    elm[core.chem.PERIODIC_ORDER.tolist().index('O')]  += wtZrO2*2.0/123.218
    n = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_conv_elm_to_moles(elm)
    if not rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_test_moles(n):
        print ('Output of intrinsic composition calculation fails tests for permissible values.')
        return
    # Function used by minimizer
    def zero(t):
        global rMELTS_ZR
        mu = rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_dgdn(t,p,n)
        y = zirconium_min_affinities(t, p, mu, print_results=False)[0]
        if debug:
            print (t)
        return y
    #
    remember_param_values = rMELTS_ZR.cy_Liquid_rMELTS_ZR_get_param_values()
    results = np.zeros(deviates.shape[0])
    for irow,row in enumerate(deviates): 
        rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(5,  ref_param_values[ 5] + adj_H_ZrSiO4 - 225000.0 + row[0]) # Na4ZrSi2O8
        rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(6,  ref_param_values[ 6] + adj_S_ZrSiO4            + row[3])
        rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(7,  ref_param_values[ 7] + adj_V_ZrSiO4            + row[4])
        rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(8,  ref_param_values[ 8] + adj_H_ZrSiO4 -  75000.0 + row[1]) # K4ZrSi2O8
        rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(9,  ref_param_values[ 9] + adj_S_ZrSiO4            + row[3])
        rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(10, ref_param_values[10] + adj_V_ZrSiO4            + row[4])
        rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(11, ref_param_values[11] + adj_H_ZrSiO4            + row[2]) # ZrSiO4
        rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(12, ref_param_values[12] + adj_S_ZrSiO4            + row[3])
        rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(13, ref_param_values[13] + adj_V_ZrSiO4            + row[4])
        try:
            sol = sci.optimize.root_scalar(zero, bracket=[tmin, tmax])
        except ValueError:
            print ('No valid temperature solution in interval', tmin, 'to', tmax)
            return
        results[irow] = sol.root
    rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_values(remember_param_values)
    t_mean = np.quantile(results, 0.50) - 273.15
    t_05   = np.quantile(results, 0.05) - 273.15
    t_95   = np.quantile(results, 0.95) - 273.15
    return (t_mean, t_05, t_95)
    </code>
          </sec>
          <sec id="cell-135-nb-6" specific-use="notebook-code">
            <code language="python">zircon_geothermometer(p=1750)</code>
          </sec>
          <sec id="cell-136-nb-6" specific-use="notebook-code">
            <code language="python">zircon_geothermometer(use_composition='dacite', ref_Zr_ppm=150)</code>
          </sec>
          <sec id="cell-137-nb-6" specific-use="notebook-code">
            <code language="python">zircon_geothermometer(use_composition = {
    'SiO2':  63.58, 
    'TiO2':   0.64, 
    'Al2O3': 16.67, 
    'Fe2O3':  2.24,
    'Cr2O3':  0.0, 
    'FeO':    3.00, 
    'MnO':    0.11,
    'MgO':    2.12, 
    'NiO':    0.0, 
    'CoO':    0.0,
    'CaO':    5.53, 
    'Na2O':   3.98, 
    'K2O':    1.40, 
    'P2O5':   0.0, 
    'H2O':    3.00,
    'CO2':    0.05
}, ref_Zr_ppm=200)</code>
          </sec>
          <sec id="cell-138-nb-6" specific-use="notebook-content">
            <p>Na4ZrSi2O8 + 4KAlSiO4 = K4ZrSi2O8 + 2Na2SiO3 + 2Al2O3 + 2SiO2</p>
          </sec>
          <sec id="cell-139-nb-6" specific-use="notebook-code">
            <code language="python">t = 1000.00
p = 1000.0
def exchange_prop(t=1000, p=1000, param_test=ref_param_values):
    mu0_SiO2    =  rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_mu0(    0, t, p)
    mu0_Al2O3   =  rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_mu0(    2, t, p)
    mu0_Na2SiO3 =  rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_mu0(   11, t, p)
    mu0_KAlSiO4 =  rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_mu0(   12, t, p)
    S0_SiO2     = -rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dT( 0, t, p)
    S0_Al2O3    = -rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dT( 2, t, p)
    S0_Na2SiO3  = -rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dT(11, t, p)
    S0_KAlSiO4  = -rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dT(12, t, p)
    V0_SiO2     =  rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dP( 0, t, p)
    V0_Al2O3    =  rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dP( 2, t, p)
    V0_Na2SiO3  =  rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dP(11, t, p)
    V0_KAlSiO4  =  rMELTS_ZR.cy_Liquid_rMELTS_ZR_calib_endmember_dmu0dP(12, t, p)
    H0_SiO2     = mu0_SiO2    + t*S0_SiO2    - (p-1.0)*V0_SiO2
    H0_Al2O3    = mu0_Al2O3   + t*S0_Al2O3   - (p-1.0)*V0_Al2O3
    H0_Na2SiO3  = mu0_Na2SiO3 + t*S0_Na2SiO3 - (p-1.0)*V0_Na2SiO3
    H0_KAlSiO4  = mu0_KAlSiO4 + t*S0_KAlSiO4 - (p-1.0)*V0_KAlSiO4
    deltaH = param_test[ 8] + 2*H0_Na2SiO3 + 2*H0_Al2O3 + 2*H0_SiO2 - param_test[ 5] - 4*H0_KAlSiO4 
    deltaS = param_test[ 9] + 2*S0_Na2SiO3 + 2*S0_Al2O3 + 2*S0_SiO2 - param_test[ 6] - 4*S0_KAlSiO4 
    deltaV = param_test[10] + 2*V0_Na2SiO3 + 2*V0_Al2O3 + 2*V0_SiO2 - param_test[ 7] - 4*V0_KAlSiO4 
    return (deltaH, deltaS, deltaV)
exchange_prop()</code>
          </sec>
          <sec id="cell-140-nb-6" specific-use="notebook-code">
            <code language="python">exchange_prop(param_test=rMELTS_ZR.cy_Liquid_rMELTS_ZR_get_param_values())</code>
          </sec>
          <sec id="cell-141-nb-6" specific-use="notebook-content">
  </sec>
          <sec id="save-revised-parameter-values-nb-6">
            <title>Save revised parameter values</title>
          </sec>
          <sec id="cell-142-nb-6" specific-use="notebook-code">
            <code language="python">new_param_values = rMELTS_ZR.cy_Liquid_rMELTS_ZR_get_param_values()
new_param_values</code>
          </sec>
          <sec id="cell-143-nb-6" specific-use="notebook-code">
            <code language="python">import pickle

with open('calib_params.pickle', 'wb') as f:
    pickle.dump(new_param_values, f, pickle.HIGHEST_PROTOCOL)</code>
          </sec>
          <sec id="cell-144-nb-6" specific-use="notebook-code">
            <code language="python">import pickle

with open('calib_params.pickle', 'rb') as f:
    params_stored = pickle.load(f)</code>
          </sec>
          <sec id="cell-145-nb-6" specific-use="notebook-code">
            <code language="python">params_stored</code>
          </sec>
          <sec id="cell-146-nb-6" specific-use="notebook-content">
  </sec>
          <sec id="evaluate-data-from-the-experimental-study-of-gervasoni-et-al.-2016-nb-6">
            <title>Evaluate data from the experimental study of Gervasoni et
    al. (2016)</title>
          </sec>
          <sec id="cell-147-nb-6" specific-use="notebook-code">
            <code language="python">df4 = pd.read_excel('Gervasoni_2016.xlsx')
df4.fillna(0)</code>
          </sec>
          <sec id="cell-148-nb-6" specific-use="notebook-code">
            <code language="python">import matplotlib.colors as mcolors
fig = plt.figure(figsize=(15,10))
df_iterator = df4.itertuples()
for row_indx,data in enumerate(df_iterator):
    compo = {
        'SiO2':  data[6], 
        'TiO2':  data[7],
        'Al2O3': data[8], 
        'Fe2O3': data[9]*0.1,
        'Cr2O3': 0.0, 
        'FeO':   data[9]*0.9, 
        'MnO':   0.0,
        'MgO':   data[10], 
        'NiO':   0.0, 
        'CoO':   0.0,
        'CaO':   data[11], 
        'Na2O':  data[12],
        'K2O':   data[13], 
        'P2O5':  0.0, 
        'H2O':   0.1,
        'CO2':   0.01
    }
    result = zircon_geothermometer(use_composition=compo, ref_Zr_ppm=data[2], tmax=2000.0, p=data[5])
    result_l = zircon_geothermometer(use_composition=compo, ref_Zr_ppm=data[2]-data[3], tmax=2000.0, p=data[5])
    result_h = zircon_geothermometer(use_composition=compo, ref_Zr_ppm=data[2]+data[3], tmax=2000.0, p=data[5])
    plt.errorbar(data[2], data[4], xerr=data[3], fmt='ro', label=data[1]+' '+str(data[2])) # mean, low, high
    plt.errorbar(data[2], result[0], 
                 yerr=np.array([[np.fabs(result[1]-result[0])], [np.fabs(result[2]-result[0])]]), fmt='bo')
    plt.errorbar(data[2]-data[3], result_l[0], 
                 yerr=np.array([[np.fabs(result_l[1]-result_l[0])], [np.fabs(result_l[2]-result_l[0])]]), fmt='b,')  
    plt.errorbar(data[2]+data[3], result_h[0], 
                 yerr=np.array([[np.fabs(result_h[1]-result_h[0])], [np.fabs(result_h[2]-result_h[0])]]), fmt='b,')
    plt.plot(np.array([data[2], data[2]]), np.array([data[4], result[0]]), 'k--')
    plt.plot(np.array([data[2]-data[3], data[2]+data[3]]), np.array([result_l[1], result_h[1]]), 'b-')
    plt.plot(np.array([data[2]-data[3], data[2]+data[3]]), np.array([result_l[2], result_h[2]]), 'b-')
    plt.fill(np.array([data[2]-data[3], data[2]+data[3], data[2]+data[3], data[2]-data[3], data[2]-data[3]]),
             np.array([result_l[2], result_h[2], result_h[1], result_l[1], result_l[2]]), 
             color=mcolors.CSS4_COLORS['lightyellow'])
plt.title('Gervasoni et al., 2016, temperature recovery')
plt.ylabel('T °C')
plt.xlabel('Zr (PPM)')
plt.legend()
fig.savefig("Gervasoni_et_al.pdf", bbox_inches='tight')
plt.show()</code>
          </sec>
          <sec id="cell-149-nb-6" specific-use="notebook-content">
  </sec>
          <sec id="calibrant-temperature-recovery-nb-6">
            <title>Calibrant temperature recovery</title>
          </sec>
          <sec id="cell-150-nb-6" specific-use="notebook-code">
            <code language="python">plot_watson = False
plot_boenke = True
fig, main_plt = plt.subplots(figsize=(15,10))
T_meas = []
T_estm = []
T_estm_l = []
T_estm_h = []
lst = []
if plot_watson:
    lst.append(df1)
if plot_boenke:
    lst.append(df2)
for df in lst:
    df_iterator = df.itertuples()
    #
    for row_indx,data in enumerate(df_iterator):
        #print (row_indx)
        auth_id = data[3]
        t = data[25 if auth_id == 1 else 17]
        p = data[26 if auth_id == 1 else 18]*10000.0
        if data[4] != 'Liquid':
            continue
        compo = {
            'SiO2':  data[5 if auth_id == 1 else 5], 
            'TiO2':  data[7 if auth_id == 1 else 6], 
            'Al2O3': data[9 if auth_id == 1 else 7], 
            'Fe2O3': 0.0,
            'Cr2O3': 0.0, 
            'FeO':   data[11 if auth_id == 1 else 8], 
            'MnO':    0.0,
            'MgO':   data[13 if auth_id == 1 else 9], 
            'NiO':    0.0, 
            'CoO':    0.0,
            'CaO':   data[15 if auth_id == 1 else 10], 
            'Na2O':  data[17 if auth_id == 1 else 11], 
            'K2O':   data[19 if auth_id == 1 else 12], 
            'P2O5':   0.0, 
            'H2O':   data[24 if auth_id == 1 else 15],
            'CO2':    0.01
        }
        zr_ppm     = 91.224*1000000.0*data[22 if auth_id == 1 else 13]/100.0/123.218
        zr_ppm_err = 91.224*1000000.0*data[23 if auth_id == 1 else 14]/100.0/123.218
        result = zircon_geothermometer(use_composition=compo, ref_Zr_ppm=zr_ppm, tmax=2000.0, p=p)
        result_l = zircon_geothermometer(use_composition=compo, ref_Zr_ppm=zr_ppm-zr_ppm_err, tmax=2000.0, p=p)
        result_h = zircon_geothermometer(use_composition=compo, ref_Zr_ppm=zr_ppm+zr_ppm_err, tmax=2000.0, p=p)
        T_meas.append(t)
        T_estm.append(result)
        T_estm_l.append(result_l)
        T_estm_h.append(result_h)
        main_plt.errorbar(zr_ppm, t, xerr=zr_ppm_err, fmt='ro')
        main_plt.errorbar(zr_ppm, result[0], 
                 yerr=np.array([[result[0]-result[1]], [result[2]-result[0]]]), fmt='co')
        main_plt.errorbar(zr_ppm-zr_ppm_err, result_l[0], 
                 yerr=np.array([[result_l[0]-result_l[1]], [result_l[2]-result_l[0]]]), fmt='y,')  
        main_plt.errorbar(zr_ppm+zr_ppm_err, result_h[0], 
                 yerr=np.array([[result_h[0]-result_h[1]], [result_h[2]-result_h[0]]]), fmt='y,')
        main_plt.plot(np.array([zr_ppm, zr_ppm]), np.array([t, result[0]]), 'k--')
        main_plt.plot(np.array([zr_ppm-zr_ppm_err, zr_ppm, zr_ppm+zr_ppm_err]), np.array([result_l[1], result[1], result_h[1]]), 'y-')
        main_plt.plot(np.array([zr_ppm-zr_ppm_err, zr_ppm, zr_ppm+zr_ppm_err]), np.array([result_l[2], result[2], result_h[2]]), 'y-')
        main_plt.fill(np.array([zr_ppm-zr_ppm_err, zr_ppm, zr_ppm+zr_ppm_err, zr_ppm+zr_ppm_err, zr_ppm, zr_ppm-zr_ppm_err, zr_ppm-zr_ppm_err]),
             np.array([result_l[2], result[2], result_h[2], result_h[1], result[1], result_l[1], result_l[2]]), 
             color=mcolors.CSS4_COLORS['lightyellow'])
#
inset_plt = fig.add_axes([0.5, 0.2, 0.35, 0.35])
inset_plt.plot(np.array(T_meas), np.array(T_estm)[:,0], 'ro')
inset_plt.errorbar(np.array(T_meas), np.array(T_estm)[:,0], 
                 yerr=[np.array(T_estm)[:,0]-np.array(T_estm)[:,1], np.array(T_estm)[:,2]-np.array(T_estm)[:,0]], fmt='ro')

inset_plt.set_xlabel('T °C, reported')
inset_plt.set_ylabel('T °C, estimated')
#
main_plt.set_ylabel('T °C')
main_plt.set_xlabel('Zr (PPM)')
if plot_watson and not plot_boenke:
    main_plt.set_xlim([0., 4000.])
    main_plt.set_ylim([690.,1100.])
    inset_plt.set_xlim([690.,1100.])
    inset_plt.set_ylim([690.,1100.])
    inset_plt.plot(np.array([690,1100]), np.array([690,1100]), 'k-')
    main_plt.set_title('Watson and Harrison, 1983, temperature recovery')
    fig.savefig("WandH_1983_temperature_recovery.pdf", bbox_inches='tight')
elif not plot_watson and plot_boenke:
    main_plt.set_xlim([0., 4000.])
    main_plt.set_ylim([700.,1100.])
    inset_plt.set_xlim([700.,1100.])
    inset_plt.set_ylim([700.,1100.])
    inset_plt.plot(np.array([700,1100]), np.array([700,1100]), 'k-')
    main_plt.set_title('Boehnke et al., 2013, temperature recovery')
    fig.savefig("Boehnke_2013_temperature_recovery.pdf", bbox_inches='tight')
else:
    inset_plt.plot(np.array([700,1250]), np.array([700,1250]), 'k-')
    main_plt.set_title('Temperature recovery')
    fig.savefig("Temperature_recovery.pdf", bbox_inches='tight')
plt.show()</code>
          </sec>
          <sec id="cell-151-nb-6" specific-use="notebook-content">
  </sec>
          <sec id="statistics-of-calibrant-temperature-recovery-nb-6">
            <title>Statistics of calibrant temperature recovery</title>
          </sec>
          <sec id="cell-152-nb-6" specific-use="notebook-code">
            <code language="python">low   = np.array(T_estm)[:,0] - np.array(T_estm)[:,1]
hgh   = np.array(T_estm)[:,2] - np.array(T_estm)[:,0]
low_l = np.array(T_estm_l)[:,0] - np.array(T_estm_l)[:,1]
hgh_l = np.array(T_estm_l)[:,2] - np.array(T_estm_l)[:,0]
low_h = np.array(T_estm_h)[:,0] - np.array(T_estm_h)[:,1]
hgh_h = np.array(T_estm_h)[:,2] - np.array(T_estm_h)[:,0]
if plot_watson and not plot_boenke:
    pass
elif not plot_watson and plot_boenke:
    low = low[:-4]
    hgh = hgh[:-4]
    low_l = low_l[:-4]
    hgh_l = hgh_l[:-4]
    low_h = low_h[:-4]
    hgh_h = hgh_h[:-4]
print ('5% quartile T (ave Zr):', -np.average(low), '95%', np.average(hgh))
print ('5% quartile T (low Zr):', -np.average(low_l), '95%', np.average(hgh_l))
print ('5% quartile T (hgh Zr):', -np.average(low_h), '95%', np.average(hgh_h))</code>
          </sec>
          <sec id="cell-153-nb-6" specific-use="notebook-code">
            <code language="python">err = np.array(T_estm)[:,0] - np.array(T_meas)
err_l = np.array(T_estm_l)[:,0] - np.array(T_meas)
err_h = np.array(T_estm_h)[:,0] - np.array(T_meas)
if plot_watson and not plot_boenke:
    pass
elif not plot_watson and plot_boenke:
    err = err[:-4]
    err_l = err_l[:-4]
    err_h = err_h[:-4]
print ('T est ave (ave Zr) - T meas', np.average(err), '±', np.std(err))
print ('T est ave (low Zr) - T meas', np.average(err_l), '±', np.std(err_l))
print ('T est ave (hgh Zr) - T meas', np.average(err_h), '±', np.std(err_h))</code>
          </sec>
        </sec>
      </sec>
    </body>
    <back>
</back>
  </sub-article>
  <sub-article article-type="notebook" id="nb-21-nb-7">
    <front-stub>
      <title-group>
        <article-title>7-Phase equilibria: MELTS liquid model with
ZrSiO4</article-title>
      </title-group>
    </front-stub>
    <body>
      <sec id="cell-0-nb-7" specific-use="notebook-content">
        <sec id="phase-equilibria-melts-liquid-model-with-zrsio4-nb-7">
          <title>7-Phase equilibria: MELTS liquid model with ZrSiO4</title>
          <p>Associated solution model:</p>
          <table-wrap>
            <table>
              <colgroup>
                <col width="19%"/>
                <col width="14%"/>
                <col width="16%"/>
                <col width="16%"/>
                <col width="18%"/>
                <col width="18%"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="left">Components:</th>
                  <th align="left">Species:</th>
                  <th align="left">Reaction:</th>
                  <th align="left">Variable:</th>
                  <th align="left">Component:</th>
                  <th align="left">Species X:</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left">SiO2</td>
                  <td align="left">SiO2</td>
                  <td align="left"/>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_1]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_1]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">TiO2</td>
                  <td align="left">TiO2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_1]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_2]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_2]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Al2O3</td>
                  <td align="left">Al2O3</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_2]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_3]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>3</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_3]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>3</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Fe2O3</td>
                  <td align="left">Fe2O3</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_3]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>3</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_4]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>4</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_4]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>4</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">MgCr2O4</td>
                  <td align="left">MgCr2O4</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_4]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>4</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_5]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>5</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_5]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>5</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Fe2SiO4</td>
                  <td align="left">Fe2SiO4</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_5]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>5</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_6]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>6</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_6]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>6</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">MnSi1/2O2</td>
                  <td align="left">MnSi1/2O2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_6]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>6</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_7]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>7</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_7]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>7</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Mg2SiO4</td>
                  <td align="left">Mg2SiO4</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_7]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>7</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_8]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>8</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_8]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>8</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">NiSi1/2O2</td>
                  <td align="left">NiSi1/2O2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_8]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>8</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_9]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>9</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_9]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>9</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">CoSi1/2O2</td>
                  <td align="left">CoSi1/2O2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_9]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>9</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{10}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>10</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{10}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>10</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">CaSiO3</td>
                  <td align="left">CaSiO3</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{10}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>10</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{11}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>11</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{11}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>11</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Na2SiO3</td>
                  <td align="left">Na2SiO3</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{11}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>11</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{12}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>12</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{12}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>12</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">KAlSiO4</td>
                  <td align="left">KAlSiO4</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{12}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>12</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{13}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>13</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{13}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>13</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">Ca3(PO4)2</td>
                  <td align="left">Ca3(PO4)2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{13}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>13</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{14}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>14</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{14}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>14</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">H2O</td>
                  <td align="left">H2O</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{14}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>14</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{15}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>15</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{15}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>15</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">CO2</td>
                  <td align="left">CO2</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{15}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>15</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{16}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>16</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{16}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>16</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left">ZrSiO4</td>
                  <td align="left">ZrSiO4</td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[r_{16}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>r</mml:mi>
                            <mml:mn>16</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[n_{17}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>17</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{17}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>17</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left"/>
                  <td align="left">CaCO3</td>
                  <td align="left">CO2 + CaSiO3 = CaCO3 + SiO2</td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[s_1]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>s</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{18}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>18</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left"/>
                  <td align="left">Na4ZrSi2O8</td>
                  <td align="left">ZrSiO4 + 2Na2SiO3 = Na4ZrSi2O8 + SiO2</td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[s_2]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>s</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{19}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>19</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left"/>
                  <td align="left">K4ZrSi2O8</td>
                  <td align="left">ZrSiO4 + 4KAlSiO4 = K4ZrSi2O8 + 2Al2O3 +
          3SiO2</td>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[s_3]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>s</mml:mi>
                            <mml:mn>3</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="left"/>
                  <td align="left">
                    <inline-formula>
                      <alternatives>
                        <tex-math><![CDATA[X_{20}]]></tex-math>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline">
                          <mml:msub>
                            <mml:mi>X</mml:mi>
                            <mml:mn>20</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
        </sec>
        <sec id="cell-1-nb-7" specific-use="notebook-content">
          <sec id="gibbs-energy-minimization-fixed-t-p-bulk-composition-nb-7">
            <title>Gibbs energy minimization (fixed T, P, bulk
    composition)</title>
            <p>Closed system; crystallization of a rhyolitic liquid using
    rhyolite-MELTS 1.1 + Zr-model</p>
          </sec>
          <sec id="cell-2-nb-7" specific-use="notebook-code">
            <code language="python">import numpy as np
import scipy.optimize as opt
import scipy.linalg as lin 
import sys
from thermoengine import core, phases, model, equilibrate
import warnings
warnings.filterwarnings("ignore", category=DeprecationWarning)
warnings.filterwarnings("ignore", category=FutureWarning)
import matplotlib.pyplot as plt
import scipy as sci
%matplotlib inline</code>
          </sec>
          <sec id="cell-3-nb-7" specific-use="notebook-code">
            <code language="python">model_working_dir = "working"
%cd {model_working_dir}
from pyximport import install
install()
import rMELTS_ZR
import zirconium_minerals
modelDB_ZR_min = model.Database(database="CoderModule", calib=True, 
                             phase_tuple=('zirconium_minerals', {
                                 'Zrc':['zircon','pure'],
                                 'Bdd':['baddeleyite','pure']
                             }))
modelDB_ZR_liq = model.Database(database="CoderModule", calib=True, 
                             phase_tuple=('rMELTS_ZR', {
                                 'liq':['Liquid', 'solution']
                             }))
%cd ..</code>
          </sec>
          <sec id="cell-4-nb-7" specific-use="notebook-code">
            <code language="python">modelDB_ZR_min.phase_info</code>
          </sec>
          <sec id="cell-5-nb-7" specific-use="notebook-code">
            <code language="python">modelDB_ZR_liq.phase_info</code>
          </sec>
          <sec id="cell-6-nb-7" specific-use="notebook-content">
  </sec>
          <sec id="read-in-parameter-estimates-from-first-calibration-notebook-nb-7">
            <title>Read in parameter estimates from first calibration
    notebook</title>
          </sec>
          <sec id="cell-7-nb-7" specific-use="notebook-code">
            <code language="python">import pickle
with open('calib_params.pickle', 'rb') as f:
    params_stored = pickle.load(f)
for i,x in enumerate(params_stored):
    rMELTS_ZR.cy_Liquid_rMELTS_ZR_set_param_value(i, x) </code>
          </sec>
          <sec id="cell-8-nb-7" specific-use="notebook-content">
  </sec>
          <sec id="create-phases-for-equilibrium-assemblages-nb-7">
            <title>Create phases for equilibrium assemblages</title>
          </sec>
          <sec id="cell-9-nb-7" specific-use="notebook-code">
            <code language="python">src_obj = core.get_src_object('EquilibrateUsingMELTSv102')
modelDB = model.Database()
Liquid = modelDB_ZR_liq.get_phase('liq')
Feldspar = modelDB.get_phase('Fsp')
Quartz = modelDB.get_phase('Qz')
Spinel = modelDB.get_phase('SplS')
Opx = modelDB.get_phase('Opx')
RhomOx = modelDB.get_phase('Rhom')
Zircon = modelDB_ZR_min.get_phase('Zrc')
Baddeleyite = modelDB_ZR_min.get_phase('Bdd')</code>
          </sec>
          <sec id="cell-10-nb-7" specific-use="notebook-content">
            <p>The MELTS 1.0.2 water model.</p>
          </sec>
          <sec id="cell-11-nb-7" specific-use="notebook-code">
            <code language="python">Water = phases.PurePhase('WaterMelts', 'H2O', calib=False)</code>
          </sec>
          <sec id="cell-12-nb-7" specific-use="notebook-content">
            <p>The MELTS 1.1.x fluid (H2O, CO2) model.</p>
          </sec>
          <sec id="cell-13-nb-7" specific-use="notebook-code">
            <code language="python">Fluid = phases.SolutionPhase('FluidDuan','Fld')</code>
          </sec>
          <sec id="cell-14-nb-7" specific-use="notebook-content">
  </sec>
          <sec id="define-elements-in-system-and-phases-in-system-nb-7">
            <title>Define elements in system and phases in system</title>
          </sec>
          <sec id="cell-15-nb-7" specific-use="notebook-code">
            <code language="python">elm_sys = ['H','C','O','Na','Mg','Al','Si','P','K','Ca','Ti','Cr','Mn','Fe','Co','Ni','Zr']
#phs_sys = [Liquid, Feldspar, Quartz, Spinel, Opx, RhomOx, Zircon, Baddeleyite, Water]
phs_sys = [Liquid, Feldspar, Quartz, Spinel, Opx, RhomOx, Zircon, Baddeleyite, Fluid]</code>
          </sec>
          <sec id="cell-16-nb-7" specific-use="notebook-content">
  </sec>
          <sec id="composition-of-the-system-nb-7">
            <title>Composition of the system</title>
            <p>This is a high-silica rhyolite</p>
          </sec>
          <sec id="cell-17-nb-7" specific-use="notebook-code">
            <code language="python">grm_oxides = {
    'SiO2':  77.5, 
    'TiO2':   0.08, 
    'Al2O3': 12.5, 
    'Fe2O3':  0.207,
    'Cr2O3':  0.0, 
    'FeO':    0.473, 
    'MnO':    0.0,
    'MgO':    0.03, 
    'NiO':    0.0, 
    'CoO':    0.0,
    'CaO':    0.43, 
    'Na2O':   3.98, 
    'K2O':    4.88, 
    'P2O5':   0.0, 
    'H2O':    5.5,
    'CO2':    0.0005
}
Zr_ppm = 100</code>
          </sec>
          <sec id="cell-18-nb-7" specific-use="notebook-content">
            <p>Cast this composition as moles of elements for input to the
    Equilibrate class</p>
          </sec>
          <sec id="cell-19-nb-7" specific-use="notebook-code">
            <code language="python">tot_grm_oxides = 0.0
for key in grm_oxides.keys():
    tot_grm_oxides += grm_oxides[key]
mol_oxides = core.chem.format_mol_oxide_comp(grm_oxides, convert_grams_to_moles=True)
mol_elm = core.chem.mol_oxide_to_elem(mol_oxides)
elm_ref = np.zeros(107)
for i,sym in enumerate(
    ['Si', 'Ti', 'Al', 'Fe', 'Cr', 'Mn', 'Mg', 'Ni', 'Co', 'Ca', 'Na', 'K', 'P', 'H', 'C', 'O']):
    index = core.chem.PERIODIC_ORDER.tolist().index(sym)
    elm_ref[index] = mol_elm[i]
#
elm = np.copy(elm_ref)
wtZrO2 = 123.218*Zr_ppm/91.224/1000000.0
wtZrO2 *= tot_grm_oxides + wtZrO2
elm[core.chem.PERIODIC_ORDER.tolist().index('Zr')] += wtZrO2/123.218
elm[core.chem.PERIODIC_ORDER.tolist().index('O')]  += wtZrO2*2.0/123.218
blk_cmp = []
for x in elm_sys:
    index = core.chem.PERIODIC_ORDER.tolist().index(x)
    blk_cmp.append(elm[index])
blk_cmp = np.array(blk_cmp)</code>
          </sec>
          <sec id="cell-20-nb-7" specific-use="notebook-content">
  </sec>
          <sec id="instantiate-class-instance-and-run-calculation-nb-7">
            <title>Instantiate class instance and run calculation</title>
          </sec>
          <sec id="cell-21-nb-7" specific-use="notebook-code">
            <code language="python">equil = equilibrate.Equilibrate(elm_sys, phs_sys)</code>
          </sec>
          <sec id="cell-22-nb-7" specific-use="notebook-code">
            <code language="python">t =  762.0 + 273.15
p = 1750.0
state = equil.execute(t, p, bulk_comp=blk_cmp, debug=0, stats=False)
state.print_state()</code>
          </sec>
          <sec id="cell-23-nb-7" specific-use="notebook-content">
            <p>Set up a function to help with plotting results</p>
          </sec>
          <sec id="cell-24-nb-7" specific-use="notebook-code">
            <code language="python">phs_mass = []
phs_name = []
temperatures = []
def plot_data():
    global phs_mass, phs_name, temperatures
    phs_state = state.properties()
    temperatures.append(state.temperature - 273.15)
    masses = []
    names = []
    for key in phs_state.keys():
        if phs_state[key] == 'stable':
            names.append(key)
            masses.append(state.properties(phase_name=key, props='Mass'))
    phs_name.append(names)
    phs_mass.append(masses)
plot_data()</code>
          </sec>
          <sec id="cell-25-nb-7" specific-use="notebook-content">
            <p>Run a sequence …</p>
          </sec>
          <sec id="cell-26-nb-7" specific-use="notebook-code">
            <code language="python">for i in range(1,61):
    state = equil.execute(t-i/5.0, p, state=state, debug=0, stats=False)
    state.print_state()
    plot_data()</code>
          </sec>
          <sec id="cell-27-nb-7" specific-use="notebook-content">
            <p>Massage output into a suitable state for plotting</p>
          </sec>
          <sec id="cell-28-nb-7" specific-use="notebook-code">
            <code language="python">temperatures = np.array(temperatures)
phs_name_unique = []
for lst in phs_name:
    phs_name_unique += lst
phs_name_unique = list(sorted((set(phs_name_unique))))
phs_name_unique.remove('System')
phs_mass_unique = []
for i,lst in enumerate(phs_mass):
    masses = np.zeros(len(phs_name_unique))
    for j,name in enumerate(phs_name[i]):
        if name is not 'System':
            ind = phs_name_unique.index(name)
            masses[ind] = lst[j]
    phs_mass_unique.append(masses)
phs_mass_unique = np.array(phs_mass_unique)
zr_onset = 0.0
zr_ind = phs_name_unique.index('zircon')
for i,tval in enumerate(temperatures):
    if phs_mass_unique[i,zr_ind] &gt; 0.0:
        zr_onset = tval
        break</code>
          </sec>
          <sec id="cell-29-nb-7" specific-use="notebook-content">
  </sec>
          <sec id="plot-results-of-sequence-nb-7">
            <title>Plot results of sequence</title>
          </sec>
          <sec id="cell-30-nb-7" specific-use="notebook-code">
            <code language="python">fig = plt.figure(figsize=(15,10))
for i,name in enumerate(phs_name_unique):
    plt.plot(temperatures, phs_mass_unique[:,i], label=name)
plt.plot(np.array([zr_onset, zr_onset]), np.array([0,105]), 'k--', label='zircon liquidus')
plt.legend()
plt.show()</code>
          </sec>
          <sec id="cell-31-nb-7" specific-use="notebook-code">
            <code language="python">fig = plt.figure(figsize=(15,10))
plt.stackplot(temperatures, phs_mass_unique.T, labels=phs_name_unique)
plt.plot(np.array([zr_onset, zr_onset]), np.array([0,105]), 'k--', label='zircon liquidus')
plt.legend(loc='upper right')
plt.title("High-silica rhyolite")
plt.xlabel("Temperature °C")
plt.ylabel("Mass (g)")
plt.xlim(750, 762)
plt.ylim(0,105)
fig.savefig("MELTS-zr-rhyolite.pdf", bbox_inches='tight')
plt.show()</code>
          </sec>
        </sec>
      </sec>
    </body>
    <back>
</back>
  </sub-article>
</article>
